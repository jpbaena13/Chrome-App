define([WEBROOT_URL+"js/modules/noteboard.js",WEBROOT_URL+"js/modules/noteMenu.js",WEBROOT_URL+"js/core/sandbox.js"],function(a,b,c){var d=void 0,e=function(e){if(d=this,d.sandbox=new c(d),d.permissions=e.noteboard.owner||e.noteboard.shared,d.permissions!==!0){if(d.sandbox.on("resource-load",f),d.sandbox.on("resource-attach-zone",g),0===d.permissions.canEdit){a.target.off("dblclick"),$.contextMenu("destroy","#noteboard"),b.itemsDisabled.forward=!0,b.itemsDisabled.back=!0,b.itemsDisabled.lock=!0,b.itemsDisabled.bg=!0,b.itemsDisabled.size=!0,b.itemsDisabled.family=!0,b.itemsDisabled.color=!0,b.itemsDisabled.remove=!0;var h=a.target.find("canvas"),i=$(".untNoteboardTools").find(".left .box");h.off("mousedown").off("mousemove").off("mouseup"),i.find(".colors").remove(),i.find(".sizes").remove()}0===d.permissions.canDelete&&(b.itemsDisabled.remove=!0),0===d.permissions.canComment&&$("head").append("<style>.untCommentTA { display: none; }</style>")}},f=function(){0===d.permissions.canEdit&&($(".untResource").draggable("disable").find(".untNoteResize").remove(),$(".untResource").find(".untNoteHeader").css("cursor","default"),$(".untNote").find(".untNoteContent").removeAttr("contenteditable").off("click"),$("#timeline").selectable("destroy"),$("#timelinePanel").find("ul").sortable("destroy"),$("#noteboardToolbar").find(".button.pointer").remove())},g=function(){0===d.permissions.canUploadFiles&&(Dropzone.forElement("#uploadDropzone").options.maxFiles=0),0===d.permissions.canDeleteAttach&&$(".dz-remove").remove()};return{init:e}});