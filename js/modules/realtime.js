define([WEBROOT_URL+"js/modules/noteboard.js",WEBROOT_URL+"js/core/sandbox.js"],function(noteboard,sandbox){var $this=void 0,_init=function(){$this=this,$this.sandbox=new sandbox($this),$this.socket={emit:function(){},on:function(){}},$this.sandbox.on("resource-add-socket",_createResource),$this.sandbox.on("resource-move",_moveResource),$this.sandbox.on("resource-resize",_resizeResource),$this.sandbox.on("resource-msg",_msgResource),$this.sandbox.on("resource-forward",_sendForwardResource),$this.sandbox.on("resource-back",_sendBackResource),$this.sandbox.on("resource-bg",_BGResource),$this.sandbox.on("resource-fs",_FSResource),$this.sandbox.on("resource-ff",_FFResource),$this.sandbox.on("resource-c",_colorResource),$this.sandbox.on("resource-remove",_removeResource),$this.sandbox.on("resource-comment-add",_addCommentResource),$this.sandbox.on("note-attach-add",_attachFileNote),$this.sandbox.on("note-attach-remove",_attachFileRemoveNote),$this.sandbox.on("scribble-add",_scribbleAdd),$this.sandbox.on("scribble-clear",_scribbleClear),$this.sandbox.on("resource-index-timeline",_indexTimeline),$this.sandbox.on("note-lock",_noteLock),$this.sandbox.on("note-unlock",_noteUnlock),$.getScript("https://realtime.unnotes.com/socket.io/socket.io.js",function(){"undefined"!=typeof io&&($this.socket=io.connect("https://realtime.unnotes.com")),$this.socket.emit("matriculate",noteboard.id),$this.socket.on("noteboard",function(data){data.realTime=!0,eval(data.action+"(data)")})})},_createResource=function(a){a.realTime||(a.action="_createResourceReal",$this.socket.emit(noteboard.id,a))},_moveResource=function(a){a.realTime||(a.action="_moveResourceReal",$this.socket.emit(noteboard.id,a))},_resizeResource=function(a){a.realTime||(a.action="_resizeResourceReal",$this.socket.emit(noteboard.id,a))},_msgResource=function(a){a.realTime||(a.action="_msgResourceReal",$this.socket.emit(noteboard.id,a))},_sendForwardResource=function(a){a.realTime||(a.action="_sendForwardResourceReal",$this.socket.emit(noteboard.id,a))},_sendBackResource=function(a){a.realTime||(a.action="_sendBackResourceReal",$this.socket.emit(noteboard.id,a))},_BGResource=function(a){a.realTime||(a.action="_BGResourceReal",$this.socket.emit(noteboard.id,a))},_FFResource=function(a){a.realTime||(a.action="_FFResourceReal",$this.socket.emit(noteboard.id,a))},_FSResource=function(a){a.realTime||(a.action="_FSResourceReal",$this.socket.emit(noteboard.id,a))},_colorResource=function(a){a.realTime||(a.action="_colorResourceReal",$this.socket.emit(noteboard.id,a))},_removeResource=function(a){a.realTime||(a.action="_removeResourceReal",$this.socket.emit(noteboard.id,a))},_attachFileNote=function(a){a.realTime||(a.action="_attachFileNoteReal",$this.socket.emit(noteboard.id,a))},_attachFileRemoveNote=function(a){a.realTime||(a.action="_attachFileRemoveNoteReal",$this.socket.emit(noteboard.id,a))},_addCommentResource=function(a){a.realTime||(a.action="_addCommentResourceReal",$this.socket.emit(noteboard.id,a))},_scribbleAdd=function(a){a.realTime||(a.action="_scribbleAddReal",$this.socket.emit(noteboard.id,a))},_scribbleClear=function(a){a.realTime||(a.action="_scribbleClearReal",$this.socket.emit(noteboard.id,a))},_indexTimeline=function(a){a.realTime||(a.action="_indexTimelineReal",$this.socket.emit(noteboard.id,a))},_noteLock=function(a){a.realTime||(a.action="_noteLockReal",$this.socket.emit(noteboard.id,a))},_noteUnlock=function(a){a.realTime||(a.action="_noteUnlockReal",$this.socket.emit(noteboard.id,a))},_createResourceReal=function(a){var b={data:a};b.data.isNew=!1,$this.sandbox.emit("resource-add",b)},_moveResourceReal=function(a){$this.sandbox.emit("resource-move",a)},_resizeResourceReal=function(a){$this.sandbox.emit("resource-resize",a)},_msgResourceReal=function(a){$this.sandbox.emit("resource-msg",a)},_sendForwardResourceReal=function(a){$this.sandbox.emit("resource-forward",a)},_sendBackResourceReal=function(a){$this.sandbox.emit("resource-back",a)},_BGResourceReal=function(a){$this.sandbox.emit("resource-bg",a)},_FFResourceReal=function(a){$this.sandbox.emit("resource-ff",a)},_FSResourceReal=function(a){$this.sandbox.emit("resource-fs",a)},_colorResourceReal=function(a){$this.sandbox.emit("resource-c",a)},_removeResourceReal=function(a){$this.sandbox.emit("resource-remove",a)},_attachFileNoteReal=function(a){$this.sandbox.emit("note-attach-add",a)},_attachFileRemoveNoteReal=function(a){$this.sandbox.emit("note-attach-remove",a)},_addCommentResourceReal=function(a){$this.sandbox.emit("resource-comment-add",a)},_scribbleAddReal=function(a){$this.sandbox.emit("scribble-add",a)},_scribbleClearReal=function(a){$this.sandbox.emit("scribble-clear",a)},_indexTimelineReal=function(a){$this.sandbox.emit("resource-index-timeline",a)},_noteLockReal=function(a){$this.sandbox.emit("note-lock",a)},_noteUnlockReal=function(a){$this.sandbox.emit("note-unlock",a)};return{init:_init}});