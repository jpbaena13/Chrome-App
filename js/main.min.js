function chooseLang(a){void 0===a?(a="es_ES",$.cookie(PRJCT_NAME+"_lang")?a=$.cookie(PRJCT_NAME+"_lang"):$.cookie(PRJCT_NAME+"_lang",a,{path:"/",expires:365}),echo("<script type='text/javascript' src='"+WEBROOT_URL+"locale/"+a+".js'></script>")):$.cookie(PRJCT_NAME+"_lang",a,{path:"/",expires:365})}function getUrlVars(a){var b={};if(void 0==a)window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(a,c,d){b[c]=d});else{a=a.replace(/.*\?(.*?)/,"$1");for(var c=a.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");b[e[0]]=e[1]}}return b}function generatePass(){for(var a="azertyupqsdfghjkmwxcvbn23456789AZERTYUPQSDFGHJKMWXCVBN",b="",c=0;10>c;c++){var d=Math.round(Math.random()*a.length);b+=a.substring(d,d+1)}return b}function echo(a){document.write(a)}function sleep(a){for(var b=(new Date).getTime(),c=0;1e7>c&&!((new Date).getTime()-b>a);c++);}function stripHTML(a){return isNaN(a)?a.replace(/<[^>]+>/g,""):a}function withoutIterpretHTML(a){return a.replace("<","&lt;")}function oneSpace(a){return a.replace(/ +/g," ")}function isURL(a){var b=/^((ht|f)tps?:\/\/)?(www\.)?[\w\/]+[\/]+[\D\.\/\?\=]*([\S\=\&]*)?$/;return b.test(a)}function existElementInArray(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return!0;return!1}function getDate(a){void 0==a&&(a=new Date);var b=a.getFullYear(),c=a.getMonth()+1,d=a.getDate();return a.getMonth()<9&&(c="0"+c),a.getDate()<10&&(d="0"+d),b+"-"+c+"-"+d}function getTime(a){void 0==a&&(a=new Date);var b=a.getHours(),c=a.getMinutes(),d=a.getSeconds();return a.getHours()<10&&(b="0"+b),a.getMinutes()<10&&(c="0"+c),a.getSeconds()<10&&(d="0"+d),b+":"+c+":"+d}function getTimeOptions(a,b,c){for(var d="",a=a||0,b=b||59,e=a;b>=e;e++){var f=""+e,g="";10>e&&(f="0"+e),e==c&&(g="selected"),d=d+'<option value="'+f+'"'+g+">"+f+"</option>"}return d}function rgb2hex(a){function b(a){return("0"+parseInt(a).toString(16)).slice(-2)}return a=a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),""+b(a[1])+b(a[2])+b(a[3])}function hex2rgb(a){var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return b?{r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16)}:null}function validateData(data){if(void 0!=data.error){var title=eval("i18n.err"+data.error.code),content=eval("i18n.err"+data.error.code+"Msg");return 402==data.error.code?void $.untInputWin({title:i18n.paymentRequired,content:data.error.content,width:"800px"}):($.untInputWin({title:title,content:content,maxWidth:"400px",clickAccept:function(){"401"==data.error.code&&(location.href=ROOT_URL+"Login?uri="+encodeURIComponent(location.pathname+location.hash))}}),!1)}}function nl2br(a){return(a+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br>$2")}function clipText(a,b){return a.length>b&&(a=a.substr(0,b-3)+"..."),a}function youtubeID(a){var b=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,c=a.match(b);return c&&11==c[7].length?c[7]:null}function fullScreen(){document.fullScreenElement&&null!==document.fullScreenElement||!document.mozFullScreen&&!document.webkitIsFullScreen?document.documentElement.requestFullScreen?document.documentElement.requestFullScreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullScreen&&document.documentElement.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()}function Observable(){}function untInputWinCenter(){var a=$(window),b=$(".untWin").last(),c=a.width(),d=a.height(),e=(d-b.outerHeight())/2;0>e&&(e=0),$(".untWinBG").last().css({width:c,height:d}),b.css({top:e})}function untInputWinRemove(a){var b=$(".untWin").last(),c=$(".untWinBG").last();return a&&(b=$(".untWin"),c=$(".untWinBG")),b.css({top:-b.outerHeight()}),Modernizr.csstransitions?void setTimeout(function(){c.remove(),b.remove()},1e3):(c.remove(),void b.remove())}var PRJCT_NAME="localhost"==location.host?"unnotes":"",ROOT_URL=""==PRJCT_NAME?"/":"/"+PRJCT_NAME+"/",WEBROOT_URL=ROOT_URL+"webroot/",API=ROOT_URL+"API/",CDN_IMAGES="https://az641704.vo.msecnd.net/noteboard/",BLOB_IMAGES="https://unnotestorage.blob.core.windows.net/noteboard/";chooseLang();var urlPattern=/(ht|f)tp(s?):\/\/[a-zA-Z0-9-_:/.?,?+?#|%?(?)?&amp;=]+$/gim,imagePattern=/([^\s]+(?=\.(jpg|gif|png))\.\2)/gm,comPattern=/^([a-zA-z0-9]+(\.|\-){1})+(com|co|info|net|org|me|mobi|us|biz|ca|mx|tv|ws|ag|am|asia|at|be|br|bz|cc|cn|de|es|eu|fm|fr|gs|in|it|jobs|jp|ms|nl|nu|nz|se|tc|tk|tw|uk|vg|edu|no-ip)$/,vimeoPattern=/http:\/\/(www\.)?vimeo.com\/(\d+)($|\/)/;$(function(){$("#language").change(function(){chooseLang(this.value),location.reload()}),$(".qtipActive").qtip(),$(".untHelper").qtip({style:{classes:"qtip-untHelper"}}),$(document).ajaxError(function(a,b){if("abort"!=b.statusText){0==b.readyState&&(b.responseText='{ "error": { "code": "503" } }');var c=JSON.parse(b.responseText);validateData(c)}})}),permissionsKeyPress={OnlyIntegersBSHandled:function(a){return a.which>=48&a.which<=57|8==a.which|0==a.which?!0:(a.preventDefault(),!1)},OnlyIntegersNBSHandled:function(a){return a.which>=48&a.which<=57|8==a.which|0==a.which?!0:(a.preventDefault(),!1)},OnlyTextHandled:function(a){return a.which>=97&a.which<=122|a.which>=65&a.which<=90|32==a.which|8==a.which|0==a.which|209==a.which|241==a.which?!0:(a.preventDefault(),!1)},OnlyAlphanumericHandled:function(a){return a.which>=48&a.which<=57|a.which>=97&a.which<=122|a.which>=65&a.which<=90|32==a.which|8==a.which|0==a.which|209==a.which|241==a.which?!0:(a.preventDefault(),!1)},OnlyAlphanumericHandledNBS:function(a){return a.which>=48&a.which<=57|a.which>=97&a.which<=122|a.which>=65&a.which<=90|8==a.which|0==a.which|209==a.which|241==a.which?!0:(a.preventDefault(),!1)},OnlyAlphanumericPointHandled:function(a){return a.which>=48&a.which<=57|a.which>=97&a.which<=122|a.which>=65&a.which<=90|32==a.which|8==a.which|0==a.which|46==a.which|209==a.which|241==a.which?!0:(a.preventDefault(),!1)}};var views={formAttachFile:function(a,b){return'<form action="'+ROOT_URL+'Files" method="POST" class="dropzone" id="uploadDropzone">                    <input type="hidden" name="noteId" value="'+a+'">                    <input type="hidden" name="noteboardId" value="'+b+'">               </form>'},formUploadImage:function(a,b,c){return'<form action="'+ROOT_URL+'Files" method="POST" class="dropzone" id="uploadDropzone">                    <input type="hidden" name="noteboardId" value="'+c+'">                    <input type="hidden" name="left" value="'+a+'">                    <input type="hidden" name="top" value="'+b+'">               </form>'},commentBlock:function(a){return'<div class="untCommentBlock">                    <img class="untCommentImage" src="'+a.profileImage+'" alt="X" />                    <div class="untCommentContent">                        <span class="untCommentTitle">'+a.fullname+'</span>:                        <span class="untCommentMessage">'+a.message+"</span>                    </div>                </div>"},commentTA:function(a){return'<div class="untCommentTA">                    <div class="untInline">                        <img class="untCommentImage" src="'+a+'" alt="X"/>                    </div>                    <textarea name="commentTA" cols="1" rows="1" maxlength="140"></textarea>                </div>'},alertBlock:function(a){a.dateSelected||(a.dateSelected=getDate()),a.msg||(a.msg="");var b="";return a.id&&(b='<input type="hidden" name="id" value="'+a.id+'">'),'<form class="untAlertBlock">                    '+b+'                    <input type="text" name="alertMsg" class="alertMsg" value="'+a.msg+'" placeholder="'+i18n.msgAlert+'" disabled maxlength="140">                    <input type="text" name="alertDate" class="alertDate" value="'+a.dateSelected+'" disabled>                    <select name="alertHour" class="alertHour" disabled>'+getTimeOptions(8,20,a.hourSelected)+'</select>                    <select name="alertMinute" class="alertMinute" disabled>'+getTimeOptions(0,59,a.minuteSelected)+'</select>                    <span class="icon-checkmark-circle save"></span>                    <img src="'+WEBROOT_URL+'img/default/loader.gif" alt="Loader" class="untLoader" width="15px">                    <span class="icon-remove delete"></span>                </form>'},headerAlert:function(){return"<h2>"+i18n.scheduleAlert+'<input type="button" id="addAlert" class="untBtn yellow small" value="'+i18n.createAlert+'">        </h2>'},attachFileBlock:function(a){var b="",c="";return void 0==a?a={name:"",filename:"",size:"",type:"",src:""}:(b="dz-success",null!=a.src&&(c="display:inline",b+=" dz-image-preview")),'<div class="dz-preview dz-file-preview '+b+'" data-attach="'+a.name+'">                  <div class="dz-details">                    <div class="dz-filename">'+a.filename+'<span data-dz-name></span></div>                    <div class="dz-size" data-dz-size><strong>'+a.size+'</strong> Mb</div>                    <img data-dz-thumbnail src="'+a.src+'" style="'+c+'" />                  </div>                  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>                  <div class="dz-success-mark"><span>✔</span></div>                  <div class="dz-error-mark"><span>✘</span></div>                  <div class="dz-error-message"><span data-dz-errormessage></span></div>                  <a class="dz-view" href="javascript:undefined">'+i18n.viewFile+'</a>                  <a class="dz-download" href="javascript:undefined">'+i18n.downloadFile+'</a>                  <a class="dz-remove" href="javascript:undefined">'+i18n.removeFile+'</a>                  <a class="dz-delete" href="javascript:undefined">'+i18n.delete+"</a>                </div>"},branchTree:function(a){var b=a.type.charAt(0).toUpperCase()+a.type.slice(1);return'<li id="subtree-'+a.id+'">                    <a href="#!/folder/'+a.id+'" class="unt'+b+" "+a.type+'">                        <span class="icon- '+a.type+'"></span>                        <span class="name">'+a.name+'</span>                        <span class="edit icon-cog"></span>                        <span class="share icon-users"></span>                    </a>                    <ul></ul>                </li>'},notificationBlock:function(a){return'<li>                    <a href="'+ROOT_URL+"Noteboard/App/"+a.noteboardId+"#n-"+a.noteId+"&"+a.action+'">                        <img src="'+a.user.profileImage+'" width="40px" height="40px">                        <span>                            <div class="activityDate">'+a.activityDate+'</div>                            <div class="fullname">'+a.user.fullname+'</div>                            <div class="info">'+a.info+"</div>                        </span>                    </a>                </li>"},invitationBlock:function(a){return'<li>                    <a href="#">                        <img src="'+a.profileImage+'" width="40px" height="40px">                        <span>                            <div class="activityDate">'+a.sharingDate+'</div>                            <img src="'+a.previewImage+'" class="preview">                            <div class="fullname">'+a.fullname+'</div>                            <div class="info">'+a.info+'</div>                            <div class="buttons">                                <input type="button" value="'+i18n.participate+'" class="untBtn small" data-action="accept" data-noteboard="'+a.noteboardId+'">                                <input type="button" value="'+i18n.noParticipate+'" class="untBtn red small" data-action="decline" data-noteboard="'+a.noteboardId+'">                            </div>                        </span>                    </a>                </li>'},formBgImage:function(a){return'<form action="'+ROOT_URL+'Files" method="POST" class="dropzone" id="uploadDropzone">                    <input type="hidden" name="categoryId" value="'+a+'">               </form>'},permissionsForm:function(a){return a.canEdit=1==a.canEdit?"checked":"",a.canComment=1==a.canComment?"checked":"",a.canDelete=1==a.canDelete?"checked":"",a.canUploadFiles=1==a.canUploadFiles?"checked":"",a.canDeleteAttach=1==a.canDeleteAttach?"checked":"",a.canInvite=1==a.canInvite?"checked":"",'<form id="permissionsForm" class="untPermissions">                    <input type="hidden" name="noteboardId" value="'+a.noteboardId+'">\n                    <input type="hidden" name="userId" value="'+a.userId+'">\n                    <div><input type="checkbox" name="canEdit" '+a.canEdit+">"+i18n.canEdit+'</div>                    <div><input type="checkbox" name="canDelete" '+a.canDelete+">"+i18n.canDelete+'</div>                    <div><input type="checkbox" name="canComment" '+a.canComment+">"+i18n.canComment+'</div>                    <div><input type="checkbox" name="canUploadFiles" '+a.canUploadFiles+">"+i18n.canUploadFiles+'</div>                    <div><input type="checkbox" name="canDeleteAttach" '+a.canDeleteAttach+">"+i18n.canDeleteAttach+"</div>                </form>"}};Observable.prototype={_initEvents:function(){this._events||(this._events={all:[]})},on:function(a,b,c){return a=a||"all",this._initEvents(),this._events[a]||(this._events[a]=[]),this._events[a].push({cb:b,ctx:c}),this},off:function(a,b,c){var d,e,f;if(a=a||"all",this._initEvents(),d=this._events[a],!d)return this;for(e=d.length;e--;)if(f=d[e],f.cb==b&&f.ctx==c)return d.splice(e,1),this;return this},trigger:function(a){this._initEvents();var b,c,d=this._events[a];if(d)for(b=d.length;b--;)c=d[b],c.cb.apply(c.ctx,arguments);if("all"!=a)for(d=this._events.all,b=d.length;b--;)c=d[b],c.cb.apply(c.ctx,arguments);return this}},function(a,b){a.fn.placeholder=function(c){var d={text:"Ingrese texto",color_focus:"#000",color_blur:"#999",valid:!1,autoResize:!1,pressEnter:function(){}};return this.each(function(){var e=a.extend({},d,c),f=a(this);if("undefined"!=typeof Modernizr&&Modernizr.input.placeholder)return(f.attr("placeholder")===b||""===f.attr("placeholder"))&&f.attr("placeholder",e.text),void(e.autoResize&&f.autoResize(e));var g=function(){""!=f.attr("placeholder")&&(e.text=f.attr("placeholder")),""==a.trim(f.val())?(f.val(e.text),f.css("color",e.color_blur)):f.val()!=e.text&&(f.css("color",e.color_focus),e.valid&&f.valid())},h=function(){a.trim(f.val())==e.text&&(f.val(""),f.css("color",e.color_focus))},i=function(){(""==a.trim(f.val())||a.trim(f.val())==e.text)&&(e.valid&&(f.val(""),f.valid()),f.val(e.text),f.css("color",e.color_blur))},j=function(a){return 27==a.which?(a.preventDefault(),!1):(13==a.which&&e.pressEnter(),!0)};e.autoResize&&f.autoResize(e),g(),f.on("blur",i),f.on("keypress",j),f.on("focus",h)})},a.fn.extend({autoResize:function(b){b||(b={});var c={maxHeight:b.maxHeight||null,minHeight:b.minHeight||null,activeClass:b.activeClass||null};return this.each(function(){function b(a){if(g.value=h.val(),e!=g.value||a===!0){e=g.value;var b=g.scrollHeight;c.maxHeight&&b>c.maxHeight?h.css("height",c.maxHeight+"px"):h.css("height",parseInt(b)+"px")}}var d=a(this);d.initHeight=d.css("height"),c.maxHeight?d.css("overflow","auto"):d.css("overflow","hidden");var e=null,f=d.clone(!0);f.css({visibility:"hidden",position:"absolute",top:0,overflow:"hidden",width:parseInt(d.width())-10}),f.attr("name",""),f.attr("id",""),d.parent().append(f);var g=f[0],h=d;d.bind("keyup",b).bind("focus",function(){c.minHeight&&(h.css("height",c.minHeight+"px"),f.css("height",c.minHeight+"px"),b(!0)),c.activeClass&&h.addClass(c.activeClass)}).bind("blur",function(){c.minHeight&&h.initHeight&&(f.css("height",h.initHeight),h.css("height",h.initHeight)),c.activeClass&&h.removeClass(c.activeClass),b()})})}})}(jQuery),$(function(){$("[placeholder]").placeholder()}),function(a,b){a.fn.untInputMsg=function(b){var c={content:"",title:"",type:"Ok"},d=a.extend(c,b);return this.each(function(){var b=a(this);b.css("display","none"),b.html('<div class="untMsg">                              <div class="untMsgDelete icon-cancel-circle"></div>                              <div class="untMsgIcon"></div>                              <div class="untMsgWrapper">                                 <div class="untMsgTitle">'+d.title+'</div>                                 <div class="untMsgContent">'+d.content+"</div>                              </div>                          </div>");var c=b.children(".untMsg");c.addClass("untMsg"+d.type).css("width",d.width).css("height",d.height),d.icon&&c.children(".untMsgIcon").html('<img src="'+d.icon+'"/>').css("display","inline-block"),""==d.title&&b.find(".untMsgTitle").remove(),b.find(".untMsgDelete").on("click",function(){b.remove()})})},a.untInputWin=function(c){var d={title:b,content:"",data:"",btnAccept:!0,btnCancel:!1,width:"auto",height:"auto",maxWidth:"95%",classes:"",clickCancel:function(){return!0},clickAccept:function(){return!0},onLoadContent:function(){}};"object"!=typeof c&&(c={content:c});var e=a.extend(d,c),f=[];if(f.bg=a("<div>",{Class:"untWinBG"}).appendTo(a("body")),f.win=a("<div>",{Class:"untWin "+e.classes}).css({width:e.width,height:e.height,"max-width":e.maxWidth}).appendTo(f.bg),f.header=a("<div>",{Class:"untWinHeader"}).html(e.title).appendTo(f.win),f.close=a("<span>",{Class:"untWinClose icon-cancel-circle"}).appendTo(f.header),f.content=a("<div>",{Class:"untWinContent"}).html(e.content).appendTo(f.win),f.footer=a("<div>",{Class:"untWinFooter"}).appendTo(f.win),f.btnAccept=a("<button>",{Class:"btnWinAccept untBtn yellow"}).html(i18n.accept).appendTo(f.footer),f.btnCancel=a("<button>",{Class:"btnWinCancel untBtn"}).html(i18n.cancel).appendTo(f.footer),f.close.on("click",function(){untInputWinRemove()}),untInputWinCenter(),isURL(e.content)){f.content.html('<img src="'+WEBROOT_URL+'img/default/loader.gif" alt="Loader" style="display:inherit;margin:0 auto;" width="30px" height="30px">'),f.btnAccept.hide(),a.ajax({url:e.content,data:e.data,success:function(a){e.btnAccept&&f.btnAccept.show(),isURL(a)?location.href=a:f.content.html(a),e.onLoadContent(),untInputWinCenter()}}).error(function(){f.bg.remove()})}e.title||f.header.hide(),e.btnAccept?f.btnAccept.on("click",function(){e.clickAccept()!==!1&&untInputWinRemove()}):f.btnAccept.hide(),e.btnCancel?f.btnCancel.on("click",function(){e.clickCancel()!==!1&&untInputWinRemove()}):f.btnCancel.hide(),e.btnAccept||e.btnCancel||f.footer.hide()},a(window).on("resize",function(){untInputWinCenter()}),a(document).on("keydown",function(b){var c=b.which||b.keycode;27==c&&0!=a(".untWin").length&&untInputWinRemove()})}(jQuery);