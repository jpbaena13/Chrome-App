function Model(a,b){this.noteboard=b,this.data=a||{},this.data.bg=a.bg||"yellow",this.data.c=a.c||"000000",this.data.comments=a.comments||0,this.data.creator=a.user||this.noteboard.user,this.data.fs=a.fs||"1em",this.data.ff=a.ff||"paprika",this.data.h=a.h||200,this.data.id=a.id||"t"+this.noteboard.autoincrement(),this.data.index=a.index||this.noteboard.maxIndex,this.data.isNew=void 0!=a.isNew?a.isNew:!0,this.data.l=a.l||0,this.data.msg=a.msg||"",this.data.noteboardId=this.noteboard.id,this.data.realTime=void 0!=a.realTime?a.realTime:!1,this.data.t=a.t||50,this.data.w=a.w||200,this.data.locked=!1,this.data.dragging=!1,this.setPosition(this.data.l,this.data.t),this.noteboard.models.push(this),this.data.realTime||this.noteboard.sandbox.emit("resource-add",this)}function NoteboardResource(a,b){var c=this;this.noteboard=b,this.model=new Model(a,this.noteboard),this.view=this.View(),this.noteboard.target.append(this.view.elems.template),this.model.on("resource-id",function(a,b){c.view.setId(b)}),this.model.on("resource-position",function(a,b,d){c.view.setPosition(b,d)}),this.model.on("resource-resize",function(a,b,d){c.view.setSize(b,d)}),this.model.on("resource-remove",function(){c.view.remove()}),this.model.on("resource-selecting",function(a,b){c.view.selectingResource(b)}),this.model.on("resource-index",function(a,b){c.view.changeIndex(b)}),this.model.on("resource-comment-add",function(a,b){c.view.addComment(b)}),this.model.on("resource-locked",function(a,b,d){c.view.locked(b,d)}),this.view.on("resource-click",function(a,b){c.model.selectingResource(b)}),this.view.on("resource-dblclick",function(){c.model.incrementIndex({})}),this.view.on("resource-drag",function(a,b,d){c.model.dragging(b,d)}),this.view.on("resource-stop",function(a,b,d){c.model.dropping(b,d)}),this.view.on("resource-dragResize",function(a,b,d){c.model.draggingResize(b,d)}),this.view.on("resource-stopResize",function(a,b,d){c.model.droppingResize(b,d)})}function NoteResource(a,b){var c=this;NoteboardResource.call(this,a,b),this.model.data.isNew&&this.view.elems.msg.focus(),this.model.on("resource-msg",function(a,b){c.view.setMsg(b)}),this.model.on("resource-bg",function(a,b){c.view.setBG(b)}),this.model.on("resource-ff",function(a,b){c.view.setFF(b)}),this.model.on("resource-fs",function(a,b){c.view.setFS(b)}),this.model.on("resource-c",function(a,b){c.view.setC(b)}),this.model.on("resource-attach-zone",function(){c.view.attachZone()})}function CircleResource(a,b){NoteboardResource.call(this,a,b)}function ImageResource(a,b){NoteboardResource.call(this,a,b)}function VideoResource(a,b){NoteboardResource.call(this,a,b)}function FrameResource(a,b){var c=this;NoteboardResource.call(this,a,b),$("#timeline").append(this.view.elems.template),this.view.addTimelinePreview(),this.model.on("resource-msg",function(a,b){c.view.setMsg(b)}),b.areas[a.msg-1]=this}function CommentResource(a,b){NoteboardResource.call(this,a,b),b.sandbox.on("noteboard-mousewheel",this.view.zoomResize),this.view.zoomResize()}function NoteboardModel(a){this.data=a,this.data.ctype=a.type.charAt(0).toUpperCase()+a.type.slice(1)}function NoteboardBase(a){var b=this;this.model=new NoteboardModel(a),this.view=this.View(this.model.data),this.view.on("noteboard-share",function(){b.Share()}),this.view.on("noteboard-edit",function(){b.Edit()}),this.view.on("noteboard-delete",function(){b.Delete()}),this.model.on("noteboard-name",function(a,c){b.view.setName(c)}),this.model.on("noteboard-description",function(a,c){b.view.setDescription(c)}),this.model.on("noteboard-visibility",function(a,c){b.view.setVisibility(c)}),this.model.on("noteboard-parentId",function(a,c){b.view.setParentId(c)})}function Noteboard(a,b){NoteboardBase.call(this,a),b||this.UpdateThumbails()}function Folder(a){var b=this;NoteboardBase.call(this,a),this.view.on("branch-clicked",function(){b.BranchClicked()})}var jLinq,jlinq,jl;!function(){var a={command:{query:0,select:1,action:2},exp:{get_path:/\./g,escape_regex:/[\-\[\]\{\}\(\)\*\+\?\.\,\\\^\$\|\#\s]/g},type:{nothing:-1,undefined:0,string:1,number:2,array:3,regex:4,bool:5,method:6,datetime:7,object:99},library:{commands:{},types:{},addType:function(b,c){a.library.types[b]=c},extend:function(b){a.util.isType(a.type.array,b)||(b=[b]),a.util.each(b,function(b){a.library.commands[b.name]=b})},query:function(b,c){if(!a.util.isType(a.type.array,b))throw"jLinq can only query arrays of objects.";b=c.clone||null==c.clone&&jLinq.alwaysClone?a.util.clone(b):b;var d={instance:{ignoreCase:jLinq.ignoreCase,not:!1,lastCommand:null,lastField:null,records:b,removed:[],or:function(){d.startNewCommandSet()},query:{}},canRepeatCommand:function(b){return null!=d.instance.lastCommand&&b.length==d.instance.lastCommand.method.length+1&&a.util.isType(a.type.string,b[0])},commands:[[]],execute:function(){var b=[],c=d.instance;a.util.each(d.instance.records,function(a){c.record=a,d.evaluate(c)?b.push(a):d.instance.removed.push(a)}),d.instance.records=b},findValue:a.util.findValue,evaluate:function(a){for(var b=0,c=d.commands.length;c>b;b++){var e=d.commands[b];if(d.evaluateSet(e,a))return!0}return!1},evaluateSet:function(b,c){for(var e in b)if(b.hasOwnProperty(e)){var f=b[e];c.value=d.findValue(c.record,f.path),c.compare=function(b){return a.util.compare(c.value,b,c)},c.when=function(b){return a.util.when(c.value,b,c)};try{var g=f.method.apply(c,f.args);if(f.not&&(g=!g),!g)return!1}catch(h){return!1}}return!0},repeat:function(b){d.instance.lastCommand&&null!=b&&(b=a.util.toArray(b),d.canRepeatCommand(b)&&(d.instance.lastField=b[0],b=a.util.select(b,null,1,null)),d.queue(d.instance.lastCommand,b))},queue:function(b,c){d.instance.lastCommand=b;var e={name:b.name,method:b.method,field:d.instance.lastField,count:b.method.length,args:c,not:d.not};e.args.length>b.method.length&&(e.field=e.args[0],e.args=a.util.remaining(e.args,1),d.instance.lastField=e.field),e.path=e.field,d.commands[d.commands.length-1].push(e),d.not=!1},startNewCommandSet:function(){d.commands.push([])},setNot:function(){d.not=!d.not}};return a.util.each(a.library.commands,function(b){if(b.type==a.command.query){var c=function(){return d.queue(b,arguments),d.instance.query};d.instance.query[b.name]=c;var e=a.util.operatorName(b.name);d.instance.query["or"+e]=function(){return d.startNewCommandSet(),c.apply(null,arguments)},d.instance.query["orNot"+e]=function(){return d.startNewCommandSet(),d.setNot(),c.apply(null,arguments)},d.instance.query["and"+e]=function(){return c.apply(null,arguments)},d.instance.query["andNot"+e]=function(){return d.setNot(),c.apply(null,arguments)},d.instance.query["not"+e]=function(){return d.setNot(),c.apply(null,arguments)}}else b.type==a.command.select?d.instance.query[b.name]=function(){d.execute();var c=d.instance;return c.compare=function(b,d){return a.util.compare(b,d,c)},c.when=function(b,d){return a.util.when(b,d,c)},b.method.apply(c,arguments)}:b.type==a.command.action&&(d.instance.query[b.name]=function(){var c=d.instance;return c.compare=function(b,d){return a.util.compare(b,d,c)},c.when=function(b,d){return a.util.when(b,d,c)},b.method.apply(c,arguments),d.instance.query})}),d.instance.query.or=function(){return d.startNewCommandSet(),d.repeat(arguments),d.instance.query},d.instance.query.and=function(){return d.repeat(arguments),d.instance.query},d.instance.query.not=function(){return d.setNot(),d.repeat(arguments),d.instance.query},d.instance.query.andNot=function(){return d.setNot(),d.repeat(arguments),d.instance.query},d.instance.query.orNot=function(){return d.startNewCommandSet(),d.setNot(),d.repeat(arguments),d.instance.query},d.instance.query}},util:{trim:function(a){return a=null==a?"":a,a=a.toString(),a.replace(/^\s*|\s*$/g,"")},cloneArray:function(b){var c=[];return a.util.each(b,function(b){c.push(a.util.clone(b))}),c},clone:function(b){if(a.util.isType(a.type.array,b))return a.util.cloneArray(b);if(a.util.isType(a.type.object,b)){var c={};for(var d in b)b.hasOwnProperty(d)&&(c[d]=a.util.clone(b[d]));return c}return b},invoke:function(b,c){c=c.concat();var d=c[0],e=a.util.findValue(b,d);c=a.util.select(c,null,1,null),d=d.replace(/\..*$/,"");var f=a.util.findValue(b,d);b=f===e?b:f;try{var g=e.apply(b,c);return g}catch(h){return null}},getPath:function(b){return a.util.toString(b).split(a.exp.get_path)},findValue:function(b,c){if(a.util.isType(a.type.array,c))return a.util.invoke(b,c);if(a.util.isType(a.type.string,c)){c=a.util.getPath(c);for(var d=0;null!=b&&d<c.length;)b=b[c[d++]];return b}return b},elementAt:function(a,b){return a&&a.length>0&&b<a.length&&b>=0?a[b]:null},regexEscape:function(b){return(b?b:"").toString().replace(a.exp.escape_regex,"\\$&")},regexMatch:function(b,c,d){return a.util.isType(a.type.regex,b)&&(b=b.source),b=new RegExp(a.util.toString(b),d?"gi":"g"),null!=a.util.toString(c).match(b)},operatorName:function(a){return a.replace(/^\w/,function(a){return a.toUpperCase()})},compare:function(b,c,d){var e=a.util.when(b,c,d);return 1==e?e:!1},when:function(b,c,d){var e=a.util.getType(b);for(var f in c)if(c.hasOwnProperty(f)){var g=a.type[f];if(g==e)return c[f].apply(d,[b])}return c.other?c.other.apply(d,[b]):null},each:function(a,b){var c=0;for(var d in a)a.hasOwnProperty(d)&&b(a[d],c++)},grab:function(b,c){var d=[];return a.util.each(b,function(a){d.push(c(a))}),d},until:function(a,b){for(var c=0,d=a.length;d>c;c++){var e=b(a[c],c+1);if(e===!0)return!0}return!1},isType:function(b,c){return a.util.getType(c)==b},getType:function(b){if(null==b)return a.type.nothing;for(var c in a.library.types)if(a.library.types[c](b))return c;return a.type.object},remaining:function(a,b){for(var c=[];b<a.length;b++)c.push(a[b]);return c},apply:function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},reorder:function(b,c,d){return a.util._performSort(b,c,d)},_performSort:function(b,c,d){var e=c.splice(0,1);if(0==e.length)return b;e=e[0];var f=a.util.isType(a.type.array,e),g=f?e[0]:e,h=g.match(/^\-/);g=h?g.substr(1):g,h&&(f?e[0]=g:e=g);var i=function(b,c){var f=a.util.findValue(b,e),g=a.util.findValue(c,e);null==f&&null==g?(f=0,g=0):null==f&&null!=g?(f=0,g=1):null!=f&&null==g?(f=1,g=0):d&&a.util.isType(a.type.string,f)&&a.util.isType(a.type.string,g)?(f=f.toLowerCase(),g=g.toLowerCase()):f.length&&g.length&&(f=f.length,g=g.length);var i=g>f?-1:f>g?1:0;return h?-i:i};if(b.sort(i),c.length>0){var j=[],k=a.util.group(b,e,d);a.util.each(k,function(b){var e=c.slice(),f=a.util._performSort(b,e,d);j=j.concat(f)}),b=j}return b},group:function(b,c,d){for(var e={},f=0,g=b.length;g>f;f++){var h=b[f],i=a.util.toString(a.util.findValue(h,c));i=d?i.toUpperCase():i,e[i]?e[i].push(h):e[i]=[h]}return e},equals:function(b,c,d){return a.util.when(b,{string:function(){return a.util.regexMatch("^"+a.util.regexEscape(c)+"$",b,d)},other:function(){return null==b&&null==c||b===c}})},toArray:function(a){var b=[];if(a.length)for(var c=0;c<a.length;c++)b.push(a[c]);else for(var d in a)a.hasOwnProperty(d)&&b.push(a[d]);return b},toString:function(a){return null==a?"":a.toString()},skipTake:function(b,c,d,e){return d=null==d?0:d,e=null==e?b.length:e,d>=b.length||0==e?[]:a.util.select(b,c,d,d+e)},select:function(a,b,c,d){c=null==c?0:c,d=null==d?a.length:d;var e=a.slice(c,d);if(jLinq.util.isType(jLinq.type.object,b)){var f=b;b=function(a){var b={};for(var c in f)f.hasOwnProperty(c)&&(b[c]=a[c]?a[c]:f[c]);return b}}if(jLinq.util.isType(jLinq.type.method,b))for(var g=0;g<e.length;g++){var h=e[g];e[g]=b.apply(h,[h])}return e}}};a.library.addType(a.type.nothing,function(a){return null==a}),a.library.addType(a.type.array,function(a){return a instanceof Array}),a.library.addType(a.type.string,function(a){return a.substr&&a.toLowerCase}),a.library.addType(a.type.number,function(a){return a.toFixed&&a.toExponential}),a.library.addType(a.type.regex,function(a){return a instanceof RegExp}),a.library.addType(a.type.bool,function(a){return 1==a||0==a}),a.library.addType(a.type.method,function(a){return a instanceof Function}),a.library.addType(a.type.datetime,function(a){return a instanceof Date}),a.library.extend([{name:"ignoreCase",type:a.command.action,method:function(){this.ignoreCase=!0}},{name:"reverse",type:a.command.action,method:function(){this.records.reverse()}},{name:"useCase",type:a.command.action,method:function(){this.ignoreCase=!1}},{name:"each",type:a.command.action,method:function(a){jLinq.util.each(this.records,function(b){a(b)})}},{name:"attach",type:a.command.action,method:function(a,b){this.when(b,{method:function(){jLinq.util.each(this.records,function(c){c[a]=b(c)})},other:function(){jLinq.util.each(this.records,function(c){c[a]=b})}})}},{name:"join",type:a.command.action,method:function(a,b,c,d){jLinq.util.each(this.records,function(e){e[b]=jLinq.from(a).equals(d,e[c]).select()})}},{name:"assign",type:a.command.action,method:function(a,b,c,d,e){jLinq.util.each(this.records,function(f){f[b]=jLinq.from(a).equals(d,f[c]).first(e)})}},{name:"sort",type:a.command.action,method:function(){var a=jLinq.util.toArray(arguments);this.records=jLinq.util.reorder(this.records,a,this.ignoreCase)}},{name:"equals",type:a.command.query,method:function(a){return jLinq.util.equals(this.value,a,this.ignoreCase)}},{name:"starts",type:a.command.query,method:function(a){return this.compare({array:function(){return jLinq.util.equals(this.value[0],a,this.ignoreCase)},other:function(){return jLinq.util.regexMatch("^"+jLinq.util.regexEscape(a),this.value,this.ignoreCase)}})}},{name:"ends",type:a.command.query,method:function(a){return this.compare({array:function(){return jLinq.util.equals(this.value[this.value.length-1],a,this.ignoreCase)},other:function(){return jLinq.util.regexMatch(jLinq.util.regexEscape(a)+"$",this.value,this.ignoreCase)}})}},{name:"contains",type:a.command.query,method:function(a){return this.compare({array:function(){var b=this.ignoreCase;return jLinq.util.until(this.value,function(c){return jLinq.util.equals(c,a,b)})},other:function(){return jLinq.util.regexMatch(jLinq.util.regexEscape(a),this.value,this.ignoreCase)}})}},{name:"match",type:a.command.query,method:function(a){return this.compare({array:function(){var b=this.ignoreCase;return jLinq.util.until(this.value,function(c){return jLinq.util.regexMatch(a,c,b)})},other:function(){return jLinq.util.regexMatch(a,this.value,this.ignoreCase)}})}},{name:"type",type:a.command.query,method:function(a){return jLinq.util.isType(a,this.value)}},{name:"greater",type:a.command.query,method:function(a){return this.compare({array:function(){return this.value.length>a},string:function(){return this.value.length>a},other:function(){return this.value>a}})}},{name:"greaterEquals",type:a.command.query,method:function(a){return this.compare({array:function(){return this.value.length>=a},string:function(){return this.value.length>=a},other:function(){return this.value>=a}})}},{name:"less",type:a.command.query,method:function(a){return this.compare({array:function(){return this.value.length<a},string:function(){return this.value.length<a},other:function(){return this.value<a}})}},{name:"lessEquals",type:a.command.query,method:function(a){return this.compare({array:function(){return this.value.length<=a},string:function(){return this.value.length<=a},other:function(){return this.value<=a}})}},{name:"between",type:a.command.query,method:function(a,b){return this.compare({array:function(){return this.value.length>a&&this.value.length<b},string:function(){return this.value.length>a&&this.value.length<b},other:function(){return this.value>a&&this.value<b}})}},{name:"betweenEquals",type:a.command.query,method:function(a,b){return this.compare({array:function(){return this.value.length>=a&&this.value.length<=b},string:function(){return this.value.length>=a&&this.value.length<=b},other:function(){return this.value>=a&&this.value<=b}})}},{name:"empty",type:a.command.query,method:function(){return this.compare({array:function(){return 0==this.value.length},string:function(){return 0==jLinq.util.trim(this.value).length},other:function(){return null==this.value}})}},{name:"is",type:a.command.query,method:function(){return this.compare({bool:function(){return this.value===!0},other:function(){return null!=this.value}})}},{name:"min",type:a.command.select,method:function(a){var b=jLinq.util.reorder(this.records,[a],this.ignoreCase);return jLinq.util.elementAt(b,0)}},{name:"max",type:a.command.select,method:function(a){var b=jLinq.util.reorder(this.records,[a],this.ignoreCase);return jLinq.util.elementAt(b,b.length-1)}},{name:"sum",type:a.command.select,method:function(a){var b;return jLinq.util.each(this.records,function(c){var d=jLinq.util.findValue(c,a);b=null==b?d:b+d}),b}},{name:"average",type:a.command.select,method:function(a){var b;return jLinq.util.each(this.records,function(c){var d=jLinq.util.findValue(c,a);b=null==b?d:b+d}),b/this.records.length}},{name:"skip",type:a.command.select,method:function(a,b){return this.records=this.when(b,{method:function(){return jLinq.util.skipTake(this.records,b,a,null)},object:function(){return jLinq.util.skipTake(this.records,b,a,null)},other:function(){return jLinq.util.skipTake(this.records,null,a,null)}}),this.query}},{name:"take",type:a.command.select,method:function(a,b){return this.when(b,{method:function(){return jLinq.util.skipTake(this.records,b,null,a)},object:function(){return jLinq.util.skipTake(this.records,b,null,a)},other:function(){return jLinq.util.skipTake(this.records,null,null,a)}})}},{name:"skipTake",type:a.command.select,method:function(a,b,c){return this.when(c,{method:function(){return jLinq.util.skipTake(this.records,c,a,b)},object:function(){return jLinq.util.skipTake(this.records,c,a,b)},other:function(){return jLinq.util.skipTake(this.records,null,a,b)}})}},{name:"select",type:a.command.select,method:function(a){return this.when(a,{method:function(){return jLinq.util.select(this.records,a)},object:function(){return jLinq.util.select(this.records,a)},other:function(){return this.records}})}},{name:"distinct",type:a.command.select,method:function(a){var b=jLinq.util.group(this.records,a,this.ignoreCase);return jLinq.util.grab(b,function(b){return jLinq.util.findValue(b[0],a)})}},{name:"group",type:a.command.select,method:function(a){return jLinq.util.group(this.records,a,this.ignoreCase)}},{name:"define",type:a.command.select,method:function(a){var b=this.when(a,{method:function(){return jLinq.util.select(this.records,a)},object:function(){return jLinq.util.select(this.records,a)},other:function(){return this.records}});return jLinq.from(b)}},{name:"any",type:a.command.select,method:function(){return this.records.length>0}},{name:"none",type:a.command.select,method:function(){return 0==this.records.length}},{name:"all",type:a.command.select,method:function(){return 0==this.removed.length}},{name:"first",type:a.command.select,method:function(a){var b=jLinq.util.elementAt(this.records,0);return null==b?a:b}},{name:"last",type:a.command.select,method:function(a){var b=jLinq.util.elementAt(this.records,this.records.length-1);return null==b?a:b}},{name:"at",type:a.command.select,method:function(a,b){var c=jLinq.util.elementAt(this.records,a);return null==c?b:c}},{name:"count",type:a.command.select,method:function(){return this.records.length}},{name:"removed",type:a.command.select,method:function(a){return this.when(a,{method:function(){return jLinq.util.select(this.removed,a)},object:function(){return jLinq.util.select(this.removed,a)},other:function(){return this.removed}})}},{name:"where",type:a.command.select,method:function(a){var b=this,c=[];jLinq.util.each(this.records,function(d){a.apply(b,[d])===!0&&c.push(d)});var d=jLinq.from(c);return this.ignoreCase||d.useCase(),d}}]),jLinq={alwaysClone:!1,ignoreCase:!0,command:a.command,type:a.type,extend:function(){a.library.extend.apply(null,arguments)},query:function(a,b){return library.framework.query(a,b)},from:function(b){return a.library.query(b,{clone:!1})},getCommands:function(){return a.util.grab(a.library.commands,function(b){return{name:b.name,typeId:b.type,type:b.type==a.command.select?"select":b.type==a.command.query?"query":b.type==a.command.action?"action":"unknown"}})},util:{trim:a.util.trim,findValue:a.util.findValue,elementAt:a.util.elementAt,regexEscape:a.util.regexEscape,regexMatch:a.util.regexMatch,equals:a.util.equals,group:a.util.group,reorder:a.util.reorder,when:a.util.when,toArray:a.util.toArray,each:a.util.each,grab:a.util.grab,until:a.util.until,isType:a.util.isType,getType:a.util.getType,apply:a.util.apply,select:a.util.select,skipTake:a.util.skipTake}},jlinq=jLinq,jl=jLinq}(),function(){var a={query:function(b,c){var d=jlinq.util.isType(jlinq.type.string,b)?c.find(b):c,e=a.toArray(d),f=jlinq.from(e);return f.$=c,f},findTarget:function(a,b){return a instanceof jQuery?a:(jlinq.util.isType(jlinq.type.string,a)&&(b=b.find(a)),a)},select:function(a,b){var c=$(b);return jlinq.util.isType(jlinq.type.string,a)?c.find(a):c},toArray:function(a){var b=[];return a.each(function(a,c){b.push($(c))}),b}};jlinq.extend([{name:"$",type:jlinq.command.select,method:function(){return a.select(selector,this.records)}},{name:"get",type:jlinq.command.select,method:function(b){return a.select(b,this.records)}},{name:"include",type:jlinq.command.action,method:function(b,c){c=c||this.query.$;var d=c.find(b),e=a.toArray(d);this.records=this.records.concat(e)}}]),$.fn.query=function(b){return a.query(b,this)},jLinq.$=function(b){return a.query(b,$(document.body))}}(),function(a,b){function c(b){return b.id&&a('label[for="'+b.id+'"]').val()||b.name}function d(e,f,g){return g||(g=0),f.each(function(){var f,h,i=a(this),j=this,k=this.nodeName.toLowerCase();switch("label"==k&&i.find("input, textarea, select").length&&(f=i.text(),i=i.children().first(),j=i.get(0),k=j.nodeName.toLowerCase()),k){case"menu":h={name:i.attr("label"),items:{}},g=d(h.items,i.children(),g);break;case"a":case"button":h={name:i.text(),disabled:!!i.attr("disabled"),callback:function(){i.click()}};break;case"menuitem":case"command":switch(i.attr("type")){case b:case"command":case"menuitem":h={name:i.attr("label"),disabled:!!i.attr("disabled"),callback:function(){i.click()}};break;case"checkbox":h={type:"checkbox",disabled:!!i.attr("disabled"),name:i.attr("label"),selected:!!i.attr("checked")};break;case"radio":h={type:"radio",disabled:!!i.attr("disabled"),name:i.attr("label"),radio:i.attr("radiogroup"),value:i.attr("id"),selected:!!i.attr("checked")};break;default:h=b}break;case"hr":h="-------";break;case"input":switch(i.attr("type")){case"text":h={type:"text",name:f||c(j),disabled:!!i.attr("disabled"),value:i.val()};break;case"checkbox":h={type:"checkbox",name:f||c(j),disabled:!!i.attr("disabled"),selected:!!i.attr("checked")};break;case"radio":h={type:"radio",name:f||c(j),disabled:!!i.attr("disabled"),radio:!!i.attr("name"),value:i.val(),selected:!!i.attr("checked")};break;default:h=b}break;case"select":h={type:"select",name:f||c(j),disabled:!!i.attr("disabled"),selected:i.val(),options:{}},i.children().each(function(){h.options[this.value]=a(this).text()});break;case"textarea":h={type:"textarea",name:f||c(j),disabled:!!i.attr("disabled"),value:i.val()};break;case"label":break;default:h={type:"html",html:i.clone(!0)}}h&&(g++,e["key"+g]=h)}),g}if(a.support.htmlMenuitem="HTMLMenuItemElement"in window,a.support.htmlCommand="HTMLCommandElement"in window,a.support.eventSelectstart="onselectstart"in document.documentElement,!a.ui||!a.ui.widget){var e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(f){}e(b)}}var f,g=null,h=!1,i=a(window),j=0,k={},l={},m={},n={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,determinePosition:function(b){if(a.ui&&a.ui.position)b.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var c=this.offset();c.top+=this.outerHeight(),c.left+=this.outerWidth()/2-b.outerWidth()/2,b.css(c)}},position:function(a,b,c){if(b||c){b="maintain"===b&&"maintain"===c?a.$menu.position():{top:c,left:b},c=i.scrollTop()+i.height();var d=i.scrollLeft()+i.width(),e=a.$menu.height(),f=a.$menu.width();b.top+e>c&&(b.top-=e),b.left+f>d&&(b.left-=f),a.$menu.css(b)}else a.determinePosition.call(this,a.$menu)},positionSubmenu:function(b){if(a.ui&&a.ui.position)b.css("display","block").position({my:"left top",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var c={top:0,left:this.outerWidth()};b.css(c)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:a.noop,hide:a.noop},callback:null,items:{}},o=null,p=null,q=null,r={abortevent:function(a){a.preventDefault(),a.stopImmediatePropagation()},contextmenu:function(b){var c=a(this);if(b.preventDefault(),b.stopImmediatePropagation(),!("right"!=b.data.trigger&&b.originalEvent||c.hasClass("context-menu-active")||c.hasClass("context-menu-disabled"))){if(g=c,b.data.build){var d=b.data.build(g,b);if(!1===d)return;if(b.data=a.extend(!0,{},n,b.data,d||{}),!b.data.items||a.isEmptyObject(b.data.items))throw window.console&&(console.error||console.log)("No items specified to show in contextMenu"),Error("No Items sepcified");b.data.$trigger=g,s.create(b.data)}s.show.call(c,b.data,b.pageX,b.pageY)}},click:function(b){b.preventDefault(),b.stopImmediatePropagation(),a(this).trigger(a.Event("contextmenu",{data:b.data,pageX:b.pageX,pageY:b.pageY}))},mousedown:function(b){var c=a(this);g&&g.length&&!g.is(c)&&g.data("contextMenu").$menu.trigger("contextmenu:hide"),2==b.button&&(g=c.data("contextMenuActive",!0))},mouseup:function(b){var c=a(this);c.data("contextMenuActive")&&g&&g.length&&g.is(c)&&!c.hasClass("context-menu-disabled")&&(b.preventDefault(),b.stopImmediatePropagation(),g=c,c.trigger(a.Event("contextmenu",{data:b.data,pageX:b.pageX,pageY:b.pageY}))),c.removeData("contextMenuActive")},mouseenter:function(b){var c=a(this),d=a(b.relatedTarget),e=a(document);d.is(".context-menu-list")||d.closest(".context-menu-list").length||g&&g.length||(p=b.pageX,q=b.pageY,f=b.data,e.on("mousemove.contextMenuShow",r.mousemove),o=setTimeout(function(){o=null,e.off("mousemove.contextMenuShow"),g=c,c.trigger(a.Event("contextmenu",{data:f,pageX:p,pageY:q}))},b.data.delay))},mousemove:function(a){p=a.pageX,q=a.pageY},mouseleave:function(b){if(b=a(b.relatedTarget),!b.is(".context-menu-list")&&!b.closest(".context-menu-list").length){try{clearTimeout(o)}catch(c){}o=null}},layerClick:function(b){var c,d,e=a(this).data("contextMenuRoot"),f=b.button,g=b.pageX,h=b.pageY;b.preventDefault(),b.stopImmediatePropagation(),setTimeout(function(){var j,k="left"==e.trigger&&0===f||"right"==e.trigger&&2===f;if(document.elementFromPoint&&(e.$layer.hide(),c=document.elementFromPoint(g-i.scrollLeft(),h-i.scrollTop()),e.$layer.show()),e.reposition&&k)if(document.elementFromPoint){if(e.$trigger.is(c)||e.$trigger.has(c).length)return void e.position.call(e.$trigger,e,g,h)}else if(d=e.$trigger.offset(),j=a(window),d.top+=j.scrollTop(),d.top<=b.pageY&&(d.left+=j.scrollLeft(),d.left<=b.pageX&&(d.bottom=d.top+e.$trigger.outerHeight(),d.bottom>=b.pageY&&(d.right=d.left+e.$trigger.outerWidth(),d.right>=b.pageX))))return void e.position.call(e.$trigger,e,g,h);c&&k&&e.$trigger.one("contextmenu:hidden",function(){a(c).contextMenu({x:g,y:h})}),e.$menu.trigger("contextmenu:hide")},50)},keyStop:function(a,b){b.isInput||a.preventDefault(),a.stopPropagation()},key:function(a){var b=g.data("contextMenu")||{};switch(a.keyCode){case 9:case 38:if(r.keyStop(a,b),b.isInput){if(9==a.keyCode&&a.shiftKey)return a.preventDefault(),b.$selected&&b.$selected.find("input, textarea, select").blur(),void b.$menu.trigger("prevcommand");if(38==a.keyCode&&"checkbox"==b.$selected.find("input, textarea, select").prop("type"))return void a.preventDefault()}else if(9!=a.keyCode||a.shiftKey)return void b.$menu.trigger("prevcommand");case 40:if(r.keyStop(a,b),!b.isInput)return void b.$menu.trigger("nextcommand");if(9==a.keyCode)return a.preventDefault(),b.$selected&&b.$selected.find("input, textarea, select").blur(),void b.$menu.trigger("nextcommand");if(40==a.keyCode&&"checkbox"==b.$selected.find("input, textarea, select").prop("type"))return void a.preventDefault();break;case 37:if(r.keyStop(a,b),b.isInput||!b.$selected||!b.$selected.length)break;if(!b.$selected.parent().hasClass("context-menu-root"))return a=b.$selected.parent().parent(),b.$selected.trigger("contextmenu:blur"),void(b.$selected=a);break;case 39:if(r.keyStop(a,b),b.isInput||!b.$selected||!b.$selected.length)break;var c=b.$selected.data("contextMenu")||{};if(c.$menu&&b.$selected.hasClass("context-menu-submenu"))return b.$selected=null,c.$selected=null,void c.$menu.trigger("nextcommand");break;case 35:case 36:return void(b.$selected&&b.$selected.find("input, textarea, select").length||((b.$selected&&b.$selected.parent()||b.$menu).children(":not(.disabled, .not-selectable)")[36==a.keyCode?"first":"last"]().trigger("contextmenu:focus"),a.preventDefault()));case 13:if(r.keyStop(a,b),b.isInput){if(b.$selected&&!b.$selected.is("textarea, select"))return void a.preventDefault();break}return void(b.$selected&&b.$selected.trigger("mouseup"));case 32:case 33:case 34:return void r.keyStop(a,b);case 27:return r.keyStop(a,b),void b.$menu.trigger("contextmenu:hide");default:if(c=String.fromCharCode(a.keyCode).toUpperCase(),b.accesskeys[c])return void b.accesskeys[c].$node.trigger(b.accesskeys[c].$menu?"contextmenu:focus":"mouseup")}a.stopPropagation(),b.$selected&&b.$selected.trigger(a)},prevItem:function(b){b.stopPropagation();var c=a(this).data("contextMenu")||{};if(c.$selected){var d=c.$selected,c=c.$selected.parent().data("contextMenu")||{};c.$selected=d}for(var d=c.$menu.children(),e=c.$selected&&c.$selected.prev().length?c.$selected.prev():d.last(),f=e;e.hasClass("disabled")||e.hasClass("not-selectable");)if(e=e.prev().length?e.prev():d.last(),e.is(f))return;c.$selected&&r.itemMouseleave.call(c.$selected.get(0),b),r.itemMouseenter.call(e.get(0),b),b=e.find("input, textarea, select"),b.length&&b.focus()},nextItem:function(b){b.stopPropagation();var c=a(this).data("contextMenu")||{};if(c.$selected){var d=c.$selected,c=c.$selected.parent().data("contextMenu")||{};c.$selected=d}for(var d=c.$menu.children(),e=c.$selected&&c.$selected.next().length?c.$selected.next():d.first(),f=e;e.hasClass("disabled")||e.hasClass("not-selectable");)if(e=e.next().length?e.next():d.first(),e.is(f))return;c.$selected&&r.itemMouseleave.call(c.$selected.get(0),b),r.itemMouseenter.call(e.get(0),b),b=e.find("input, textarea, select"),b.length&&b.focus()},focusInput:function(){var b=a(this).closest(".context-menu-item"),c=b.data(),d=c.contextMenu,c=c.contextMenuRoot;c.$selected=d.$selected=b,c.isInput=d.isInput=!0},blurInput:function(){var b=a(this).closest(".context-menu-item").data();b.contextMenuRoot.isInput=b.contextMenu.isInput=!1},menuMouseenter:function(){a(this).data().contextMenuRoot.hovering=!0},menuMouseleave:function(b){var c=a(this).data().contextMenuRoot;c.$layer&&c.$layer.is(b.relatedTarget)&&(c.hovering=!1)},itemMouseenter:function(b){var c=a(this),d=c.data(),e=d.contextMenu,d=d.contextMenuRoot;d.hovering=!0,b&&d.$layer&&d.$layer.is(b.relatedTarget)&&(b.preventDefault(),b.stopImmediatePropagation()),(e.$menu?e:d).$menu.children(".hover").trigger("contextmenu:blur"),c.hasClass("disabled")||c.hasClass("not-selectable")?e.$selected=null:c.trigger("contextmenu:focus")},itemMouseleave:function(b){var c=a(this),d=c.data(),e=d.contextMenu,d=d.contextMenuRoot;d!==e&&d.$layer&&d.$layer.is(b.relatedTarget)?(d.$selected&&d.$selected.trigger("contextmenu:blur"),b.preventDefault(),b.stopImmediatePropagation(),d.$selected=e.$selected=e.$node):c.trigger("contextmenu:blur")},itemClick:function(b){var c=a(this),d=c.data(),e=d.contextMenuRoot,f=d.contextMenuKey;if(d.contextMenu.items[f]&&!c.is(".disabled, .context-menu-submenu, .context-menu-separator, .not-selectable")){if(b.preventDefault(),b.stopImmediatePropagation(),a.isFunction(e.callbacks[f])&&Object.prototype.hasOwnProperty.call(e.callbacks,f))b=e.callbacks[f];
else{if(!a.isFunction(e.callback))return;b=e.callback}!1!==b.call(e.$trigger,f,e)?e.$menu.trigger("contextmenu:hide"):e.$menu.parent().length&&s.update.call(e.$trigger,e)}},inputClick:function(a){a.stopImmediatePropagation()},hideMenu:function(b,c){var d=a(this).data("contextMenuRoot");s.hide.call(d.$trigger,d,c&&c.force)},focusItem:function(b){b.stopPropagation(),b=a(this);var c=b.data(),d=c.contextMenu,c=c.contextMenuRoot;b.addClass("hover").siblings(".hover").trigger("contextmenu:blur"),d.$selected=c.$selected=b,d.$node&&c.positionSubmenu.call(d.$node,d.$menu)},blurItem:function(b){b.stopPropagation(),b=a(this);var c=b.data().contextMenu;b.removeClass("hover"),c.$selected=null}},s={show:function(b,c,d){var e=a(this),f={};if(a("#context-menu-layer").trigger("mousedown"),b.$trigger=e,!1===b.events.show.call(e,b))g=null;else{if(s.update.call(e,b),b.position.call(e,b,c,d),b.zIndex){for(c=0,d=e;c=Math.max(c,parseInt(d.css("z-index"),10)||0),d=d.parent(),!(!d||!d.length||-1<"html body".indexOf(d.prop("nodeName").toLowerCase())););f.zIndex=c+b.zIndex}s.layer.call(b.$menu,b,f.zIndex),b.$menu.find("ul").css("zIndex",f.zIndex+1),b.$menu.css(f)[b.animation.show](b.animation.duration,function(){e.trigger("contextmenu:visible")}),e.data("contextMenu",b).addClass("context-menu-active"),a(document).off("keydown.contextMenu").on("keydown.contextMenu",r.key),b.autoHide&&a(document).on("mousemove.contextMenuAutoHide",function(a){var c=e.offset();c.right=c.left+e.outerWidth(),c.bottom=c.top+e.outerHeight(),!(!b.$layer||b.hovering||a.pageX>=c.left&&a.pageX<=c.right&&a.pageY>=c.top&&a.pageY<=c.bottom||!b.$menu.trigger("contextmenu:hide"))})}},hide:function(c,d){var e=a(this);if(c||(c=e.data("contextMenu")||{}),d||!c.events||!1!==c.events.hide.call(e,c)){if(e.removeData("contextMenu").removeClass("context-menu-active"),c.$layer){var f=c.$layer;setTimeout(function(){f.remove()},10);try{delete c.$layer}catch(h){c.$layer=null}}g=null,c.$menu.find(".hover").trigger("contextmenu:blur"),c.$selected=null,a(document).off(".contextMenuAutoHide").off("keydown.contextMenu"),c.$menu&&c.$menu[c.animation.hide](c.animation.duration,function(){c.build&&(c.$menu.remove(),a.each(c,function(a){switch(a){case"ns":case"selector":case"build":case"trigger":return!0;default:c[a]=b;try{delete c[a]}catch(d){}return!0}})),setTimeout(function(){e.trigger("contextmenu:hidden")},10)})}},create:function(c,d){d===b&&(d=c),c.$menu=a('<ul class="context-menu-list"></ul>').addClass(c.className||"").data({contextMenu:c,contextMenuRoot:d}),a.each(["callbacks","commands","inputs"],function(a,b){c[b]={},d[b]||(d[b]={})}),d.accesskeys||(d.accesskeys={}),a.each(c.items,function(b,e){var f=a('<li class="context-menu-item"></li>').addClass(e.className||""),g=null,h=null;if(f.on("click",a.noop),e.$node=f.data({contextMenu:c,contextMenuRoot:d,contextMenuKey:b}),e.accesskey){for(var i,j=e.accesskey.split(/\s+/),k=[],l=0;i=j[l];l++)i=i[0].toUpperCase(),k.push(i);for(j=0;l=k[j];j++)if(!d.accesskeys[l]){d.accesskeys[l]=e,e._name=e.name.replace(RegExp("("+l+")","i"),'<span class="context-menu-accesskey">$1</span>');break}}if("string"==typeof e)f.addClass("context-menu-separator not-selectable");else if(e.type&&m[e.type])m[e.type].call(f,e,c,d),a.each([c,d],function(c,d){d.commands[b]=e,a.isFunction(e.callback)&&(d.callbacks[b]=e.callback)});else{switch("html"==e.type?f.addClass("context-menu-html not-selectable"):e.type?(g=a("<label></label>").appendTo(f),a("<span></span>").html(e._name||e.name).appendTo(g),f.addClass("context-menu-input"),c.hasTypes=!0,a.each([c,d],function(a,c){c.commands[b]=e,c.inputs[b]=e})):e.items&&(e.type="sub"),e.type){case"text":h=a('<input type="text" value="1" name="" value="">').attr("name","context-menu-input-"+b).val(e.value||"").appendTo(g);break;case"textarea":h=a('<textarea name=""></textarea>').attr("name","context-menu-input-"+b).val(e.value||"").appendTo(g),e.height&&h.height(e.height);break;case"checkbox":h=a('<input type="checkbox" value="1" name="" value="">').attr("name","context-menu-input-"+b).val(e.value||"").prop("checked",!!e.selected).prependTo(g);break;case"radio":h=a('<input type="radio" value="1" name="" value="">').attr("name","context-menu-input-"+e.radio).val(e.value||"").prop("checked",!!e.selected).prependTo(g);break;case"select":h=a('<select name="">').attr("name","context-menu-input-"+b).appendTo(g),e.options&&(a.each(e.options,function(b,c){a("<option></option>").val(b).text(c).appendTo(h)}),h.val(e.selected));break;case"sub":a("<span></span>").html(e._name||e.name).appendTo(f),e.appendTo=e.$node,s.create(e,d),f.data("contextMenu",e).addClass("context-menu-submenu"),e.callback=null;break;case"html":a(e.html).appendTo(f);break;default:a.each([c,d],function(c,d){d.commands[b]=e,a.isFunction(e.callback)&&(d.callbacks[b]=e.callback)}),a("<span></span>").html(e._name||e.name||"").appendTo(f)}e.type&&"sub"!=e.type&&"html"!=e.type&&(h.on("focus",r.focusInput).on("blur",r.blurInput),e.events)&&h.on(e.events,c),e.icon&&f.addClass("icon icon-"+e.icon)}e.$input=h,e.$label=g,f.appendTo(c.$menu),!c.hasTypes&&a.support.eventSelectstart&&f.on("selectstart.disableTextSelect",r.abortevent)}),c.$node||c.$menu.css("display","none").addClass("context-menu-root"),c.$menu.appendTo(c.appendTo||document.body)},resize:function(b,c){b.css({position:"absolute",display:"block"}),b.data("width",Math.ceil(b.width())+1),b.css({position:"static",minWidth:"0px",maxWidth:"100000px"}),b.find("> li > ul").each(function(){s.resize(a(this),!0)}),c||b.find("ul").andSelf().css({position:"",display:"",minWidth:"",maxWidth:""}).width(function(){return a(this).data("width")})},update:function(c,d){var e=this;d===b&&(d=c,s.resize(c.$menu)),c.$menu.children().each(function(){var b=a(this),f=b.data("contextMenuKey"),g=c.items[f],f=a.isFunction(g.disabled)&&g.disabled.call(e,f,d)||!0===g.disabled;if(b[f?"addClass":"removeClass"]("disabled"),g.type)switch(b.find("input, select, textarea").prop("disabled",f),g.type){case"text":case"textarea":g.$input.val(g.value||"");break;case"checkbox":case"radio":g.$input.val(g.value||"").prop("checked",!!g.selected);break;case"select":g.$input.val(g.selected||"")}g.$menu&&s.update.call(e,g,d)})},layer:function(b,c){var d=b.$layer=a('<div id="context-menu-layer" style="position:fixed; z-index:'+c+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"></div>').css({height:i.height(),width:i.width(),display:"block"}).data("contextMenuRoot",b).insertBefore(this).on("contextmenu",r.abortevent).on("mousedown",r.layerClick);return a.support.fixedPosition||d.css({position:"absolute",height:a(document).height()}),d}};a.fn.contextMenu=function(c){return c===b?this.first().trigger("contextmenu"):c.x&&c.y?this.first().trigger(a.Event("contextmenu",{pageX:c.x,pageY:c.y})):"hide"===c?(c=this.data("contextMenu").$menu)&&c.trigger("contextmenu:hide"):"destroy"===c?a.contextMenu("destroy",{context:this}):a.isPlainObject(c)?(c.context=this,a.contextMenu("create",c)):c?this.removeClass("context-menu-disabled"):c||this.addClass("context-menu-disabled"),this},a.contextMenu=function(c,d){"string"!=typeof c&&(d=c,c="create"),"string"==typeof d?d={selector:d}:d===b&&(d={});var e=a.extend(!0,{},n,d||{}),f=a(document),g=f,i=!1;switch(e.context&&e.context.length?(g=a(e.context).first(),e.context=g.get(0),i=e.context!==document):e.context=document,c){case"create":if(!e.selector)throw Error("No selector specified");if(e.selector.match(/.context-menu-(list|item|input)($|\s)/))throw Error('Cannot bind to selector "'+e.selector+'" as it contains a reserved className');if(!e.build&&(!e.items||a.isEmptyObject(e.items)))throw Error("No Items sepcified");switch(j++,e.ns=".contextMenu"+j,i||(k[e.selector]=e.ns),l[e.ns]=e,e.trigger||(e.trigger="right"),h||(f.on({"contextmenu:hide.contextMenu":r.hideMenu,"prevcommand.contextMenu":r.prevItem,"nextcommand.contextMenu":r.nextItem,"contextmenu.contextMenu":r.abortevent,"mouseenter.contextMenu":r.menuMouseenter,"mouseleave.contextMenu":r.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",r.inputClick).on({"mouseup.contextMenu":r.itemClick,"contextmenu:focus.contextMenu":r.focusItem,"contextmenu:blur.contextMenu":r.blurItem,"contextmenu.contextMenu":r.abortevent,"mouseenter.contextMenu":r.itemMouseenter,"mouseleave.contextMenu":r.itemMouseleave},".context-menu-item"),h=!0),g.on("contextmenu"+e.ns,e.selector,e,r.contextmenu),i&&g.on("remove"+e.ns,function(){a(this).contextMenu("destroy")}),e.trigger){case"hover":g.on("mouseenter"+e.ns,e.selector,e,r.mouseenter).on("mouseleave"+e.ns,e.selector,e,r.mouseleave);break;case"left":g.on("click"+e.ns,e.selector,e,r.click)}e.build||s.create(e);break;case"destroy":var m;if(i){var o=e.context;a.each(l,function(b,c){if(c.context!==o)return!0;m=a(".context-menu-list").filter(":visible"),m.length&&m.data().contextMenuRoot.$trigger.is(a(c.context).find(c.selector))&&m.trigger("contextmenu:hide",{force:!0});try{l[c.ns].$menu&&l[c.ns].$menu.remove(),delete l[c.ns]}catch(d){l[c.ns]=null}return a(c.context).off(c.ns),!0})}else if(e.selector){if(k[e.selector]){m=a(".context-menu-list").filter(":visible"),m.length&&m.data().contextMenuRoot.$trigger.is(e.selector)&&m.trigger("contextmenu:hide",{force:!0});try{l[k[e.selector]].$menu&&l[k[e.selector]].$menu.remove(),delete l[k[e.selector]]}catch(p){l[k[e.selector]]=null}f.off(k[e.selector])}}else f.off(".contextMenu .contextMenuAutoHide"),a.each(l,function(b,c){a(c.context).off(c.ns)}),k={},l={},j=0,h=!1,a("#context-menu-layer, .context-menu-list").remove();break;case"html5":(!a.support.htmlCommand&&!a.support.htmlMenuitem||"boolean"==typeof d&&d)&&a('menu[type="context"]').each(function(){this.id&&a.contextMenu({selector:"[contextmenu="+this.id+"]",items:a.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw Error('Unknown operation "'+c+'"')}return this},a.contextMenu.setInputValues=function(c,d){d===b&&(d={}),a.each(c.inputs,function(a,b){switch(b.type){case"text":case"textarea":b.value=d[a]||"";break;case"checkbox":b.selected=d[a]?!0:!1;break;case"radio":b.selected=(d[b.radio]||"")==b.value?!0:!1;break;case"select":b.selected=d[a]||""}})},a.contextMenu.getInputValues=function(c,d){return d===b&&(d={}),a.each(c.inputs,function(a,b){switch(b.type){case"text":case"textarea":case"select":d[a]=b.$input.val();break;case"checkbox":d[a]=b.$input.prop("checked");break;case"radio":b.$input.prop("checked")&&(d[b.radio]=b.value)}}),d},a.contextMenu.fromMenu=function(b){b=a(b);var c={};return d(c,b.children()),c},a.contextMenu.defaults=n,a.contextMenu.types=m,a.contextMenu.handle=r,a.contextMenu.op=s,a.contextMenu.menus=l}(jQuery),!function(){function a(b,c,d){var e=a.resolve(b);if(null==e){d=d||b,c=c||"root";var f=new Error('Failed to require "'+d+'" from "'+c+'"');throw f.path=d,f.parent=c,f.require=!0,f}var g=a.modules[e];if(!g._resolving&&!g.exports){var h={};h.exports={},h.client=h.component=!0,g._resolving=!0,g.call(this,h.exports,a.relative(e),h),delete g._resolving,g.exports=h.exports}return g.exports}a.modules={},a.aliases={},a.resolve=function(b){"/"===b.charAt(0)&&(b=b.slice(1));for(var c=[b,b+".js",b+".json",b+"/index.js",b+"/index.json"],d=0;d<c.length;d++){var b=c[d];if(a.modules.hasOwnProperty(b))return b;if(a.aliases.hasOwnProperty(b))return a.aliases[b]}},a.normalize=function(a,b){var c=[];if("."!=b.charAt(0))return b;a=a.split("/"),b=b.split("/");for(var d=0;d<b.length;++d)".."==b[d]?a.pop():"."!=b[d]&&""!=b[d]&&c.push(b[d]);return a.concat(c).join("/")},a.register=function(b,c){a.modules[b]=c},a.alias=function(b,c){if(!a.modules.hasOwnProperty(b))throw new Error('Failed to alias "'+b+'", it does not exist');a.aliases[c]=b},a.relative=function(b){function c(a,b){for(var c=a.length;c--;)if(a[c]===b)return c;return-1}function d(c){var e=d.resolve(c);return a(e,b,c)}var e=a.normalize(b,"..");return d.resolve=function(d){var f=d.charAt(0);if("/"==f)return d.slice(1);if("."==f)return a.normalize(e,d);var g=b.split("/"),h=c(g,"deps")+1;return h||(h=0),d=g.slice(0,h+1).join("/")+"/deps/"+d},d.exists=function(b){return a.modules.hasOwnProperty(d.resolve(b))},d},a.register("component-emitter/index.js",function(a,b,c){function d(a){return a?e(a):void 0}function e(a){for(var b in d.prototype)a[b]=d.prototype[b];return a}c.exports=d,d.prototype.on=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks[a]=this._callbacks[a]||[]).push(b),this},d.prototype.once=function(a,b){function c(){d.off(a,c),b.apply(this,arguments)}var d=this;return this._callbacks=this._callbacks||{},b._off=c,this.on(a,c),this},d.prototype.off=d.prototype.removeListener=d.prototype.removeAllListeners=function(a,b){this._callbacks=this._callbacks||{};var c=this._callbacks[a];if(!c)return this;if(1==arguments.length)return delete this._callbacks[a],this;var d=c.indexOf(b._off||b);return~d&&c.splice(d,1),this},d.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks[a];if(c){c=c.slice(0);for(var d=0,e=c.length;e>d;++d)c[d].apply(this,b)}return this},d.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks[a]||[]},d.prototype.hasListeners=function(a){return!!this.listeners(a).length}}),a.register("dropzone/index.js",function(a,b,c){c.exports=b("./lib/dropzone.js")}),a.register("dropzone/lib/dropzone.js",function(a,b,c){(function(){var a,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},m=[].slice;d="undefined"!=typeof Emitter&&null!==Emitter?Emitter:b("emitter"),i=function(){},a=function(a){function b(a,d){var e,f,g;if(this.element=a,this.version=b.version,this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,""),this.clickableElements=[],this.listeners=[],this.files=[],"string"==typeof this.element&&(this.element=document.querySelector(this.element)),!this.element||null==this.element.nodeType)throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("Dropzone already attached.");if(b.instances.push(this),this.element.dropzone=this,e=null!=(g=b.optionsForElement(this.element))?g:{},this.options=c({},this.defaultOptions,e,null!=d?d:{}),this.options.forceFallback||!b.isBrowserSupported())return this.options.fallback.call(this);if(null==this.options.url&&(this.options.url=this.element.getAttribute("action")),!this.options.url)throw new Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");this.options.acceptedMimeTypes&&(this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes),this.options.method=this.options.method.toUpperCase(),(f=this.getExistingFallback())&&f.parentNode&&f.parentNode.removeChild(f),this.previewsContainer=this.options.previewsContainer?b.getElement(this.options.previewsContainer,"previewsContainer"):this.element,this.options.clickable&&(this.clickableElements=this.options.clickable===!0?[this.element]:b.getElements(this.options.clickable,"clickable")),this.init()}var c;return l(b,a),b.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached"],b.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:100,thumbnailHeight:100,maxFiles:null,params:{},clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,addRemoveLinks:!1,previewsContainer:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(a,b){return b()},init:function(){return i},forceFallback:!1,fallback:function(){var a,c,d,e,f,g;for(this.element.className=""+this.element.className+" dz-browser-not-supported",g=this.element.getElementsByTagName("div"),e=0,f=g.length;f>e;e++)a=g[e],/(^| )dz-message($| )/.test(a.className)&&(c=a,a.className="dz-message");return c||(c=b.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(c)),d=c.getElementsByTagName("span")[0],d&&(d.textContent=this.options.dictFallbackMessage),this.element.appendChild(this.getFallbackForm())},resize:function(a){var b,c,d;return b={srcX:0,srcY:0,srcWidth:a.width,srcHeight:a.height},c=a.width/a.height,d=this.options.thumbnailWidth/this.options.thumbnailHeight,a.height<this.options.thumbnailHeight||a.width<this.options.thumbnailWidth?(b.trgHeight=b.srcHeight,b.trgWidth=b.srcWidth):c>d?(b.srcHeight=a.height,b.srcWidth=b.srcHeight*d):(b.srcWidth=a.width,b.srcHeight=b.srcWidth/d),b.srcX=(a.width-b.srcWidth)/2,b.srcY=(a.height-b.srcHeight)/2,b},drop:function(){return this.element.classList.remove("dz-drag-hover")},dragstart:i,dragend:function(){return this.element.classList.remove("dz-drag-hover")},dragenter:function(){return this.element.classList.add("dz-drag-hover")},dragover:function(){return this.element.classList.add("dz-drag-hover")},dragleave:function(){return this.element.classList.remove("dz-drag-hover")},paste:i,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(a){var c,d,e,f,g,h,i,j,k,l,m,n,o,p=this;for(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),a.previewElement=b.createElement(this.options.previewTemplate.trim()),a.previewTemplate=a.previewElement,this.previewsContainer.appendChild(a.previewElement),l=a.previewElement.querySelectorAll("[data-dz-name]"),f=0,i=l.length;i>f;f++)c=l[f],c.textContent=a.name;for(m=a.previewElement.querySelectorAll("[data-dz-size]"),g=0,j=m.length;j>g;g++)c=m[g],c.innerHTML=this.filesize(a.size);for(this.options.addRemoveLinks&&(a._removeLink=b.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),a.previewElement.appendChild(a._removeLink)),d=function(c){return c.preventDefault(),c.stopPropagation(),a.status===b.UPLOADING?b.confirm(p.options.dictCancelUploadConfirmation,function(){return p.removeFile(a)}):p.options.dictRemoveFileConfirmation?b.confirm(p.options.dictRemoveFileConfirmation,function(){return p.removeFile(a)}):p.removeFile(a)},n=a.previewElement.querySelectorAll("[data-dz-remove]"),o=[],h=0,k=n.length;k>h;h++)e=n[h],o.push(e.addEventListener("click",d));return o},removedfile:function(a){var b;return null!=(b=a.previewElement)&&b.parentNode.removeChild(a.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(a,b){var c,d,e,f,g;for(a.previewElement.classList.remove("dz-file-preview"),a.previewElement.classList.add("dz-image-preview"),f=a.previewElement.querySelectorAll("[data-dz-thumbnail]"),g=[],d=0,e=f.length;e>d;d++)c=f[d],c.alt=a.name,g.push(c.src=b);return g},error:function(a,b){var c,d,e,f,g;for(a.previewElement.classList.add("dz-error"),"String"!=typeof b&&b.error&&(b=b.error),f=a.previewElement.querySelectorAll("[data-dz-errormessage]"),g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(c.textContent=b);return g},errormultiple:i,processing:function(a){return a.previewElement.classList.add("dz-processing"),a._removeLink?a._removeLink.textContent=this.options.dictCancelUpload:void 0},processingmultiple:i,uploadprogress:function(a,b){var c,d,e,f,g;for(f=a.previewElement.querySelectorAll("[data-dz-uploadprogress]"),g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(c.style.width=""+b+"%");return g},totaluploadprogress:i,sending:i,sendingmultiple:i,success:function(a){return a.previewElement.classList.add("dz-success")},successmultiple:i,canceled:function(a){return this.emit("error",a,"Upload canceled.")},canceledmultiple:i,complete:function(a){return a._removeLink?a._removeLink.textContent=this.options.dictRemoveFile:void 0},completemultiple:i,maxfilesexceeded:i,maxfilesreached:i,previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-details">\n    <div class="dz-filename"><span data-dz-name></span></div>\n    <div class="dz-size" data-dz-size></div>\n    <img data-dz-thumbnail />\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-success-mark"><span>✔</span></div>\n  <div class="dz-error-mark"><span>✘</span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n</div>'},c=function(){var a,b,c,d,e,f,g;for(d=arguments[0],c=2<=arguments.length?m.call(arguments,1):[],f=0,g=c.length;g>f;f++){b=c[f];for(a in b)e=b[a],d[a]=e}return d},b.prototype.getAcceptedFiles=function(){var a,b,c,d,e;for(d=this.files,e=[],b=0,c=d.length;c>b;b++)a=d[b],a.accepted&&e.push(a);return e},b.prototype.getRejectedFiles=function(){var a,b,c,d,e;for(d=this.files,e=[],b=0,c=d.length;c>b;b++)a=d[b],a.accepted||e.push(a);return e},b.prototype.getQueuedFiles=function(){var a,c,d,e,f;for(e=this.files,f=[],c=0,d=e.length;d>c;c++)a=e[c],a.status===b.QUEUED&&f.push(a);return f},b.prototype.getUploadingFiles=function(){var a,c,d,e,f;for(e=this.files,f=[],c=0,d=e.length;d>c;c++)a=e[c],a.status===b.UPLOADING&&f.push(a);return f},b.prototype.init=function(){var a,c,d,e,f,g,h,i=this;for("form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(b.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&(d=function(){return i.hiddenFileInput&&document.body.removeChild(i.hiddenFileInput),i.hiddenFileInput=document.createElement("input"),i.hiddenFileInput.setAttribute("type","file"),(null==i.options.maxFiles||i.options.maxFiles>1)&&i.hiddenFileInput.setAttribute("multiple","multiple"),null!=i.options.acceptedFiles&&i.hiddenFileInput.setAttribute("accept",i.options.acceptedFiles),i.hiddenFileInput.style.visibility="hidden",i.hiddenFileInput.style.position="absolute",i.hiddenFileInput.style.top="0",i.hiddenFileInput.style.left="0",i.hiddenFileInput.style.height="0",i.hiddenFileInput.style.width="0",document.body.appendChild(i.hiddenFileInput),i.hiddenFileInput.addEventListener("change",function(){var a,b,c,e;if(b=i.hiddenFileInput.files,b.length)for(c=0,e=b.length;e>c;c++)a=b[c],i.addFile(a);return d()})})(),this.URL=null!=(g=window.URL)?g:window.webkitURL,h=this.events,e=0,f=h.length;f>e;e++)a=h[e],this.on(a,this.options[a]);return this.on("uploadprogress",function(){return i.updateTotalUploadProgress()}),this.on("removedfile",function(){return i.updateTotalUploadProgress()}),this.on("canceled",function(a){return i.emit("complete",a)}),this.on("complete",function(){return 0===i.getUploadingFiles().length&&0===i.getQueuedFiles().length?setTimeout(function(){return i.emit("queuecomplete")},0):void 0}),c=function(a){return a.stopPropagation(),a.preventDefault?a.preventDefault():a.returnValue=!1},this.listeners=[{element:this.element,events:{dragstart:function(a){return i.emit("dragstart",a)},dragenter:function(a){return c(a),i.emit("dragenter",a)},dragover:function(a){var b;try{b=a.dataTransfer.effectAllowed}catch(d){}return a.dataTransfer.dropEffect="move"===b||"linkMove"===b?"move":"copy",c(a),i.emit("dragover",a)},dragleave:function(a){return i.emit("dragleave",a)},drop:function(a){return c(a),i.drop(a)},dragend:function(a){return i.emit("dragend",a)}}}],this.clickableElements.forEach(function(a){return i.listeners.push({element:a,events:{click:function(c){return a!==i.element||c.target===i.element||b.elementInside(c.target,i.element.querySelector(".dz-message"))?i.hiddenFileInput.click():void 0}}})}),this.enable(),this.options.init.call(this)},b.prototype.destroy=function(){var a;return this.disable(),this.removeAllFiles(!0),(null!=(a=this.hiddenFileInput)?a.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,b.instances.splice(b.instances.indexOf(this),1)},b.prototype.updateTotalUploadProgress=function(){var a,b,c,d,e,f,g,h;if(d=0,c=0,a=this.getAcceptedFiles(),a.length){for(h=this.getAcceptedFiles(),f=0,g=h.length;g>f;f++)b=h[f],d+=b.upload.bytesSent,c+=b.upload.total;e=100*d/c}else e=100;return this.emit("totaluploadprogress",e,c,d)},b.prototype.getFallbackForm=function(){var a,c,d,e;return(a=this.getExistingFallback())?a:(d='<div class="dz-fallback">',this.options.dictFallbackText&&(d+="<p>"+this.options.dictFallbackText+"</p>"),d+='<input type="file" name="'+this.options.paramName+(this.options.uploadMultiple?"[]":"")+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>',c=b.createElement(d),"FORM"!==this.element.tagName?(e=b.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>'),e.appendChild(c)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=e?e:c)},b.prototype.getExistingFallback=function(){var a,b,c,d,e,f;for(b=function(a){var b,c,d;for(c=0,d=a.length;d>c;c++)if(b=a[c],/(^| )fallback($| )/.test(b.className))return b},f=["div","form"],d=0,e=f.length;e>d;d++)if(c=f[d],a=b(this.element.getElementsByTagName(c)))return a},b.prototype.setupEventListeners=function(){var a,b,c,d,e,f,g;for(f=this.listeners,g=[],d=0,e=f.length;e>d;d++)a=f[d],g.push(function(){var d,e;d=a.events,e=[];for(b in d)c=d[b],e.push(a.element.addEventListener(b,c,!1));return e}());return g},b.prototype.removeEventListeners=function(){var a,b,c,d,e,f,g;for(f=this.listeners,g=[],d=0,e=f.length;e>d;d++)a=f[d],g.push(function(){var d,e;d=a.events,e=[];for(b in d)c=d[b],e.push(a.element.removeEventListener(b,c,!1));return e}());return g},b.prototype.disable=function(){var a,b,c,d,e;for(this.clickableElements.forEach(function(a){return a.classList.remove("dz-clickable")}),this.removeEventListeners(),d=this.files,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(this.cancelUpload(a));return e},b.prototype.enable=function(){return this.clickableElements.forEach(function(a){return a.classList.add("dz-clickable")}),this.setupEventListeners()},b.prototype.filesize=function(a){var b;return a>=109951162777.6?(a/=109951162777.6,b="TiB"):a>=107374182.4?(a/=107374182.4,b="GiB"):a>=104857.6?(a/=104857.6,b="MiB"):a>=102.4?(a/=102.4,b="KiB"):(a=10*a,b="b"),"<strong>"+Math.round(a)/10+"</strong> "+b},b.prototype._updateMaxFilesReachedClass=function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")},b.prototype.drop=function(a){var b,c;a.dataTransfer&&(this.emit("drop",a),b=a.dataTransfer.files,b.length&&(c=a.dataTransfer.items,c&&c.length&&null!=c[0].webkitGetAsEntry?this._addFilesFromItems(c):this.handleFiles(b)))},b.prototype.paste=function(a){var b,c;return null!=(null!=a&&null!=(c=a.clipboardData)?c.items:void 0)?(this.emit("paste",a),b=a.clipboardData.items,b.length?this._addFilesFromItems(b):void 0):void 0},b.prototype.handleFiles=function(a){var b,c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(this.addFile(b));return e},b.prototype._addFilesFromItems=function(a){var b,c,d,e,f;for(f=[],d=0,e=a.length;e>d;d++)c=a[d],f.push(null!=c.webkitGetAsEntry&&(b=c.webkitGetAsEntry())?b.isFile?this.addFile(c.getAsFile()):b.isDirectory?this._addFilesFromDirectory(b,b.name):void 0:null!=c.getAsFile?null==c.kind||"file"===c.kind?this.addFile(c.getAsFile()):void 0:void 0);return f},b.prototype._addFilesFromDirectory=function(a,b){var c,d,e=this;return c=a.createReader(),d=function(a){var c,d,f;for(d=0,f=a.length;f>d;d++)c=a[d],c.isFile?c.file(function(a){return e.options.ignoreHiddenFiles&&"."===a.name.substring(0,1)?void 0:(a.fullPath=""+b+"/"+a.name,e.addFile(a))}):c.isDirectory&&e._addFilesFromDirectory(c,""+b+"/"+c.name)},c.readEntries(d,function(a){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log(a):void 0})},b.prototype.accept=function(a,c){return a.size>1024*this.options.maxFilesize*1024?c(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(a.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):b.isValidFile(a,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(c(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",a)):this.options.accept.call(this,a,c):c(this.options.dictInvalidFileType)},b.prototype.addFile=function(a){var c=this;return a.upload={progress:0,total:a.size,bytesSent:0},this.files.push(a),a.status=b.ADDED,this.emit("addedfile",a),this._enqueueThumbnail(a),this.accept(a,function(b){return b?(a.accepted=!1,c._errorProcessing([a],b)):c.enqueueFile(a),c._updateMaxFilesReachedClass()})},b.prototype.enqueueFiles=function(a){var b,c,d;for(c=0,d=a.length;d>c;c++)b=a[c],this.enqueueFile(b);return null},b.prototype.enqueueFile=function(a){var c=this;if(a.accepted=!0,a.status!==b.ADDED)throw new Error("This file can't be queued because it has already been processed or was rejected.");return a.status=b.QUEUED,this.options.autoProcessQueue?setTimeout(function(){return c.processQueue()},0):void 0},b.prototype._thumbnailQueue=[],b.prototype._processingThumbnail=!1,b.prototype._enqueueThumbnail=function(a){var b=this;return this.options.createImageThumbnails&&a.type.match(/image.*/)&&a.size<=1024*this.options.maxThumbnailFilesize*1024?(this._thumbnailQueue.push(a),setTimeout(function(){return b._processThumbnailQueue()},0)):void 0},b.prototype._processThumbnailQueue=function(){var a=this;return this._processingThumbnail||0===this._thumbnailQueue.length?void 0:(this._processingThumbnail=!0,this.createThumbnail(this._thumbnailQueue.shift(),function(){return a._processingThumbnail=!1,a._processThumbnailQueue()}))},b.prototype.removeFile=function(a){return a.status===b.UPLOADING&&this.cancelUpload(a),this.files=j(this.files,a),this.emit("removedfile",a),0===this.files.length?this.emit("reset"):void 0},b.prototype.removeAllFiles=function(a){var c,d,e,f;for(null==a&&(a=!1),f=this.files.slice(),d=0,e=f.length;e>d;d++)c=f[d],(c.status!==b.UPLOADING||a)&&this.removeFile(c);return null},b.prototype.createThumbnail=function(a,b){var c,d=this;return c=new FileReader,c.onload=function(){var e;return e=document.createElement("img"),e.onload=function(){var c,f,g,i,j,k,l,m;return a.width=e.width,a.height=e.height,g=d.options.resize.call(d,a),null==g.trgWidth&&(g.trgWidth=d.options.thumbnailWidth),null==g.trgHeight&&(g.trgHeight=d.options.thumbnailHeight),c=document.createElement("canvas"),f=c.getContext("2d"),c.width=g.trgWidth,c.height=g.trgHeight,h(f,e,null!=(j=g.srcX)?j:0,null!=(k=g.srcY)?k:0,g.srcWidth,g.srcHeight,null!=(l=g.trgX)?l:0,null!=(m=g.trgY)?m:0,g.trgWidth,g.trgHeight),i=c.toDataURL("image/png"),d.emit("thumbnail",a,i),null!=b?b():void 0
},e.src=c.result},c.readAsDataURL(a)},b.prototype.processQueue=function(){var a,b,c,d;if(b=this.options.parallelUploads,c=this.getUploadingFiles().length,a=c,!(c>=b)&&(d=this.getQueuedFiles(),d.length>0)){if(this.options.uploadMultiple)return this.processFiles(d.slice(0,b-c));for(;b>a;){if(!d.length)return;this.processFile(d.shift()),a++}}},b.prototype.processFile=function(a){return this.processFiles([a])},b.prototype.processFiles=function(a){var c,d,e;for(d=0,e=a.length;e>d;d++)c=a[d],c.processing=!0,c.status=b.UPLOADING,this.emit("processing",c);return this.options.uploadMultiple&&this.emit("processingmultiple",a),this.uploadFiles(a)},b.prototype._getFilesWithXhr=function(a){var b,c;return c=function(){var c,d,e,f;for(e=this.files,f=[],c=0,d=e.length;d>c;c++)b=e[c],b.xhr===a&&f.push(b);return f}.call(this)},b.prototype.cancelUpload=function(a){var c,d,e,f,g,h,i;if(a.status===b.UPLOADING){for(d=this._getFilesWithXhr(a.xhr),e=0,g=d.length;g>e;e++)c=d[e],c.status=b.CANCELED;for(a.xhr.abort(),f=0,h=d.length;h>f;f++)c=d[f],this.emit("canceled",c);this.options.uploadMultiple&&this.emit("canceledmultiple",d)}else((i=a.status)===b.ADDED||i===b.QUEUED)&&(a.status=b.CANCELED,this.emit("canceled",a),this.options.uploadMultiple&&this.emit("canceledmultiple",[a]));return this.options.autoProcessQueue?this.processQueue():void 0},b.prototype.uploadFile=function(a){return this.uploadFiles([a])},b.prototype.uploadFiles=function(a){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=this;for(s=new XMLHttpRequest,t=0,x=a.length;x>t;t++)d=a[t],d.xhr=s;s.open(this.options.method,this.options.url,!0),s.withCredentials=!!this.options.withCredentials,p=null,f=function(){var b,c,e;for(e=[],b=0,c=a.length;c>b;b++)d=a[b],e.push(I._errorProcessing(a,p||I.options.dictResponseError.replace("{{statusCode}}",s.status),s));return e},q=function(b){var c,e,f,g,h,i,j,k,l;if(null!=b)for(e=100*b.loaded/b.total,f=0,i=a.length;i>f;f++)d=a[f],d.upload={progress:e,total:b.total,bytesSent:b.loaded};else{for(c=!0,e=100,g=0,j=a.length;j>g;g++)d=a[g],(100!==d.upload.progress||d.upload.bytesSent!==d.upload.total)&&(c=!1),d.upload.progress=e,d.upload.bytesSent=d.upload.total;if(c)return}for(l=[],h=0,k=a.length;k>h;h++)d=a[h],l.push(I.emit("uploadprogress",d,e,d.upload.bytesSent));return l},s.onload=function(c){var d;if(a[0].status!==b.CANCELED&&4===s.readyState){if(p=s.responseText,s.getResponseHeader("content-type")&&~s.getResponseHeader("content-type").indexOf("application/json"))try{p=JSON.parse(p)}catch(e){c=e,p="Invalid JSON response from server."}return q(),200<=(d=s.status)&&300>d?I._finished(a,p,c):f()}},s.onerror=function(){return a[0].status!==b.CANCELED?f():void 0},o=null!=(D=s.upload)?D:s,o.onprogress=q,i={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"},this.options.headers&&c(i,this.options.headers);for(g in i)h=i[g],s.setRequestHeader(g,h);if(e=new FormData,this.options.params){E=this.options.params;for(m in E)r=E[m],e.append(m,r)}for(u=0,y=a.length;y>u;u++)d=a[u],this.emit("sending",d,s,e);if(this.options.uploadMultiple&&this.emit("sendingmultiple",a,s,e),"FORM"===this.element.tagName)for(F=this.element.querySelectorAll("input, textarea, select, button"),v=0,z=F.length;z>v;v++)if(j=F[v],k=j.getAttribute("name"),l=j.getAttribute("type"),"SELECT"===j.tagName&&j.hasAttribute("multiple"))for(G=j.options,w=0,A=G.length;A>w;w++)n=G[w],n.selected&&e.append(k,n.value);else(!l||"checkbox"!==(H=l.toLowerCase())&&"radio"!==H||j.checked)&&e.append(k,j.value);for(C=0,B=a.length;B>C;C++)d=a[C],e.append(""+this.options.paramName+(this.options.uploadMultiple?"[]":""),d,d.name);return s.send(e)},b.prototype._finished=function(a,c,d){var e,f,g;for(f=0,g=a.length;g>f;f++)e=a[f],e.status=b.SUCCESS,this.emit("success",e,c,d),this.emit("complete",e);return this.options.uploadMultiple&&(this.emit("successmultiple",a,c,d),this.emit("completemultiple",a)),this.options.autoProcessQueue?this.processQueue():void 0},b.prototype._errorProcessing=function(a,c,d){var e,f,g;for(f=0,g=a.length;g>f;f++)e=a[f],e.status=b.ERROR,this.emit("error",e,c,d),this.emit("complete",e);return this.options.uploadMultiple&&(this.emit("errormultiple",a,c,d),this.emit("completemultiple",a)),this.options.autoProcessQueue?this.processQueue():void 0},b}(d),a.version="3.8.4",a.options={},a.optionsForElement=function(b){return b.getAttribute("id")?a.options[e(b.getAttribute("id"))]:void 0},a.instances=[],a.forElement=function(a){if("string"==typeof a&&(a=document.querySelector(a)),null==(null!=a?a.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return a.dropzone},a.autoDiscover=!0,a.discover=function(){var b,c,d,e,f,g;for(document.querySelectorAll?d=document.querySelectorAll(".dropzone"):(d=[],b=function(a){var b,c,e,f;for(f=[],c=0,e=a.length;e>c;c++)b=a[c],f.push(/(^| )dropzone($| )/.test(b.className)?d.push(b):void 0);return f},b(document.getElementsByTagName("div")),b(document.getElementsByTagName("form"))),g=[],e=0,f=d.length;f>e;e++)c=d[e],g.push(a.optionsForElement(c)!==!1?new a(c):void 0);return g},a.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i],a.isBrowserSupported=function(){var b,c,d,e,f;if(b=!0,window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(f=a.blacklistedBrowsers,d=0,e=f.length;e>d;d++)c=f[d],c.test(navigator.userAgent)&&(b=!1);else b=!1;else b=!1;return b},j=function(a,b){var c,d,e,f;for(f=[],d=0,e=a.length;e>d;d++)c=a[d],c!==b&&f.push(c);return f},e=function(a){return a.replace(/[\-_](\w)/g,function(a){return a[1].toUpperCase()})},a.createElement=function(a){var b;return b=document.createElement("div"),b.innerHTML=a,b.childNodes[0]},a.elementInside=function(a,b){if(a===b)return!0;for(;a=a.parentNode;)if(a===b)return!0;return!1},a.getElement=function(a,b){var c;if("string"==typeof a?c=document.querySelector(a):null!=a.nodeType&&(c=a),null==c)throw new Error("Invalid `"+b+"` option provided. Please provide a CSS selector or a plain HTML element.");return c},a.getElements=function(a,b){var c,d,e,f,g,h,i,j;if(a instanceof Array){e=[];try{for(f=0,h=a.length;h>f;f++)d=a[f],e.push(this.getElement(d,b))}catch(k){c=k,e=null}}else if("string"==typeof a)for(e=[],j=document.querySelectorAll(a),g=0,i=j.length;i>g;g++)d=j[g],e.push(d);else null!=a.nodeType&&(e=[a]);if(null==e||!e.length)throw new Error("Invalid `"+b+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return e},a.confirm=function(a,b,c){return window.confirm(a)?b():null!=c?c():void 0},a.isValidFile=function(a,b){var c,d,e,f,g;if(!b)return!0;for(b=b.split(","),d=a.type,c=d.replace(/\/.*$/,""),f=0,g=b.length;g>f;f++)if(e=b[f],e=e.trim(),"."===e.charAt(0)){if(-1!==a.name.toLowerCase().indexOf(e.toLowerCase(),a.name.length-e.length))return!0}else if(/\/\*$/.test(e)){if(c===e.replace(/\/.*$/,""))return!0}else if(d===e)return!0;return!1},"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery.fn.dropzone=function(b){return this.each(function(){return new a(this,b)})}),"undefined"!=typeof c&&null!==c?c.exports=a:window.Dropzone=a,a.ADDED="added",a.QUEUED="queued",a.ACCEPTED=a.QUEUED,a.UPLOADING="uploading",a.PROCESSING=a.UPLOADING,a.CANCELED="canceled",a.ERROR="error",a.SUCCESS="success",g=function(a){var b,c,d,e,f,g,h,i,j,k;for(h=a.naturalWidth,g=a.naturalHeight,c=document.createElement("canvas"),c.width=1,c.height=g,d=c.getContext("2d"),d.drawImage(a,0,0),e=d.getImageData(0,0,1,g).data,k=0,f=g,i=g;i>k;)b=e[4*(i-1)+3],0===b?f=i:k=i,i=f+k>>1;return j=i/g,0===j?1:j},h=function(a,b,c,d,e,f,h,i,j,k){var l;return l=g(b),a.drawImage(b,c,d,e,f,h,i,j,k/l)},f=function(a,b){var c,d,e,f,g,h,i,j,k;if(e=!1,k=!0,d=a.document,j=d.documentElement,c=d.addEventListener?"addEventListener":"attachEvent",i=d.addEventListener?"removeEventListener":"detachEvent",h=d.addEventListener?"":"on",f=function(c){return"readystatechange"!==c.type||"complete"===d.readyState?(("load"===c.type?a:d)[i](h+c.type,f,!1),!e&&(e=!0)?b.call(a,c.type||c):void 0):void 0},g=function(){var a;try{j.doScroll("left")}catch(b){return a=b,void setTimeout(g,50)}return f("poll")},"complete"!==d.readyState){if(d.createEventObject&&j.doScroll){try{k=!a.frameElement}catch(l){}k&&g()}return d[c](h+"DOMContentLoaded",f,!1),d[c](h+"readystatechange",f,!1),a[c](h+"load",f,!1)}},a._autoDiscoverFunction=function(){return a.autoDiscover?a.discover():void 0},f(window,a._autoDiscoverFunction)}).call(this)}),a.alias("component-emitter/index.js","dropzone/deps/emitter/index.js"),a.alias("component-emitter/index.js","emitter/index.js"),"object"==typeof exports?module.exports=a("dropzone"):"function"==typeof define&&define.amd?define(function(){return a("dropzone")}):this.Dropzone=a("dropzone")}(),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(){if(!a.contains(document.documentElement,this))return a(this).timeago("dispose"),this;var b=c(this),g=f.settings;return isNaN(b.datetime)||(0==g.cutoff||Math.abs(e(b.datetime))<g.cutoff)&&a(this).text(d(b.datetime)),this}function c(b){if(b=a(b),!b.data("timeago")){b.data("timeago",{datetime:f.datetime(b)});var c=a.trim(b.text());f.settings.localeTitle?b.attr("title",b.data("timeago").datetime.toLocaleString()):!(c.length>0)||f.isTime(b)&&b.attr("title")||b.attr("title",c)}return b.data("timeago")}function d(a){return f.inWords(e(a))}function e(a){return(new Date).getTime()-a.getTime()}a.timeago=function(b){return d(b instanceof Date?b:"string"==typeof b?a.timeago.parse(b):"number"==typeof b?new Date(b):a.timeago.datetime(b))};var f=a.timeago;a.extend(a.timeago,{settings:{refreshMillis:6e4,allowPast:!0,allowFuture:!1,localeTitle:!1,cutoff:0,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:i18n.suffixAgo,suffixFromNow:i18n.suffixFromNow,inPast:i18n.inPast,seconds:i18n.seconds,minute:i18n.minute,minutes:i18n.minutes,hour:i18n.hour,hours:i18n.hours,day:i18n.day,days:i18n.days,month:i18n.month,months:i18n.months,year:i18n.year,years:i18n.years,wordSeparator:" ",numbers:[]}},inWords:function(b){function c(c,e){var f=a.isFunction(c)?c(e,b):c,g=d.numbers&&d.numbers[e]||e;return f.replace(/%d/i,g)}if(!this.settings.allowPast&&!this.settings.allowFuture)throw"timeago allowPast and allowFuture settings can not both be set to false.";var d=this.settings.strings,e=d.prefixAgo,f=d.suffixAgo;if(this.settings.allowFuture&&0>b&&(e=d.prefixFromNow,f=d.suffixFromNow),!this.settings.allowPast&&b>=0)return this.settings.strings.inPast;var g=Math.abs(b)/1e3,h=g/60,i=h/60,j=i/24,k=j/365,l=45>g&&c(d.seconds,Math.round(g))||90>g&&c(d.minute,1)||45>h&&c(d.minutes,Math.round(h))||90>h&&c(d.hour,1)||24>i&&c(d.hours,Math.round(i))||42>i&&c(d.day,1)||30>j&&c(d.days,Math.round(j))||45>j&&c(d.month,1)||365>j&&c(d.months,Math.round(j/30))||1.5>k&&c(d.year,1)||c(d.years,Math.round(k)),m=d.wordSeparator||"";return void 0===d.wordSeparator&&(m=" "),a.trim([e,l,f].join(m))},parse:function(b){var c=a.trim(b);return c=c.replace(/\.\d+/,""),c=c.replace(/-/,"/").replace(/-/,"/"),c=c.replace(/T/," ").replace(/Z/," UTC"),c=c.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),c=c.replace(/([\+\-]\d\d)$/," $100"),new Date(c)},datetime:function(b){var c=a(b).attr(f.isTime(b)?"datetime":"title");return f.parse(c)},isTime:function(b){return"time"===a(b).get(0).tagName.toLowerCase()}});var g={init:function(){var c=a.proxy(b,this);c();var d=f.settings;d.refreshMillis>0&&(this._timeagoInterval=setInterval(c,d.refreshMillis))},update:function(c){var d=f.parse(c);a(this).data("timeago",{datetime:d}),f.settings.localeTitle&&a(this).attr("title",d.toLocaleString()),b.apply(this)},updateFromDOM:function(){a(this).data("timeago",{datetime:f.parse(a(this).attr(f.isTime(this)?"datetime":"title"))}),b.apply(this)},dispose:function(){this._timeagoInterval&&(window.clearInterval(this._timeagoInterval),this._timeagoInterval=null)}};a.fn.timeago=function(a,b){var c=a?g[a]:g.init;if(!c)throw new Error("Unknown function name '"+a+"' for timeago");return this.each(function(){c.call(this,b)}),this},document.createElement("abbr"),document.createElement("time")}),function(a){a.fn.fitText=function(b,c){var d=b||1,e=a.extend({minFontSize:Number.NEGATIVE_INFINITY,maxFontSize:Number.POSITIVE_INFINITY},c);return this.each(function(){var b=a(this),c=function(){b.css("font-size",Math.max(Math.min(b.width()/(10*d),parseFloat(e.maxFontSize)),parseFloat(e.minFontSize)))};c(),a(window).on("resize.fittext orientationchange.fittext",c)})}}(jQuery),Model.prototype=new Observable,Model.prototype.setId=function(a){this.noteboard.sandbox.emit("resource-id",{id:this.data.id,newId:a}),this.data.id=a,this.trigger("resource-id",this.data.id),this.noteboard.sandbox.emit("resource-add-socket",this.data)},Model.prototype.equals=function(a){return this.data.id==a.data.id},Model.prototype.setPosition=function(a,b){this.data.l=a,this.data.t=b,this.data.l<0&&(this.data.l=0),this.data.t<0&&(this.data.t=0),this.data.l+this.data.w>this.noteboard.target.width()&&(this.data.l=this.noteboard.target.width()-this.data.w),this.data.t+this.data.h>this.noteboard.target.height()&&(this.data.t=this.noteboard.target.height()-this.data.h),this.trigger("resource-position",this.data.l,this.data.t)},Model.prototype.setSize=function(a,b){this.data.w=a,this.data.h=b,this.trigger("resource-resize",a,b)},Model.prototype.dragging=function(a,b){var c=this,d=b.position.left-b.originalPosition.left,e=b.position.top-b.originalPosition.top;c.setPosition(b.position.left,b.position.top),this.noteboard.selectedNotes.forEach(function(a){c.equals(a)||(a.originalPosition||(a.originalPosition={top:a.data.t,left:a.data.l}),a.setPosition(a.originalPosition.left+d,a.originalPosition.top+e))})},Model.prototype.dropping=function(){var a=this,b=[];this.noteboard.selectedNotes.forEach(function(c){a.equals(c)||(c.originalPosition=void 0,b.push({id:c.data.id,left:c.data.l,top:c.data.t}))}),b.push({id:a.data.id,left:a.data.l,top:a.data.t});var c={notes:b,noteboardid:this.noteboard.id};this.noteboard.sandbox.emit("resource-move",c)},Model.prototype.draggingResize=function(a,b){var c=this,d=80;b.position.left<d&&(b.position.left=d),b.position.top<d&&(b.position.top=d);var e=b.position.left+10,f=b.position.top+10;("image"==this.data.fs||"circle"==this.data.fs)&&(f=this.data.h/this.data.w*e),this.setSize(e,f),this.noteboard.selectedNotes.forEach(function(a){c.equals(a)||"comment"==a.data.fs||(("image"==a.data.fs||"circle"==a.data.fs)&&(f=a.data.h/a.data.w*e),a.setSize(e,f))})},Model.prototype.droppingResize=function(){var a=this,b=[];this.noteboard.selectedNotes.forEach(function(c){a.equals(c)||b.push({id:c.data.id,width:c.data.w,height:c.data.h})}),b.push({id:a.data.id,width:a.data.w,height:a.data.h});var c={notes:b,noteboardid:this.noteboard.id};this.noteboard.sandbox.emit("resource-resize",c)},Model.prototype.selectingResource=function(a){if(!this.data.locked){var b=this,c=!0;"click"!=a.type||a.shiftKey||this.noteboard.unselectResources(),this.noteboard.selectedNotes.forEach(function(d,e){return b.equals(d)&&a.shiftKey?(b.noteboard.selectedNotes.splice(e,1),void(c=!1)):void 0}),c&&this.noteboard.selectedNotes.push(this),this.trigger("resource-selecting",c)}},Model.prototype.incrementIndex=function(a){this.noteboard.maxIndex++,this.data.index=this.noteboard.maxIndex,this.trigger("resource-index",this.data.index),a.realTime||this.noteboard.sandbox.emit("resource-forward",{id:this.data.id})},Model.prototype.decrementIndex=function(a){this.noteboard.minIndex--,this.data.index=this.noteboard.minIndex,this.trigger("resource-index",this.data.index),a.realTime||this.noteboard.sandbox.emit("resource-back",{id:this.data.id})},Model.prototype.setMsg=function(a){this.data.msg=a.msg,a.realTime?this.trigger("resource-msg",this.data.msg):this.noteboard.sandbox.emit("resource-msg",{id:this.data.id,msg:this.data.msg})},Model.prototype.setBG=function(a){var b=this,c=[];a.realTime||this.noteboard.selectedNotes.forEach(function(d){b.equals(d)||(d.data.bg=a.bg,d.trigger("resource-bg",d.data.bg),c.push({id:d.data.id,bg:d.data.bg}))}),this.data.bg=a.bg,this.trigger("resource-bg",this.data.bg),c.push({id:this.data.id,bg:this.data.bg}),a.realTime||this.noteboard.sandbox.emit("resource-bg",{notes:c,noteboardid:this.noteboard.id})},Model.prototype.setFF=function(a){var b=this,c=[];a.realTime||this.noteboard.selectedNotes.forEach(function(d){b.equals(d)||(d.data.ff=a.ff,d.trigger("resource-ff",d.data.ff),c.push({id:d.data.id,ff:d.data.ff}))}),this.data.ff=a.ff,this.trigger("resource-ff",this.data.ff),c.push({id:this.data.id,ff:this.data.ff}),a.realTime||this.noteboard.sandbox.emit("resource-ff",{notes:c,noteboardid:this.noteboard.id})},Model.prototype.setFS=function(a){var b=this,c=[];a.realTime||this.noteboard.selectedNotes.forEach(function(d){b.equals(d)||(d.data.fs=a.fs,d.trigger("resource-fs",d.data.fs),c.push({id:d.data.id,fs:d.data.fs}))}),this.data.fs=a.fs,this.trigger("resource-fs",this.data.fs),c.push({id:this.data.id,fs:this.data.fs}),a.realTime||this.noteboard.sandbox.emit("resource-fs",{notes:c,noteboardid:this.noteboard.id})},Model.prototype.setC=function(a){var b=this,c=[];a.realTime||this.noteboard.selectedNotes.forEach(function(d){b.equals(d)||(d.data.c=a.c,d.trigger("resource-c",d.data.c),c.push({id:d.data.id,c:d.data.c}))}),this.data.c=a.c,this.trigger("resource-c",this.data.c),c.push({id:this.data.id,c:this.data.c}),a.realTime||this.noteboard.sandbox.emit("resource-c",{notes:c,noteboardid:this.noteboard.id})},Model.prototype.remove=function(a){var b=this,c=[];if(a.realTime||this.noteboard.selectedNotes.forEach(function(a){if(!b.equals(a)){if(a.trigger("resource-remove"),c.push({id:a.data.id}),"frame"==a.data.fs){var d=a.data.msg-1;a.noteboard.areas.splice(d,1);for(var e=d;e<a.noteboard.areas.length;e++){var f=a.noteboard.areas[e];f.model.data.msg=f.model.data.msg-1,f.model.trigger("resource-msg",f.model.data.msg)}}b.noteboard.models.forEach(function(c,d){a==c&&(a.data=void 0,a._events=void 0,b.noteboard.models.splice(d,1))})}}),this.trigger("resource-remove"),c.push({id:this.data.id}),a.realTime||this.noteboard.sandbox.emit("resource-remove",{notes:c,noteboardid:this.noteboard.id}),"frame"==this.data.fs){var d=this.data.msg-1;this.noteboard.areas.splice(d,1);for(var e=d;e<this.noteboard.areas.length;e++){var f=this.noteboard.areas[e];f.model.data.msg=f.model.data.msg-1,f.model.trigger("resource-msg",f.model.data.msg)}}this.noteboard.models.forEach(function(a,c){a==b&&(a.data=void 0,a._events=void 0,b.noteboard.models.splice(c,1))})},Model.prototype.addComment=function(a){this.data.comments++,this.trigger("resource-comment-add",a),a.realTime||this.noteboard.sandbox.emit("resource-comment-add",a)},Model.prototype.attachZone=function(){this.trigger("resource-attach-zone"),this.noteboard.sandbox.emit("resource-attach-zone")},Model.prototype.setLocked=function(a,b){var c=this;this.data.locked=a,this.trigger("resource-locked",a,b),this.noteboard.selectedNotes.forEach(function(b){c.equals(b)||(b.trigger("resource-locked",a),b.data.locked=a)})},Model.prototype.attach=function(){this.noteboard.sandbox.emit("note-attach",{id:this.data.id})},Model.prototype.setIndexTimeline=function(a){var b=Math.min(this.data.msg,a.index),c=Math.max(this.data.msg,a.index),d=this.noteboard.areas[this.data.msg-1],e=[];if(this.data.msg>a.index)for(var f=c-1;f>=b;f--){var g=this.noteboard.areas[f-1];g.model.data.msg=g.model.data.msg+1,g.model.trigger("resource-msg",g.model.data.msg),this.noteboard.areas[f]=g,e.push({id:g.model.data.id,msg:g.model.data.msg})}else for(var f=b+1;c>=f;f++){var g=this.noteboard.areas[f-1];g.model.data.msg=g.model.data.msg-1,g.model.trigger("resource-msg",g.model.data.msg),this.noteboard.areas[f-2]=g,e.push({id:g.model.data.id,msg:g.model.data.msg})}this.noteboard.areas[a.index-1]=d,this.data.msg=a.index,this.trigger("resource-msg",this.data.msg),e.push({id:this.data.id,msg:this.data.msg}),a.realTime||this.noteboard.sandbox.emit("resource-index-timeline",{id:this.data.id,index:a.index,resources:e})},NoteboardResource.prototype.template=function(){return this.view.elems.template},NoteboardResource.prototype.View=function(a){function b(){var b,c,d,e,f,g,h=this;this.noteboard=a.noteboard,this.dragging=!1,this.elems={},this.elems.template=$("<div>",{Class:"untResource"}).attr("id","n-"+a.data.id).attr("data-id",a.data.id).data("model",a),this.elems.header=$("<div>",{Class:"untNoteHeader"}).appendTo(this.elems.template),this.elems.resize=$("<div>",{Class:"untNoteResize"}).appendTo(this.elems.template),this.elems.comment=$("<div>",{Class:"untNoteComment icon-bubbles"}).appendTo(this.elems.header),this.elems.shadow=$("<div>",{Class:"shadow ei-bottom-left-shadow"}).appendTo(this.elems.template),this.elems.template.css({height:a.data.h,left:a.data.l+"px",position:"absolute",top:a.data.t+"px",width:a.data.w,"z-index":a.data.index}).on("click",function(b){return a.data.dragging||h.noteboard.state!=h.noteboard.states.POINTER?a.data.dragging=!1:h.trigger("resource-click",b),!1}).draggable({containment:"parent",start:function(i,j){c=(i.pageY-h.noteboard.target.offset().top)/h.noteboard.scale-parseInt($(i.target).css("top")),b=(i.pageX-h.noteboard.target.offset().left)/h.noteboard.scale-parseInt($(i.target).css("left")),j.originalPosition.top=j.originalPosition.top/h.noteboard.scale,j.originalPosition.left=j.originalPosition.left/h.noteboard.scale,d=h.noteboard.target.offset().top,e=h.noteboard.target.offset().left,f=h.noteboard.target.height(),g=h.noteboard.target.width(),a.data.dragging=!0},drag:function(a,i){i.position.top=Math.round((a.pageY-d)/h.noteboard.scale-c),i.position.left=Math.round((a.pageX-e)/h.noteboard.scale-b),i.position.left<0&&(i.position.left=0),i.position.left+$(this).width()>g&&(i.position.left=g-$(this).width()),i.position.top<0&&(i.position.top=0),i.position.top+$(this).height()>f&&(i.position.top=f-$(this).height()),i.offset.top=Math.round(i.position.top+d),i.offset.left=Math.round(i.position.left+e),h.trigger("resource-drag",a,i)},stop:function(a,b){h.trigger("resource-stop",a,b)}}).on("mouseover",function(){h.elems.comment.css("display","block")}).on("mouseout",function(){var b=h.elems.comment.attr("aria-describedby");"block"==$("#"+b).css("display")||a.data.comments||h.elems.comment.css("display","none")}),this.elems.resize.on("click",function(){return!1}).draggable({start:function(){b=h.elems.template.position().left/h.noteboard.scale+5,c=h.elems.template.position().top/h.noteboard.scale+5,d=h.noteboard.target.offset().top,e=h.noteboard.target.offset().left,f=h.noteboard.target.height(),g=h.noteboard.target.width()},drag:function(a,i){i.position.top=Math.round((a.pageY-d)/h.noteboard.scale-c),i.position.left=Math.round((a.pageX-e)/h.noteboard.scale-b),i.position.left<0&&(i.position.left=0),i.position.left+$(this).width()>g&&(i.position.left=g-$(this).width()),i.position.top<0&&(i.position.top=0),i.position.top+$(this).height()>f&&(i.position.top=f-$(this).height()),i.offset.top=Math.round(i.position.top+d),i.offset.left=Math.round(i.position.left+e),h.trigger("resource-dragResize",a,i)},stop:function(a,b){h.trigger("resource-stopResize",a,b),$(this).css({bottom:"-15px",left:"auto",right:"-15px",top:"auto"})}}).css("position","absolute"),a.data.comments&&a.data.comments>0?this.elems.comment.html("<span>"+a.data.comments+"</span>"):this.elems.comment.hide(),a.data.isNew||this.applyQTip(this.elems.comment,a.data.id)}return b.prototype=new Observable,b.prototype.setId=function(a){this.elems.template.attr("id","n-"+a).attr("data-id",a),this.applyQTip(this.elems.comment,a)},b.prototype.selectingResource=function(a){a?this.elems.template.addClass("selected"):this.elems.template.removeClass("selected")},b.prototype.changeIndex=function(a){this.elems.template.css("z-index",a)},b.prototype.setPosition=function(a,b){this.elems.template.css({left:a,top:b})},b.prototype.setSize=function(a,b){this.elems.template.css({width:a,height:b})},b.prototype.remove=function(){this.elems.template.remove()},b.prototype.locked=function(a){a?(this.elems.template.draggable("disable"),this.elems.template.css("cursor","inherit")):(this.elems.template.draggable("enable"),this.elems.template.css("cursor","move"))},b.prototype.addComment=function(b){var c=this.elems.comment.attr("aria-describedby");void 0!=c&&$("#"+c).find(".untCommentBlocks").data("jsp").getContentPane().append(views.commentBlock(b)),this.elems.comment.html("<span>"+a.data.comments+"</span>"),this.elems.comment.show()},b.prototype.applyQTip=function(b,c){var d=this,e=!0;b.qtip({content:{ajax:{url:API+"Comment/AllComments/"+c,type:"GET",success:function(a){e&&(e=!1,a=d.createQTip(a,c),this.set("content.text",a),a.find(".untCommentBlocks").jScrollPane({showArrows:!1,maintainPosition:!0,stickToBottom:!0,autoReinitialise:!0}),a.find(".untCommentBlocks").data("jsp").scrollToY(1e4))}}},show:"click",hide:"click",events:{hidden:function(){b.css("display","none")}},style:{width:300,classes:"ui-tooltip-shadow ui-tooltip-white "+a.data.fs}})},b.prototype.createQTip=function(b,c){var d=this,e=$("<div>",{Class:"untCommentWrapper"}),f=$("<div>",{Class:"untCommentBlocks"}).appendTo(e),g=$(views.commentTA(d.noteboard.user.profileImage)).appendTo(e);return b.forEach(function(a){f.append(views.commentBlock(a))}),g.find('textarea[name="commentTA"]').placeholder({text:i18n.writeComment,autoResize:!0,maxHeight:"70"}).keypress(function(b){var e=b.keyCode||b.which;if(13==e){if(b.shiftKey)return;b.preventDefault();var f=$(this);if(""==f.val()||f.val()==i18n.writeComment)return;var g={noteId:c,fullname:d.noteboard.user.fullname,profileImage:d.noteboard.user.profileImage,message:f.val()};a.addComment(g),f.val("").placeholder({text:i18n.writeComment})}}),e},b},NoteResource.prototype=Object.create(NoteboardResource.prototype),NoteResource.prototype.View=function(){var a=this,b=this.model,c=NoteboardResource.prototype.View.call(this,b),d=new c;d.elems.template.addClass("untNote untMenu "+b.data.bg).data("attach",b.data.attach).data("bg",b.data.bg),d.elems.attach=$("<div>",{Class:"icon-attachment"}).appendTo(d.elems.header),d.elems.userLock=$("<img>",{Class:"user-lock"}).appendTo(d.elems.header),d.elems.msg=$("<div>",{Class:"untNoteContent",Name:"message",Spellcheck:"false",contenteditable:"true",maxLength:"500"}).appendTo(d.elems.template),b.data.attach&&b.data.attach.length>0&&d.elems.attach.show();var e=null,f=!1,g=!1,h=function(a){var b=a.childNodes.length-1;return 0>b?a:h(a.childNodes[b])};return d.elems.msg.html(b.data.msg).css({color:b.data.c,"font-family":b.data.ff,"font-size":b.data.fs,height:d.elems.template.height()-50}).on("dblclick",function(a){return a.preventDefault(),!1}).on("click",function(a){if(0!=b.noteboard.selectedNotes.length){var c=!1;if(b.noteboard.selectedNotes.forEach(function(a){return a.data.id==b.data.id?void(c=!0):void 0}),c)return}if(!g&&!b.data.locked&&!a.shiftKey){g=!0,this.focus(),d.elems.template.draggable("disable"),b.noteboard.unselectResources();var e=h(this);if(e.length){var f=document.createRange(),i=window.getSelection();f.setStart(e,e.length),f.collapse(!0),i.removeAllRanges(),i.addRange(f)}}return!1}).on("focus",function(){d.elems.template.addClass("focus"),b.noteboard.noteLock(a)}).on("blur",function(){b.data.locked||d.elems.template.draggable("enable");var c=$(this).html();b.data.msg==c||f||(b.setMsg({msg:c}),clearTimeout(e)),g=!1,document.activeElement!=this&&$("#search").focus().blur(),d.elems.template.removeClass("focus"),b.noteboard.noteUnlock(a)}).on("keydown",function(a,b){{var c=$(this).text();500-c.length}return(9==b||18==b)&&a.preventDefault(),13==b?(document.execCommand("insertHTML",!1,"<br><br>"),!1):void 0}).on("keyup",function(){var a=$(this).html();text=$(this).text(),b.data.msg!=a&&(clearTimeout(e),f=!1,e=setTimeout(function(){b.setMsg({msg:a}),clearTimeout(e),f=!0},1e3))}),d.elems.attach.on("click",function(){b.attachZone()}),b.noteboard.target.on("click",function(){d.elems.msg.blur()}),c.prototype.setSize=function(a,b){this.elems.template.css({width:a,height:b}),this.elems.msg.css("height",this.elems.template.height()-50)},c.prototype.setMsg=function(a){this.elems.msg.html(a)},c.prototype.setBG=function(a){this.elems.template.removeClass(this.elems.template.data("bg")).addClass(a).data("bg",a)},c.prototype.setFF=function(a){this.elems.msg.css("font-family",a)},c.prototype.setFS=function(a){this.elems.msg.css("font-size",a)},c.prototype.setC=function(a){this.elems.msg.css("color",a)},c.prototype.locked=function(a,b){a?(this.elems.template.draggable("disable"),this.elems.msg.removeAttr("contenteditable"),b&&this.elems.userLock.attr("src",b.profileImage).attr("title",b.fullname+i18n.userEditing).show()):(this.elems.template.draggable("enable"),this.elems.msg.attr("contenteditable","true"),this.elems.userLock.hide())},c.prototype.attachZone=function(){var a=this;$.untInputWin({content:views.formAttachFile(b.data.id,b.noteboard.id),classes:"dropzone",width:"100%"});var c=new Dropzone("#uploadDropzone",{previewTemplate:views.attachFileBlock(),maxFilesize:b.noteboard.user.maxFileSize,maxFiles:b.noteboard.user.maxFiles,success:function(b,c){return c.size=Math.round(c.size/1e4)/100,c.src=$(b.previewElement).find("[data-dz-thumbnail]").attr("src"),a.noteboard.sandbox.emit("note-attach-add",c),b.previewElement.setAttribute("data-attach",c.name),b.previewElement.classList.add("dz-success")},error:function(a,b){var c=$(a.previewElement);return c.find(".dz-download").remove(),c.find(".dz-remove").remove(),c.find(".dz-delete").css("display","block"),c.find(".dz-error-message").html(b),a.previewElement.classList.add("dz-error")}}),d=this.elems.template.data("attach"),e=d.length;if(void 0!=d){for(var f=e-1;f>=0;f--)$("#uploadDropzone").append(views.attachFileBlock(d[f]));c.options.maxFiles=c.options.maxFiles-e}untInputWinCenter()},d},CircleResource.prototype=Object.create(NoteboardResource.prototype),CircleResource.prototype.View=function(){var a=this.model,b=NoteboardResource.prototype.View.call(this,a),c=new b;return c.elems.template.addClass("untCircle untMenuCircle "+a.data.bg),c.elems.header.remove(),c.elems.shadow.remove(),c},ImageResource.prototype=Object.create(NoteboardResource.prototype),ImageResource.prototype.View=function(){var a=this.model,b=NoteboardResource.prototype.View.call(this,a),c=new b;return c.elems.template.addClass("untImage untMenuImage").css("background-image","url("+CDN_IMAGES+a.data.msg+")").data("imageName",a.data.msg).on("click",function(b){b.ctrlKey&&$.untInputWin('<img class="untWinImage" src="'+CDN_IMAGES+a.data.msg+'">')}),c.elems.shadow.remove(),c},VideoResource.prototype=Object.create(NoteboardResource.prototype),VideoResource.prototype.View=function(){var a=this.model,b=NoteboardResource.prototype.View.call(this,a),c=new b;return c.elems.template.addClass("untVideo untMenuVideo").append('<iframe src="'+a.data.msg+'" width="95%" height="85%" allowfullscreen></iframe>'),c},FrameResource.prototype=Object.create(NoteboardResource.prototype),FrameResource.prototype.View=function(){var a=this.model,b=NoteboardResource.prototype.View.call(this,a),c=new b;return c.elems.template.addClass("untFrame untMenuFrame "+a.data.bg),c.elems.cell=$("<div>",{Class:"untFrameCell"}).appendTo(c.elems.template),c.elems.number=$("<div>",{Class:"untFrameNumber"}).appendTo(c.elems.cell).html(a.data.msg),c.elems.header.remove(),c.elems.shadow.remove(),b.prototype.remove=function(){this.elems.template.remove(),this.elems.preview.remove()},b.prototype.addTimelinePreview=function(){this.elems.preview=$("<li>",{Class:"untFrame"}).data("model",a).attr("index",a.data.msg),this.elems.previewCell=$("<div>",{Class:"untFrameCell"}).appendTo(this.elems.preview),this.elems.previewNumber=$("<div>",{Class:"untFrameNumber"}).html(a.data.msg).appendTo(this.elems.previewCell),this.elems.preview.on("click",function(){a.noteboard.showArea(a)
});var b=$("#timelinePanel");b.data("jsp")&&(b.find("ul").append(this.elems.preview),b.data("jsp").reinitialise())},b.prototype.setMsg=function(a){this.elems.number.html(a),this.elems.previewNumber.html(a),this.elems.preview.insertAfter($("#timelinePanel ul li:eq("+(a-1)+")"))},c},CommentResource.prototype=Object.create(NoteboardResource.prototype),CommentResource.prototype.View=function(){var a=this.model,b=NoteboardResource.prototype.View.call(this,a),c=new b;return c.elems.template.addClass("untComment untMenuComment "+a.data.bg).data("bg",a.data.bg),c.elems.pin=$("<div>",{Class:"untCommentPin"}).prependTo(c.elems.template),c.elems.shadow.remove(),c.elems.resize.remove(),b.prototype.setSize=function(){return!1},b.prototype.zoomResize=function(){var b=1/a.noteboard.scale;c.elems.template.css({"-webkit-transform":"scale("+b+")","-moz-transform":"scale("+b+")",transform:"scale("+b+")"})},c},NoteboardModel.prototype=new Observable,NoteboardModel.prototype.setName=function(a){this.data.name=a,this.trigger("noteboard-name",a)},NoteboardModel.prototype.setDescription=function(a){this.data.description=a,this.trigger("noteboard-description",a)},NoteboardModel.prototype.setVisibility=function(a){this.data.visibility=a,this.trigger("noteboard-visibility",a)},NoteboardModel.prototype.setParentId=function(a){this.data.changeParent=this.data.parentId!=a,this.data.parentId=a,this.trigger("noteboard-parentId",a)},NoteboardModel.prototype.setCategoryId=function(a){this.data.categoryId=a},NoteboardBase.prototype.Share=function(){var self=this;$.untInputWin({title:eval("i18n.share"+this.model.data.ctype),content:ROOT_URL+"Noteboard/ShareManager/"+this.model.data.id,clickAccept:function(){var a=$("#frmNoteboardShare").serialize();return""==$.trim(a)?($("#frmNoteboardShare .untPlgMsg").untInputMsg({content:i18n.errSelectCollaborator,type:"Err"}).show(),!1):($(".btnWinAccept").attr("disabled","true").removeClass("yellow"),$.post(ROOT_URL+"Noteboard/Share/"+self.model.data.id,$("#frmNoteboardShare").serialize(),function(){untInputWinRemove()}),!1)},onLoadContent:function(){$("#frmNoteboardShare").on("submit",function(){return!1}),$(".untWin .btnWinAccept").html(i18n.sendInvitation),$(".untWin .btnWinCancel").html(i18n.closeWindow),$("#contact").on("keypress",function(){$(".untPlgMsg").html("")}).autocomplete({source:function(a,b){$.getJSON(API+"User/Search/?term="+a.term+"&noteboardId="+self.model.data.id,function(a){b(a)})},select:function(a,b){{var c=$("<div>",{Class:"untShareUser"}).appendTo($("#collaborators")),d=($("<div>",{Class:"untInline"}).append('<img src="'+b.item.label.profileImage+'" width="35px">').appendTo(c),$("<div>",{Class:"profile untInline"}).appendTo(c));$("<div>",{Class:"name"}).html(b.item.label.fullname).appendTo(d),$("<div>",{Class:"email"}).html(b.item.label.email).appendTo(d),$("<div>",{Class:"delete icon-cancel-circle"}).prependTo(c).on("click",function(){c.remove()}),$("<input>",{type:"hidden",name:"collaborators[]",value:b.item.value}).appendTo(c)}return $(this).val("").focus(),!1},minLength:3}).data("ui-autocomplete")._renderItem=function(a,b){var c=!1;if($("#collaborators").find("[value]").each(function(){this.value==b.value&&(c=!0)}),c)return $("").data("ui-autocomplete-item",b);{var d=$("<a>",{Class:"untShareUser"}),e=($("<div>",{Class:"untInline"}).append('<img src="'+b.label.profileImage+'" width="35px">').appendTo(d),$("<div>",{Class:"profile untInline"}).appendTo(d));$("<div>",{Class:"name"}).html(b.label.fullname).appendTo(e),$("<div>",{Class:"email"}).html(b.label.email).appendTo(e)}return $("<li>").data("ui-autocomplete-item",b).append(d).appendTo(a)},$("#collaboratorsContainer .delete").on("click",function(){var a=$(this);$.untInputWin({title:i18n.deleteCollaborator,content:i18n.deleteCollaboratorMsg,btnCancel:!0,width:"300",clickAccept:function(){$.ajax({url:API+"Noteboard/Unshare/"+a.data("id"),data:{userId:a.data("userid")},type:"POST",dataType:"json",success:function(){a.parent().remove()}})}})}),$("#collaboratorsContainer .permissions").on("click",function(){var a=$(this),b=a.data("userid"),c={noteboardId:a.attr("data-id"),canEdit:a.attr("data-canedit"),canComment:a.attr("data-cancomment"),canDelete:a.attr("data-candelete"),canUploadFiles:a.attr("data-canuploadfiles"),canDeleteAttach:a.attr("data-candeleteattach"),canInvite:a.attr("data-caninvite")};$.untInputWin({title:i18n.userPermissions,content:views.permissionsForm(c),clickAccept:function(){return $.ajax({url:ROOT_URL+"User/Permissions/"+b,data:$("#permissionsForm").serialize(),type:"POST",dataType:"json",success:function(b){a.attr("data-canedit",b.canEdit),a.attr("data-cancomment",b.canComment),a.attr("data-candelete",b.canDelete),a.attr("data-canuploadfiles",b.canUploadFiles),a.attr("data-candeleteattach",b.canDeleteAttach),a.attr("data-caninvite",b.canInvite),untInputWinRemove()}}),!1}})})}})},NoteboardBase.prototype.Delete=function(){var self=this,content=eval("i18n.delete"+this.model.data.ctype+"Msg");this.model.data.user.owner||(content=eval("i18n.unshare"+this.model.data.ctype+"Msg")),$.untInputWin({title:eval("i18n.delete"+this.model.data.ctype),content:content,maxWidth:"300px",clickAccept:function(){$.ajax({url:API+"Noteboard/"+self.model.data.id,type:"DELETE",dataType:"json",success:function(){"noteboard"==self.model.data.type?self.template().remove():(location.hash="",_getFolderScheme())}}),untInputWinRemove()}})},NoteboardBase.prototype.Edit=function(){var self=this;$.untInputWin({title:eval("i18n.edit"+this.model.data.ctype),content:ROOT_URL+"Noteboard/Manager/"+this.model.data.id+"?type="+this.model.data.type,width:"400",clickAccept:function(){return $("#noteboardForm").valid()?($.ajax({url:API+"Noteboard/"+self.model.data.id,type:"PUT",dataType:"json",data:$("#noteboardForm").serialize(),success:function(a){self.model.setName(a.name),self.model.setDescription(a.description),self.model.setVisibility(a.visibility),self.model.setParentId(a.parentId),self.model.setCategoryId(a.categoryId),untInputWinRemove()}}),!1):!1},onLoadContent:function(){var select=$("#slcParent");select.append(options.html()),select.find("option[value="+self.model.data.parentId+"]").attr("selected","selected"),select.find("option[value="+self.model.data.id+"]").remove(),self.RemoveChildrenOption&&self.RemoveChildrenOption(self.model.data.children,select),$(".untWin .untHelper").qtip({style:{classes:"qtip-untHelper"}}),$("#noteboardForm").validate({success:"valid",rules:{name:{required:!0}},messages:{name:{required:eval("i18n.errName"+self.model.data.ctype)}}}),"noteboard"==self.model.data.type&&$(".untCategoryItems").jScrollPane().data("jsp").scrollToX(80*(self.model.data.categoryId-1))}})},NoteboardBase.prototype.template=function(){return this.view.elems.template},Noteboard.prototype=Object.create(NoteboardBase.prototype),Noteboard.prototype.View=function(a){function b(){var b=this;this.elems={},this.elems.template=$("<div>",{Class:"untNoteboard"}).draggable({revert:!0,opacity:.5,helper:"clone"}).data("model",c.model),this.elems.options=$("<div>",{Class:"options untInline"}).appendTo(this.elems.template),this.elems.edit=$("<div>",{Class:"edit icon-pencil",title:i18n.edit}).appendTo(this.elems.options).qtip(),this.elems.share=$("<div>",{Class:"share icon-users",title:i18n.share}).appendTo(this.elems.options).qtip(),this.elems.delete=$("<div>",{Class:"delete icon-remove",title:i18n.delete}).appendTo(this.elems.options).qtip(),this.elems.leftContent=$("<div>",{Class:"leftContent"}).appendTo(this.elems.template),this.elems.preview=$("<a>",{Class:"preview untInline",href:ROOT_URL+"Noteboard/App/"+a.url}).appendTo(this.elems.leftContent),this.elems.previewImage=$("<img>",{Class:"previewImage",width:"158px",height:"115px",src:BLOB_IMAGES+"preview_"+a.url+".jpg?cache="+a.cache}).appendTo(this.elems.preview),this.elems.profileImage=$("<img>",{Class:"profileImage",width:"30px",height:"30px",src:a.user.profileImage,title:i18n.createBy+a.user.fullname}).appendTo(this.elems.preview).qtip(),this.elems.name=$("<div>",{Class:"name"}).html(a.name).appendTo(this.elems.leftContent),this.elems.description=$("<div>",{Class:"description"}).html(a.description).appendTo(this.elems.leftContent),this.elems.private=$("<div>",{Class:"private icon-lock",title:i18n.private}).appendTo(this.elems.template).qtip(),this.elems.public=$("<div>",{Class:"public icon-unlocked",title:i18n.public}).appendTo(this.elems.template).qtip(),this.elems.share.on("click",function(){return b.trigger("noteboard-share"),!1}),this.elems.delete.on("click",function(){return b.trigger("noteboard-delete"),!1}),this.elems.edit.on("click",function(){return b.trigger("noteboard-edit"),!1}),this.setVisibility(a.visibility)}var c=this;return b.prototype=new Observable,b.prototype.setName=function(a){this.elems.name.html(a)},b.prototype.setDescription=function(a){this.elems.description.html(a)},b.prototype.setVisibility=function(a){switch(a){case"private":this.elems.private.show(),this.elems.public.hide();break;case"public":this.elems.public.show(),this.elems.private.hide()}},b.prototype.setParentId=function(){c.model.data.changeParent&&this.elems.template.remove()},b.prototype.ChangingThumbails=function(){this.elems.previewImage.css("opacity","0.3"),this.elems.preview.prepend('<img src="'+WEBROOT_URL+'img/default/loader.gif" alt="Loader" class="untLoader" width="30px" height="30px">')},b.prototype.setThumbails=function(b){this.elems.previewImage.attr("src",BLOB_IMAGES+"preview_"+a.url+".jpg?cache="+b.cache),this.elems.preview.find(".untLoader").remove(),this.elems.previewImage.css("opacity","1")},new b},Noteboard.prototype.UpdateThumbails=function(){var a=this;this.model.data.modified&&(this.view.ChangingThumbails(),$.getJSON("Noteboard/PreviewRefresh/"+this.model.data.url,function(b){setTimeout(function(){a.view.setThumbails(b)},2e3)}))},Noteboard.prototype.LoadNoteboards=function(a){$(".untNoteboard").remove(),$(".untMainContent").find(".untLoader").show(),$(".untMainContent").find(".untEmpty").hide(),$.getJSON(API+"Noteboard/Children/"+a,function(a){$("#btnAddNoteboard").show(),a.length?a.forEach(function(a){var b=new Noteboard(a);$(".untMainContent").append(b.template())}):$(".untMainContent").find(".untEmpty").show(),$(".untMainContent").find(".untLoader").hide()})},Folder.prototype=Object.create(NoteboardBase.prototype),Folder.prototype.View=function(a){function b(){var b=this;this.elems={},this.elems.template=$("<li>",{id:"subtree-"+a.id}).draggable({revert:!0,opacity:.5,helper:"clone"}).data("model",c.model),this.elems.link=$("<a>",{href:"#!/folder/"+a.id,Class:"unt"+a.ctype+" "+a.type}).data("folder",a.id).appendTo(this.elems.template).attr("data-a","a").droppable({hoverClass:"ui-state-hover",tolerance:"pointer",drop:this.changeParent}),this.elems.icon=$("<span>",{Class:"icon- "+a.type}).appendTo(this.elems.link),this.elems.name=$("<span>",{Class:"name"}).html(a.name).appendTo(this.elems.link),this.elems.edit=$("<span>",{Class:"edit icon-cog"}).appendTo(this.elems.link),this.elems.share=$("<span>",{Class:"share icon-users"}).appendTo(this.elems.link),this.elems.delete=$("<span>",{Class:"delete icon-remove"}).appendTo(this.elems.link),this.elems.ul=$("<ul>").appendTo(this.elems.template),this.elems.share.on("click",function(){return b.trigger("noteboard-share"),!1}),this.elems.delete.on("click",function(){return b.trigger("noteboard-delete"),!1}),this.elems.edit.on("click",function(){return b.trigger("noteboard-edit"),!1}),this.elems.link.on("click",function(){b.trigger("branch-clicked")})}var c=this;return b.prototype=new Observable,b.prototype.setName=function(a){this.elems.name.html(a),options.find("option[value="+c.model.data.id+"]").html(a)},b.prototype.setDescription=function(){},b.prototype.setVisibility=function(){},b.prototype.setParentId=function(){c.model.data.changeParent&&_getFolderScheme()},b.prototype.changeParent=function(a,b){var d=b.draggable.data("model");if(c.model.data.id!=d.data.parentId){if("group"==d.data.type)return void $.untInputWin({title:i18n.invalidMovement,content:i18n.invalidMovementMsg});d.data.parentId=c.model.data.id,$.ajax({url:API+"Noteboard/"+d.data.id,data:d.data,type:"PUT",dataType:"json",success:function(){"folder"==d.data.type?_getFolderScheme():b.draggable.remove()}})}},new b},Folder.prototype.BranchClicked=function(){$(".selected").removeClass("selected"),this.view.elems.link.addClass("selected"),this.template().hasClass("expandable")&&this.template().find("> .hitarea").click(),$("#noteboardsDesigned").hide(),Noteboard.prototype.LoadNoteboards.call(this,this.model.data.id)},Folder.prototype.RemoveChildrenOption=function(a,b){var c=this;if(a)for(var d=a.length-1;d>=0;d--)c.RemoveChildrenOption(a[d].children,b),b.find("option[value="+a[d].id+"]").remove()},Folder.prototype.getSubTree=function(){return this.view.elems.ul};var requirejs,require,define;!function(Z){function H(a){return"[object Function]"===L.call(a)}function I(a){return"[object Array]"===L.call(a)}function y(a,b){if(a){var c;for(c=0;c<a.length&&(!a[c]||!b(a[c],c,a));c+=1);}}function M(a,b){if(a){var c;for(c=a.length-1;c>-1&&(!a[c]||!b(a[c],c,a));c-=1);}}function s(a,b){return ga.call(a,b)}function l(a,b){return s(a,b)&&a[b]}function F(a,b){for(var c in a)if(s(a,c)&&b(a[c],c))break}function Q(a,b,c,d){return b&&F(b,function(b,e){(c||!s(a,e))&&(d&&"string"!=typeof b?(a[e]||(a[e]={}),Q(a[e],b,c,d)):a[e]=b)}),a}function u(a,b){return function(){return b.apply(a,arguments)}}function aa(a){throw a}function ba(a){if(!a)return a;var b=Z;return y(a.split("."),function(a){b=b[a]}),b}function A(a,b,c,d){return b=Error(b+"\nhttp://requirejs.org/docs/errors.html#"+a),b.requireType=a,b.requireModules=d,c&&(b.originalError=c),b}function ha(a){function b(a,b,c){var d,e,f,g,h,i,j,k=b&&b.split("/");d=k;var m=C.map,n=m&&m["*"];if(a&&"."===a.charAt(0))if(b){for(d=l(C.pkgs,b)?k=[b]:k.slice(0,k.length-1),b=a=d.concat(a.split("/")),d=0;b[d];d+=1)if(e=b[d],"."===e)b.splice(d,1),d-=1;else if(".."===e){if(1===d&&(".."===b[2]||".."===b[0]))break;d>0&&(b.splice(d-1,2),d-=2)}d=l(C.pkgs,b=a[0]),a=a.join("/"),d&&a===b+"/"+d.main&&(a=b)}else 0===a.indexOf("./")&&(a=a.substring(2));if(c&&m&&(k||n)){for(b=a.split("/"),d=b.length;d>0;d-=1){if(f=b.slice(0,d).join("/"),k)for(e=k.length;e>0;e-=1)if((c=l(m,k.slice(0,e).join("/")))&&(c=l(c,f))){g=c,h=d;break}if(g)break;!i&&n&&l(n,f)&&(i=l(n,f),j=d)}!g&&i&&(g=i,h=j),g&&(b.splice(0,h,g),a=b.join("/"))}return a}function c(a){z&&y(document.getElementsByTagName("script"),function(b){return b.getAttribute("data-requiremodule")===a&&b.getAttribute("data-requirecontext")===w.contextName?(b.parentNode.removeChild(b),!0):void 0})}function d(a){var b=l(C.paths,a);return b&&I(b)&&1<b.length?(c(a),b.shift(),w.require.undef(a),w.require([a]),!0):void 0}function e(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function f(a,c,d,f){var g,h,i=null,j=c?c.name:null,k=a,m=!0,n="";return a||(m=!1,a="_@r"+(M+=1)),a=e(a),i=a[0],a=a[1],i&&(i=b(i,j,f),h=l(K,i)),a&&(i?n=h&&h.normalize?h.normalize(a,function(a){return b(a,j,f)}):b(a,j,f):(n=b(a,j,f),a=e(n),i=a[0],n=a[1],d=!0,g=w.nameToUrl(n))),d=!i||h||d?"":"_unnormalized"+(N+=1),{prefix:i,name:n,parentMap:c,unnormalized:!!d,url:g,originalName:k,isDefine:m,id:(i?i+"!"+n:n)+d}}function g(a){var b=a.id,c=l(D,b);return c||(c=D[b]=new w.Module(a)),c}function h(a,b,c){var d=a.id,e=l(D,d);!s(K,d)||e&&!e.defineEmitComplete?(e=g(a),e.error&&"error"===b?c(e.error):e.on(b,c)):"defined"===b&&c(K[d])}function i(a,b){var c=a.requireModules,d=!1;b?b(a):(y(c,function(b){(b=l(D,b))&&(b.error=a,b.events.error&&(d=!0,b.emit("error",a)))}),d||j.onError(a))}function k(){R.length&&(ia.apply(J,[J.length-1,0].concat(R)),R=[])}function m(a){delete D[a],delete E[a]}function n(a,b,c){var d=a.map.id;a.error?a.emit("error",a.error):(b[d]=!0,y(a.depMaps,function(d,e){var f=d.id,g=l(D,f);g&&!a.depMatched[e]&&!c[f]&&(l(b,f)?(a.defineDep(e,K[f]),a.check()):n(g,b,c))}),c[d]=!0)}function o(){var a,b,e,f,g=(e=1e3*C.waitSeconds)&&w.startTime+e<(new Date).getTime(),h=[],j=[],k=!1,l=!0;if(!t){if(t=!0,F(E,function(e){if(a=e.map,b=a.id,e.enabled&&(a.isDefine||j.push(e),!e.error))if(!e.inited&&g)d(b)?k=f=!0:(h.push(b),c(b));else if(!e.inited&&e.fetched&&a.isDefine&&(k=!0,!a.prefix))return l=!1}),g&&h.length)return e=A("timeout","Load timeout for modules: "+h,null,h),e.contextName=w.contextName,i(e);l&&y(j,function(a){n(a,{},{})}),g&&!f||!k||!z&&!da||B||(B=setTimeout(function(){B=0,o()},50)),t=!1}}function p(a){s(K,a[0])||g(f(a[0],null,!0)).init(a[1],a[2])}function q(a){var a=a.currentTarget||a.srcElement,b=w.onScriptLoad;return a.detachEvent&&!W?a.detachEvent("onreadystatechange",b):a.removeEventListener("load",b,!1),b=w.onScriptError,(!a.detachEvent||W)&&a.removeEventListener("error",b,!1),{node:a,id:a&&a.getAttribute("data-requiremodule")}}function r(){var a;for(k();J.length;){if(a=J.shift(),null===a[0])return i(A("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));p(a)}}var t,v,w,x,B,C={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},D={},E={},G={},J=[],K={},L={},M=1,N=1;return x={require:function(a){return a.require?a.require:a.require=w.makeRequire(a.map)},exports:function(a){return a.usingExports=!0,a.map.isDefine?a.exports?a.exports:a.exports=K[a.map.id]={}:void 0},module:function(a){return a.module?a.module:a.module={id:a.map.id,uri:a.map.url,config:function(){var b=l(C.pkgs,a.map.id);return(b?l(C.config,a.map.id+"/"+b.main):l(C.config,a.map.id))||{}},exports:K[a.map.id]}}},v=function(a){this.events=l(G,a.id)||{},this.map=a,this.shim=l(C.shim,a.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},v.prototype={init:function(a,b,c,d){d=d||{},this.inited||(this.factory=b,c?this.on("error",c):this.events.error&&(c=u(this,function(a){this.emit("error",a)})),this.depMaps=a&&a.slice(0),this.errback=c,this.inited=!0,this.ignore=d.ignore,d.enabled||this.enabled?this.enable():this.check())},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(!this.fetched){this.fetched=!0,w.startTime=(new Date).getTime();var a=this.map;if(!this.shim)return a.prefix?this.callPlugin():this.load();w.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],u(this,function(){return a.prefix?this.callPlugin():this.load()}))}},load:function(){var a=this.map.url;L[a]||(L[a]=!0,w.load(this.map.id,a))},check:function(){if(this.enabled&&!this.enabling){var a,b,c=this.map.id;b=this.depExports;var d=this.exports,e=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,1>this.depCount&&!this.defined){if(H(e)){if(this.events.error&&this.map.isDefine||j.onError!==aa)try{d=w.execCb(c,e,b,d)}catch(f){a=f}else d=w.execCb(c,e,b,d);if(this.map.isDefine&&((b=this.module)&&void 0!==b.exports&&b.exports!==this.exports?d=b.exports:void 0===d&&this.usingExports&&(d=this.exports)),a)return a.requireMap=this.map,a.requireModules=this.map.isDefine?[this.map.id]:null,a.requireType=this.map.isDefine?"define":"require",i(this.error=a)}else d=e;this.exports=d,this.map.isDefine&&!this.ignore&&(K[c]=d,j.onResourceLoad)&&j.onResourceLoad(w,this.map,this.depMaps),m(c),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var a=this.map,c=a.id,d=f(a.prefix);this.depMaps.push(d),h(d,"defined",u(this,function(d){var e,k;k=this.map.name;var n=this.map.parentMap?this.map.parentMap.name:null,o=w.makeRequire(a.parentMap,{enableBuildCallback:!0});this.map.unnormalized?(d.normalize&&(k=d.normalize(k,function(a){return b(a,n,!0)})||""),d=f(a.prefix+"!"+k,this.map.parentMap),h(d,"defined",u(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),(k=l(D,d.id))&&(this.depMaps.push(d),this.events.error&&k.on("error",u(this,function(a){this.emit("error",a)})),k.enable())):(e=u(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),e.error=u(this,function(a){this.inited=!0,this.error=a,a.requireModules=[c],F(D,function(a){0===a.map.id.indexOf(c+"_unnormalized")&&m(a.map.id)}),i(a)}),e.fromText=u(this,function(b,d){var h=a.name,k=f(h),l=O;d&&(b=d),l&&(O=!1),g(k),s(C.config,c)&&(C.config[h]=C.config[c]);try{j.exec(b)}catch(m){return i(A("fromtexteval","fromText eval for "+c+" failed: "+m,m,[c]))}l&&(O=!0),this.depMaps.push(k),w.completeLoad(h),o([h],e)}),d.load(a.name,o,e,C))})),w.enable(d,this),this.pluginMaps[d.id]=d},enable:function(){E[this.map.id]=this,this.enabling=this.enabled=!0,y(this.depMaps,u(this,function(a,b){var c,d;if("string"==typeof a){if(a=f(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[b]=a,c=l(x,a.id))return void(this.depExports[b]=c(this));this.depCount+=1,h(a,"defined",u(this,function(a){this.defineDep(b,a),this.check()})),this.errback&&h(a,"error",u(this,this.errback))}c=a.id,d=D[c],!s(x,c)&&d&&!d.enabled&&w.enable(a,this)})),F(this.pluginMaps,u(this,function(a){var b=l(D,a.id);b&&!b.enabled&&w.enable(a,this)})),this.enabling=!1,this.check()},on:function(a,b){var c=this.events[a];c||(c=this.events[a]=[]),c.push(b)},emit:function(a,b){y(this.events[a],function(a){a(b)}),"error"===a&&delete this.events[a]}},w={config:C,contextName:a,registry:D,defined:K,urlFetched:L,defQueue:J,Module:v,makeModuleMap:f,nextTick:j.nextTick,onError:i,configure:function(a){a.baseUrl&&"/"!==a.baseUrl.charAt(a.baseUrl.length-1)&&(a.baseUrl+="/");var b=C.pkgs,c=C.shim,d={paths:!0,config:!0,map:!0};F(a,function(a,b){d[b]?"map"===b?(C.map||(C.map={}),Q(C[b],a,!0,!0)):Q(C[b],a,!0):C[b]=a}),a.shim&&(F(a.shim,function(a,b){I(a)&&(a={deps:a}),!a.exports&&!a.init||a.exportsFn||(a.exportsFn=w.makeShimExports(a)),c[b]=a}),C.shim=c),a.packages&&(y(a.packages,function(a){a="string"==typeof a?{name:a}:a,b[a.name]={name:a.name,location:a.location||a.name,main:(a.main||"main").replace(ja,"").replace(ea,"")}}),C.pkgs=b),F(D,function(a,b){!a.inited&&!a.map.unnormalized&&(a.map=f(b))}),(a.deps||a.callback)&&w.require(a.deps||[],a.callback)},makeShimExports:function(a){return function(){var b;return a.init&&(b=a.init.apply(Z,arguments)),b||a.exports&&ba(a.exports)}},makeRequire:function(c,d){function e(b,h,k){var l,m;return d.enableBuildCallback&&h&&H(h)&&(h.__requireJsBuild=!0),"string"==typeof b?H(h)?i(A("requireargs","Invalid require call"),k):c&&s(x,b)?x[b](D[c.id]):j.get?j.get(w,b,c,e):(l=f(b,c,!1,!0),l=l.id,s(K,l)?K[l]:i(A("notloaded",'Module name "'+l+'" has not been loaded yet for context: '+a+(c?"":". Use require([])")))):(r(),w.nextTick(function(){r(),m=g(f(null,c)),m.skipMap=d.skipMap,m.init(b,h,k,{enabled:!0}),o()}),e)}return d=d||{},Q(e,{isBrowser:z,toUrl:function(a){var d,e=a.lastIndexOf("."),f=a.split("/")[0];return-1!==e&&("."!==f&&".."!==f||e>1)&&(d=a.substring(e,a.length),a=a.substring(0,e)),w.nameToUrl(b(a,c&&c.id,!0),d,!0)},defined:function(a){return s(K,f(a,c,!1,!0).id)},specified:function(a){return a=f(a,c,!1,!0).id,s(K,a)||s(D,a)}}),c||(e.undef=function(a){k();var b=f(a,c,!0),d=l(D,a);delete K[a],delete L[b.url],delete G[a],d&&(d.events.defined&&(G[a]=d.events),m(a))}),e},enable:function(a){l(D,a.id)&&g(a).enable()},completeLoad:function(a){var b,c,e=l(C.shim,a)||{},f=e.exports;for(k();J.length;){if(c=J.shift(),null===c[0]){if(c[0]=a,b)break;b=!0}else c[0]===a&&(b=!0);p(c)}if(c=l(D,a),!b&&!s(K,a)&&c&&!c.inited){if(C.enforceDefine&&(!f||!ba(f)))return d(a)?void 0:i(A("nodefine","No define call for "+a,null,[a]));p([a,e.deps||[],e.exportsFn])}o()},nameToUrl:function(a,b,c){var d,e,f,g,h,i;if(j.jsExtRegExp.test(a))g=a+(b||"");else{for(d=C.paths,e=C.pkgs,g=a.split("/"),h=g.length;h>0;h-=1){if(i=g.slice(0,h).join("/"),f=l(e,i),i=l(d,i)){I(i)&&(i=i[0]),g.splice(0,h,i);break}if(f){a=a===f.name?f.location+"/"+f.main:f.location,g.splice(0,h,a);break}}g=g.join("/"),g+=b||(/\?/.test(g)||c?"":".js"),g=("/"===g.charAt(0)||g.match(/^[\w\+\.\-]+:/)?"":C.baseUrl)+g}return C.urlArgs?g+((-1===g.indexOf("?")?"?":"&")+C.urlArgs):g},load:function(a,b){j.load(w,a,b)},execCb:function(a,b,c,d){return b.apply(d,c)},onScriptLoad:function(a){("load"===a.type||ka.test((a.currentTarget||a.srcElement).readyState))&&(P=null,a=q(a),w.completeLoad(a.id))},onScriptError:function(a){var b=q(a);return d(b.id)?void 0:i(A("scripterror","Script error for: "+b.id,a,[b.id]))}},w.require=w.makeRequire(),w}var j,w,x,C,J,D,P,K,q,fa,la=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,ma=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,ea=/\.js$/,ja=/^\.\//;w=Object.prototype;var L=w.toString,ga=w.hasOwnProperty,ia=Array.prototype.splice,z=!("undefined"==typeof window||!navigator||!window.document),da=!z&&"undefined"!=typeof importScripts,ka=z&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,W="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),E={},t={},R=[],O=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(H(requirejs))return;t=requirejs,requirejs=void 0}"undefined"!=typeof require&&!H(require)&&(t=require,require=void 0),j=requirejs=function(a,b,c,d){var e,f="_";return!I(a)&&"string"!=typeof a&&(e=a,I(b)?(a=b,b=c,c=d):a=[]),e&&e.context&&(f=e.context),(d=l(E,f))||(d=E[f]=j.s.newContext(f)),e&&d.configure(e),d.require(a,b,c)},j.config=function(a){return j(a)},j.nextTick="undefined"!=typeof setTimeout?function(a){setTimeout(a,4)}:function(a){a()},require||(require=j),j.version="2.1.8",j.jsExtRegExp=/^\/|:|\?|\.js$/,j.isBrowser=z,w=j.s={contexts:E,newContext:ha},j({}),y(["toUrl","undef","defined","specified"],function(a){j[a]=function(){var b=E._;return b.require[a].apply(b,arguments)}}),z&&(x=w.head=document.getElementsByTagName("head")[0],C=document.getElementsByTagName("base")[0])&&(x=w.head=C.parentNode),j.onError=aa,j.createNode=function(a){var b=a.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return b.type=a.scriptType||"text/javascript",b.charset="utf-8",b.async=!0,b},j.load=function(a,b,c){var d=a&&a.config||{};if(z)return d=j.createNode(d,b,c),d.setAttribute("data-requirecontext",a.contextName),d.setAttribute("data-requiremodule",b),!d.attachEvent||d.attachEvent.toString&&0>d.attachEvent.toString().indexOf("[native code")||W?(d.addEventListener("load",a.onScriptLoad,!1),d.addEventListener("error",a.onScriptError,!1)):(O=!0,d.attachEvent("onreadystatechange",a.onScriptLoad)),d.src=c,K=d,C?x.insertBefore(d,C):x.appendChild(d),K=null,d;if(da)try{importScripts(c),a.completeLoad(b)}catch(e){a.onError(A("importscripts","importScripts failed for "+b+" at "+c,e,[b]))}},z&&M(document.getElementsByTagName("script"),function(a){return x||(x=a.parentNode),(J=a.getAttribute("data-main"))?(q=J,t.baseUrl||(D=q.split("/"),q=D.pop(),fa=D.length?D.join("/")+"/":"./",t.baseUrl=fa),q=q.replace(ea,""),j.jsExtRegExp.test(q)&&(q=J),t.deps=t.deps?t.deps.concat(q):[q],!0):void 0}),define=function(a,b,c){var d,e;"string"!=typeof a&&(c=b,b=a,a=null),I(b)||(c=b,b=null),!b&&H(c)&&(b=[],c.length&&(c.toString().replace(la,"").replace(ma,function(a,c){b.push(c)}),b=(1===c.length?["require"]:["require","exports","module"]).concat(b))),O&&((d=K)||(P&&"interactive"===P.readyState||M(document.getElementsByTagName("script"),function(a){return"interactive"===a.readyState?P=a:void 0}),d=P),d&&(a||(a=d.getAttribute("data-requiremodule")),e=E[d.getAttribute("data-requirecontext")])),(e?e.defQueue:R).push([a,b,c])},define.amd={jQuery:!0},j.exec=function(b){return eval(b)},j(t)}}(this);