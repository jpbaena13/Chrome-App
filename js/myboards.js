function NoteboardModel(a){this.data=a,this.data.ctype=a.type.charAt(0).toUpperCase()+a.type.slice(1)}function NoteboardBase(a){var b=this;this.model=new NoteboardModel(a),this.view=this.View(this.model.data),this.view.on("noteboard-share",function(){b.Share()}),this.view.on("noteboard-edit",function(){b.Edit()}),this.view.on("noteboard-delete",function(){b.Delete()}),this.model.on("noteboard-name",function(a,c){b.view.setName(c)}),this.model.on("noteboard-description",function(a,c){b.view.setDescription(c)}),this.model.on("noteboard-visibility",function(a,c){b.view.setVisibility(c)}),this.model.on("noteboard-parentId",function(a,c){b.view.setParentId(c)})}function Noteboard(a,b){NoteboardBase.call(this,a),b||this.UpdateThumbails()}function Folder(a){var b=this;NoteboardBase.call(this,a),this.view.on("branch-clicked",function(){b.BranchClicked()})}function CategoryModel(a){this.data=a||{},this.data.id=a.id||void 0,this.data.name=a.name||"",this.data.creationDate=a.creationDate||void 0,this.data.bgBodyColor=a.bgBodyColor||"CCC",this.data.bgImageBoard=a.bgImageBoard||"silver_new.png",this.data.Class=a.Class||null,this.data.repeat=a.repeat||"no-repeat",this.data.height=a.height||2e3,this.data.width=a.width||4e3,this.data.visibility=a.visibility||"public",this.data.creatorId=a.creatorId||void 0,this.data.structure=a.structure||[]}function Category(a){var b=this;a=a||{},this.model=new CategoryModel(a),this.view=this.View(a),this.view.on("category-name",function(a,c){b.model.setName(c)}),this.view.on("category-width",function(a,c){b.model.setWidth(c)}),this.view.on("category-height",function(a,c){b.model.setHeight(c)}),this.view.on("category-repeat",function(a,c){b.model.setRepeat(c)}),this.view.on("category-visibility",function(a,c){b.model.setVisibility(c)})}function Structure(a){this.view=this.View(a)}var flat_notifications=!0;!function(a){a.getJSON(API+"Activity/CountNotifications/",function(b){b.count>0&&a("#notifications").find("div").html(b.count).show()})}(jQuery),$("#notifications").qtip({content:{ajax:{url:API+"Activity/Notifications/",type:"GET",success:function(a){if(flat_notifications){flat_notifications=!1;var b=this;if($notifications=$("<ul>",{Class:"untNotifications"}),0!=a.length){for(var c=0;c<a.length;c++){var d=a[c];$notifications.append(views.notificationBlock(d))}b.set("content.text",$notifications),$notifications.jScrollPane({showArrows:!1,maintainPosition:!0,stickToBottom:!0})}else $notifications.append('<span class="noNotifications">'+i18n.noNotifications+"</span>"),b.set("content.text",$notifications)}}}},show:"click",hide:"unfocus",position:{at:"bottom middle",my:"top center"},style:{width:480,classes:"ui-tooltip-shadow ui-tooltip-white"}});var flat_invitations=!0;!function(a){a.getJSON(API+"Activity/CountInvitations/",function(b){b.count>0&&a("#invitations").find("div").html(b.count).show()})}(jQuery),$("#invitations").qtip({content:{ajax:{url:API+"Activity/Invitations/",type:"GET",success:function(a){if(flat_invitations){flat_invitations=!1;var b=this;if($invitations=$("<ul>",{Class:"untNotifications"}),0!=a.length){for(var c=0;c<a.length;c++){var d=a[c];$invitations.append(views.invitationBlock(d))}b.set("content.text",$invitations),$invitations.jScrollPane({showArrows:!1,maintainPosition:!0,stickToBottom:!0}),$(".buttons").find(".untBtn").on("click",function(){$this=$(this),$.post(ROOT_URL+"Noteboard/Shared",{action:$this.data("action"),noteboardId:$this.data("noteboard")},function(){location.reload()})})}else $invitations.append('<span class="noNotifications">'+i18n.noInvitations+"</span>"),b.set("content.text",$invitations)}}}},show:"click",hide:"unfocus",position:{at:"bottom middle",my:"top center"},style:{width:480,classes:"ui-tooltip-shadow ui-tooltip-white"}});var flat_alerts=!0;$("#alert").qtip({content:{ajax:{url:API+"Alert/AllAlerts/",type:"GET",success:function(a){if(flat_alerts){flat_alerts=!1;var b=this,c=views.headerAlert(),d=$("<div>",{id:"alertsContainer"});a.forEach(function(a){var b=new Date(a.alertDate);a.dateSelected=getDate(b),a.hourSelected=b.getHours(),a.minuteSelected=b.getMinutes(),d.append(views.alertBlock(a))}),b.set("content.text",c+d[0].outerHTML),$(".alertDate").datepicker({dateFormat:"yy-mm-dd",minDate:0}),$("#addAlert").on("click",function(){var a=$(views.alertBlock({})).prependTo($("#alertsContainer"));a.find("input").attr("disabled",!1),a.find("select").attr("disabled",!1),a.find(".edit").hide(),a.find(".save").show(),a.find(".alertMsg").focus(),a.find(".alertDate").datepicker({dateFormat:"yy-mm-dd",minDate:0})}),$("#alertsContainer").on("click",".untAlertBlock .save",function(){var a=$(this),b=a.parent();return""==$.trim(b.find(".alertMsg").val())?void $.untInputWin({title:i18n.errAlertMsg,content:i18n.errAlertMsg2}):(a.hide(),b.find(".untLoader").show(),void $.post(API+"Alert",b.serialize(),function(a){b.prepend('<input type="hidden" name="id" value="'+a.id+'">'),b.find("input").attr("disabled","disabled"),b.find("select").attr("disabled","disabled"),b.find(".edit").show(),b.find(".save").hide(),b.find(".untLoader").hide()}).fail(function(){a.show(),b.find(".untLoader").hide()}))}),$("#alertsContainer").on("click",".untAlertBlock .delete",function(){var a=$(this),b=a.parent();return b.find("[name=id]").val()?(a.hide(),b.find(".untLoader").show(),void $.ajax({url:API+"Alert/"+b.find("[name=id]").val(),type:"DELETE",success:function(){b.remove()}})):void b.remove()})}}}},show:"click",hide:"click",position:{at:"bottom middle",my:"top center"},style:{width:480,classes:"ui-tooltip-shadow ui-tooltip-white"}}),$("#search").autocomplete({delay:500,source:API+"Noteboard/Search/",close:function(a){var b=a.currentTarget.lastChild;b&&(location.href=$(b).find("a").attr("href"))}}).data("uiAutocomplete")._renderItem=function(a,b){var c=$("<a>",{href:ROOT_URL+"Noteboard/App/"+b.url+"#n-"+b.id,Class:"untNoteSearch",style:"border-left:5px solid #"+b.background}).html('<div class="untContent">'+b.message+'</div><img src="'+b.creatorImage+'" class="untCreatorImage"></div><div class="untDate">'+b.date+"</div>");return $("<li></li>").data("item.autocomplete",b).append(c).appendTo(a)};var headerMenu=!1;$(document).on("click",function(a){var b=$("#btnHeaderMenu");b.is(a.target)?(headerMenu?$("#headerMenu").hide():$("#headerMenu").show(),b.toggleClass("hovered"),headerMenu=!headerMenu):headerMenu&&($("#headerMenu").hide(),b.toggleClass("hovered"),headerMenu=!headerMenu)}),$("#btnChangeAvatar").on("click",function(){$.untInputWin({title:i18n.chageProfileImage,content:'<iframe src="'+ROOT_URL+'Account/UploadProfileImage/" class="untUploadImage"></iframe>',btnAccept:!1,btnCancel:!0,width:485})}),void 0!=getUrlVars().sendMail&&$(".untPlgMsg").untInputMsg({title:i18n.sendMailResetPass,content:i18n.sendMailResetPassMsg,type:"Ok"}).show(),void 0!=getUrlVars().saveProfile&&$(".untPlgMsg").untInputMsg({content:i18n.successSaveData,type:"Ok"}).show(),void 0!=getUrlVars().emailConfirm&&$(".untPlgMsg").untInputMsg({title:i18n.emailConfirm,content:i18n.emailConfirmMsg,type:"Ok"}).show(),void 0!=getUrlVars().emailConfirmErr&&$(".untPlgMsg").untInputMsg({title:i18n.errEmailConfirm,content:i18n.errEmailConfirmMsg,type:"Err"}).show(),void 0!=getUrlVars().passwordChanged&&($(".untPlgMsg").untInputMsg({title:i18n.passwordChanged,content:i18n.passwordChangedMsg,type:"Ok"}).show(),$("#frmSignup").valid(),$("body").addClass("only-form")),function(a,b){function c(b){return b.id&&a('label[for="'+b.id+'"]').val()||b.name}function d(e,f,g){return g||(g=0),f.each(function(){var f,h,i=a(this),j=this,k=this.nodeName.toLowerCase();switch("label"==k&&i.find("input, textarea, select").length&&(f=i.text(),i=i.children().first(),j=i.get(0),k=j.nodeName.toLowerCase()),k){case"menu":h={name:i.attr("label"),items:{}},g=d(h.items,i.children(),g);break;case"a":case"button":h={name:i.text(),disabled:!!i.attr("disabled"),callback:function(){i.click()}};break;case"menuitem":case"command":switch(i.attr("type")){case b:case"command":case"menuitem":h={name:i.attr("label"),disabled:!!i.attr("disabled"),callback:function(){i.click()}};break;case"checkbox":h={type:"checkbox",disabled:!!i.attr("disabled"),name:i.attr("label"),selected:!!i.attr("checked")};break;case"radio":h={type:"radio",disabled:!!i.attr("disabled"),name:i.attr("label"),radio:i.attr("radiogroup"),value:i.attr("id"),selected:!!i.attr("checked")};break;default:h=b}break;case"hr":h="-------";break;case"input":switch(i.attr("type")){case"text":h={type:"text",name:f||c(j),disabled:!!i.attr("disabled"),value:i.val()};break;case"checkbox":h={type:"checkbox",name:f||c(j),disabled:!!i.attr("disabled"),selected:!!i.attr("checked")};break;case"radio":h={type:"radio",name:f||c(j),disabled:!!i.attr("disabled"),radio:!!i.attr("name"),value:i.val(),selected:!!i.attr("checked")};break;default:h=b}break;case"select":h={type:"select",name:f||c(j),disabled:!!i.attr("disabled"),selected:i.val(),options:{}},i.children().each(function(){h.options[this.value]=a(this).text()});break;case"textarea":h={type:"textarea",name:f||c(j),disabled:!!i.attr("disabled"),value:i.val()};break;case"label":break;default:h={type:"html",html:i.clone(!0)}}h&&(g++,e["key"+g]=h)}),g}if(a.support.htmlMenuitem="HTMLMenuItemElement"in window,a.support.htmlCommand="HTMLCommandElement"in window,a.support.eventSelectstart="onselectstart"in document.documentElement,!a.ui||!a.ui.widget){var e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(f){}e(b)}}var f,g=null,h=!1,i=a(window),j=0,k={},l={},m={},n={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,determinePosition:function(b){if(a.ui&&a.ui.position)b.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var c=this.offset();c.top+=this.outerHeight(),c.left+=this.outerWidth()/2-b.outerWidth()/2,b.css(c)}},position:function(a,b,c){if(b||c){b="maintain"===b&&"maintain"===c?a.$menu.position():{top:c,left:b},c=i.scrollTop()+i.height();var d=i.scrollLeft()+i.width(),e=a.$menu.height(),f=a.$menu.width();b.top+e>c&&(b.top-=e),b.left+f>d&&(b.left-=f),a.$menu.css(b)}else a.determinePosition.call(this,a.$menu)},positionSubmenu:function(b){if(a.ui&&a.ui.position)b.css("display","block").position({my:"left top",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var c={top:0,left:this.outerWidth()};b.css(c)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:a.noop,hide:a.noop},callback:null,items:{}},o=null,p=null,q=null,r={abortevent:function(a){a.preventDefault(),a.stopImmediatePropagation()},contextmenu:function(b){var c=a(this);if(b.preventDefault(),b.stopImmediatePropagation(),!("right"!=b.data.trigger&&b.originalEvent||c.hasClass("context-menu-active")||c.hasClass("context-menu-disabled"))){if(g=c,b.data.build){var d=b.data.build(g,b);if(!1===d)return;if(b.data=a.extend(!0,{},n,b.data,d||{}),!b.data.items||a.isEmptyObject(b.data.items))throw window.console&&(console.error||console.log)("No items specified to show in contextMenu"),Error("No Items sepcified");b.data.$trigger=g,s.create(b.data)}s.show.call(c,b.data,b.pageX,b.pageY)}},click:function(b){b.preventDefault(),b.stopImmediatePropagation(),a(this).trigger(a.Event("contextmenu",{data:b.data,pageX:b.pageX,pageY:b.pageY}))},mousedown:function(b){var c=a(this);g&&g.length&&!g.is(c)&&g.data("contextMenu").$menu.trigger("contextmenu:hide"),2==b.button&&(g=c.data("contextMenuActive",!0))},mouseup:function(b){var c=a(this);c.data("contextMenuActive")&&g&&g.length&&g.is(c)&&!c.hasClass("context-menu-disabled")&&(b.preventDefault(),b.stopImmediatePropagation(),g=c,c.trigger(a.Event("contextmenu",{data:b.data,pageX:b.pageX,pageY:b.pageY}))),c.removeData("contextMenuActive")},mouseenter:function(b){var c=a(this),d=a(b.relatedTarget),e=a(document);d.is(".context-menu-list")||d.closest(".context-menu-list").length||g&&g.length||(p=b.pageX,q=b.pageY,f=b.data,e.on("mousemove.contextMenuShow",r.mousemove),o=setTimeout(function(){o=null,e.off("mousemove.contextMenuShow"),g=c,c.trigger(a.Event("contextmenu",{data:f,pageX:p,pageY:q}))},b.data.delay))},mousemove:function(a){p=a.pageX,q=a.pageY},mouseleave:function(b){if(b=a(b.relatedTarget),!b.is(".context-menu-list")&&!b.closest(".context-menu-list").length){try{clearTimeout(o)}catch(c){}o=null}},layerClick:function(b){var c,d,e=a(this).data("contextMenuRoot"),f=b.button,g=b.pageX,h=b.pageY;b.preventDefault(),b.stopImmediatePropagation(),setTimeout(function(){var j,k="left"==e.trigger&&0===f||"right"==e.trigger&&2===f;if(document.elementFromPoint&&(e.$layer.hide(),c=document.elementFromPoint(g-i.scrollLeft(),h-i.scrollTop()),e.$layer.show()),e.reposition&&k)if(document.elementFromPoint){if(e.$trigger.is(c)||e.$trigger.has(c).length)return void e.position.call(e.$trigger,e,g,h)}else if(d=e.$trigger.offset(),j=a(window),d.top+=j.scrollTop(),d.top<=b.pageY&&(d.left+=j.scrollLeft(),d.left<=b.pageX&&(d.bottom=d.top+e.$trigger.outerHeight(),d.bottom>=b.pageY&&(d.right=d.left+e.$trigger.outerWidth(),d.right>=b.pageX))))return void e.position.call(e.$trigger,e,g,h);c&&k&&e.$trigger.one("contextmenu:hidden",function(){a(c).contextMenu({x:g,y:h})}),e.$menu.trigger("contextmenu:hide")},50)},keyStop:function(a,b){b.isInput||a.preventDefault(),a.stopPropagation()},key:function(a){var b=g.data("contextMenu")||{};switch(a.keyCode){case 9:case 38:if(r.keyStop(a,b),b.isInput){if(9==a.keyCode&&a.shiftKey)return a.preventDefault(),b.$selected&&b.$selected.find("input, textarea, select").blur(),void b.$menu.trigger("prevcommand");if(38==a.keyCode&&"checkbox"==b.$selected.find("input, textarea, select").prop("type"))return void a.preventDefault()}else if(9!=a.keyCode||a.shiftKey)return void b.$menu.trigger("prevcommand");case 40:if(r.keyStop(a,b),!b.isInput)return void b.$menu.trigger("nextcommand");if(9==a.keyCode)return a.preventDefault(),b.$selected&&b.$selected.find("input, textarea, select").blur(),void b.$menu.trigger("nextcommand");if(40==a.keyCode&&"checkbox"==b.$selected.find("input, textarea, select").prop("type"))return void a.preventDefault();break;case 37:if(r.keyStop(a,b),b.isInput||!b.$selected||!b.$selected.length)break;if(!b.$selected.parent().hasClass("context-menu-root"))return a=b.$selected.parent().parent(),b.$selected.trigger("contextmenu:blur"),void(b.$selected=a);break;case 39:if(r.keyStop(a,b),b.isInput||!b.$selected||!b.$selected.length)break;var c=b.$selected.data("contextMenu")||{};if(c.$menu&&b.$selected.hasClass("context-menu-submenu"))return b.$selected=null,c.$selected=null,void c.$menu.trigger("nextcommand");break;case 35:case 36:return void(b.$selected&&b.$selected.find("input, textarea, select").length||((b.$selected&&b.$selected.parent()||b.$menu).children(":not(.disabled, .not-selectable)")[36==a.keyCode?"first":"last"]().trigger("contextmenu:focus"),a.preventDefault()));case 13:if(r.keyStop(a,b),b.isInput){if(b.$selected&&!b.$selected.is("textarea, select"))return void a.preventDefault();break}return void(b.$selected&&b.$selected.trigger("mouseup"));case 32:case 33:case 34:return void r.keyStop(a,b);case 27:return r.keyStop(a,b),void b.$menu.trigger("contextmenu:hide");default:if(c=String.fromCharCode(a.keyCode).toUpperCase(),b.accesskeys[c])return void b.accesskeys[c].$node.trigger(b.accesskeys[c].$menu?"contextmenu:focus":"mouseup")}a.stopPropagation(),b.$selected&&b.$selected.trigger(a)},prevItem:function(b){b.stopPropagation();var c=a(this).data("contextMenu")||{};if(c.$selected){var d=c.$selected,c=c.$selected.parent().data("contextMenu")||{};c.$selected=d}for(var d=c.$menu.children(),e=c.$selected&&c.$selected.prev().length?c.$selected.prev():d.last(),f=e;e.hasClass("disabled")||e.hasClass("not-selectable");)if(e=e.prev().length?e.prev():d.last(),e.is(f))return;c.$selected&&r.itemMouseleave.call(c.$selected.get(0),b),r.itemMouseenter.call(e.get(0),b),b=e.find("input, textarea, select"),b.length&&b.focus()},nextItem:function(b){b.stopPropagation();var c=a(this).data("contextMenu")||{};if(c.$selected){var d=c.$selected,c=c.$selected.parent().data("contextMenu")||{};c.$selected=d}for(var d=c.$menu.children(),e=c.$selected&&c.$selected.next().length?c.$selected.next():d.first(),f=e;e.hasClass("disabled")||e.hasClass("not-selectable");)if(e=e.next().length?e.next():d.first(),e.is(f))return;c.$selected&&r.itemMouseleave.call(c.$selected.get(0),b),r.itemMouseenter.call(e.get(0),b),b=e.find("input, textarea, select"),b.length&&b.focus()},focusInput:function(){var b=a(this).closest(".context-menu-item"),c=b.data(),d=c.contextMenu,c=c.contextMenuRoot;c.$selected=d.$selected=b,c.isInput=d.isInput=!0},blurInput:function(){var b=a(this).closest(".context-menu-item").data();b.contextMenuRoot.isInput=b.contextMenu.isInput=!1},menuMouseenter:function(){a(this).data().contextMenuRoot.hovering=!0},menuMouseleave:function(b){var c=a(this).data().contextMenuRoot;c.$layer&&c.$layer.is(b.relatedTarget)&&(c.hovering=!1)},itemMouseenter:function(b){var c=a(this),d=c.data(),e=d.contextMenu,d=d.contextMenuRoot;d.hovering=!0,b&&d.$layer&&d.$layer.is(b.relatedTarget)&&(b.preventDefault(),b.stopImmediatePropagation()),(e.$menu?e:d).$menu.children(".hover").trigger("contextmenu:blur"),c.hasClass("disabled")||c.hasClass("not-selectable")?e.$selected=null:c.trigger("contextmenu:focus")},itemMouseleave:function(b){var c=a(this),d=c.data(),e=d.contextMenu,d=d.contextMenuRoot;d!==e&&d.$layer&&d.$layer.is(b.relatedTarget)?(d.$selected&&d.$selected.trigger("contextmenu:blur"),b.preventDefault(),b.stopImmediatePropagation(),d.$selected=e.$selected=e.$node):c.trigger("contextmenu:blur")},itemClick:function(b){var c=a(this),d=c.data(),e=d.contextMenuRoot,f=d.contextMenuKey;if(d.contextMenu.items[f]&&!c.is(".disabled, .context-menu-submenu, .context-menu-separator, .not-selectable")){if(b.preventDefault(),b.stopImmediatePropagation(),a.isFunction(e.callbacks[f])&&Object.prototype.hasOwnProperty.call(e.callbacks,f))b=e.callbacks[f];else{if(!a.isFunction(e.callback))return;b=e.callback}!1!==b.call(e.$trigger,f,e)?e.$menu.trigger("contextmenu:hide"):e.$menu.parent().length&&s.update.call(e.$trigger,e)}},inputClick:function(a){a.stopImmediatePropagation()},hideMenu:function(b,c){var d=a(this).data("contextMenuRoot");s.hide.call(d.$trigger,d,c&&c.force)},focusItem:function(b){b.stopPropagation(),b=a(this);var c=b.data(),d=c.contextMenu,c=c.contextMenuRoot;b.addClass("hover").siblings(".hover").trigger("contextmenu:blur"),d.$selected=c.$selected=b,d.$node&&c.positionSubmenu.call(d.$node,d.$menu)},blurItem:function(b){b.stopPropagation(),b=a(this);var c=b.data().contextMenu;b.removeClass("hover"),c.$selected=null}},s={show:function(b,c,d){var e=a(this),f={};if(a("#context-menu-layer").trigger("mousedown"),b.$trigger=e,!1===b.events.show.call(e,b))g=null;else{if(s.update.call(e,b),b.position.call(e,b,c,d),b.zIndex){for(c=0,d=e;c=Math.max(c,parseInt(d.css("z-index"),10)||0),d=d.parent(),!(!d||!d.length||-1<"html body".indexOf(d.prop("nodeName").toLowerCase())););f.zIndex=c+b.zIndex}s.layer.call(b.$menu,b,f.zIndex),b.$menu.find("ul").css("zIndex",f.zIndex+1),b.$menu.css(f)[b.animation.show](b.animation.duration,function(){e.trigger("contextmenu:visible")}),e.data("contextMenu",b).addClass("context-menu-active"),a(document).off("keydown.contextMenu").on("keydown.contextMenu",r.key),b.autoHide&&a(document).on("mousemove.contextMenuAutoHide",function(a){var c=e.offset();c.right=c.left+e.outerWidth(),c.bottom=c.top+e.outerHeight(),!(!b.$layer||b.hovering||a.pageX>=c.left&&a.pageX<=c.right&&a.pageY>=c.top&&a.pageY<=c.bottom||!b.$menu.trigger("contextmenu:hide"))})}},hide:function(c,d){var e=a(this);if(c||(c=e.data("contextMenu")||{}),d||!c.events||!1!==c.events.hide.call(e,c)){if(e.removeData("contextMenu").removeClass("context-menu-active"),c.$layer){var f=c.$layer;setTimeout(function(){f.remove()},10);try{delete c.$layer}catch(h){c.$layer=null}}g=null,c.$menu.find(".hover").trigger("contextmenu:blur"),c.$selected=null,a(document).off(".contextMenuAutoHide").off("keydown.contextMenu"),c.$menu&&c.$menu[c.animation.hide](c.animation.duration,function(){c.build&&(c.$menu.remove(),a.each(c,function(a){switch(a){case"ns":case"selector":case"build":case"trigger":return!0;default:c[a]=b;try{delete c[a]}catch(d){}return!0}})),setTimeout(function(){e.trigger("contextmenu:hidden")},10)})}},create:function(c,d){d===b&&(d=c),c.$menu=a('<ul class="context-menu-list"></ul>').addClass(c.className||"").data({contextMenu:c,contextMenuRoot:d}),a.each(["callbacks","commands","inputs"],function(a,b){c[b]={},d[b]||(d[b]={})}),d.accesskeys||(d.accesskeys={}),a.each(c.items,function(b,e){var f=a('<li class="context-menu-item"></li>').addClass(e.className||""),g=null,h=null;if(f.on("click",a.noop),e.$node=f.data({contextMenu:c,contextMenuRoot:d,contextMenuKey:b}),e.accesskey){for(var i,j=e.accesskey.split(/\s+/),k=[],l=0;i=j[l];l++)i=i[0].toUpperCase(),k.push(i);for(j=0;l=k[j];j++)if(!d.accesskeys[l]){d.accesskeys[l]=e,e._name=e.name.replace(RegExp("("+l+")","i"),'<span class="context-menu-accesskey">$1</span>');break}}if("string"==typeof e)f.addClass("context-menu-separator not-selectable");else if(e.type&&m[e.type])m[e.type].call(f,e,c,d),a.each([c,d],function(c,d){d.commands[b]=e,a.isFunction(e.callback)&&(d.callbacks[b]=e.callback)});else{switch("html"==e.type?f.addClass("context-menu-html not-selectable"):e.type?(g=a("<label></label>").appendTo(f),a("<span></span>").html(e._name||e.name).appendTo(g),f.addClass("context-menu-input"),c.hasTypes=!0,a.each([c,d],function(a,c){c.commands[b]=e,c.inputs[b]=e})):e.items&&(e.type="sub"),e.type){case"text":h=a('<input type="text" value="1" name="" value="">').attr("name","context-menu-input-"+b).val(e.value||"").appendTo(g);break;case"textarea":h=a('<textarea name=""></textarea>').attr("name","context-menu-input-"+b).val(e.value||"").appendTo(g),e.height&&h.height(e.height);break;case"checkbox":h=a('<input type="checkbox" value="1" name="" value="">').attr("name","context-menu-input-"+b).val(e.value||"").prop("checked",!!e.selected).prependTo(g);break;case"radio":h=a('<input type="radio" value="1" name="" value="">').attr("name","context-menu-input-"+e.radio).val(e.value||"").prop("checked",!!e.selected).prependTo(g);break;case"select":h=a('<select name="">').attr("name","context-menu-input-"+b).appendTo(g),e.options&&(a.each(e.options,function(b,c){a("<option></option>").val(b).text(c).appendTo(h)}),h.val(e.selected));break;case"sub":a("<span></span>").html(e._name||e.name).appendTo(f),e.appendTo=e.$node,s.create(e,d),f.data("contextMenu",e).addClass("context-menu-submenu"),e.callback=null;break;case"html":a(e.html).appendTo(f);break;default:a.each([c,d],function(c,d){d.commands[b]=e,a.isFunction(e.callback)&&(d.callbacks[b]=e.callback)}),a("<span></span>").html(e._name||e.name||"").appendTo(f)}e.type&&"sub"!=e.type&&"html"!=e.type&&(h.on("focus",r.focusInput).on("blur",r.blurInput),e.events)&&h.on(e.events,c),e.icon&&f.addClass("icon icon-"+e.icon)}e.$input=h,e.$label=g,f.appendTo(c.$menu),!c.hasTypes&&a.support.eventSelectstart&&f.on("selectstart.disableTextSelect",r.abortevent)}),c.$node||c.$menu.css("display","none").addClass("context-menu-root"),c.$menu.appendTo(c.appendTo||document.body)},resize:function(b,c){b.css({position:"absolute",display:"block"}),b.data("width",Math.ceil(b.width())+1),b.css({position:"static",minWidth:"0px",maxWidth:"100000px"}),b.find("> li > ul").each(function(){s.resize(a(this),!0)}),c||b.find("ul").andSelf().css({position:"",display:"",minWidth:"",maxWidth:""}).width(function(){return a(this).data("width")})},update:function(c,d){var e=this;d===b&&(d=c,s.resize(c.$menu)),c.$menu.children().each(function(){var b=a(this),f=b.data("contextMenuKey"),g=c.items[f],f=a.isFunction(g.disabled)&&g.disabled.call(e,f,d)||!0===g.disabled;if(b[f?"addClass":"removeClass"]("disabled"),g.type)switch(b.find("input, select, textarea").prop("disabled",f),g.type){case"text":case"textarea":g.$input.val(g.value||"");break;case"checkbox":case"radio":g.$input.val(g.value||"").prop("checked",!!g.selected);break;case"select":g.$input.val(g.selected||"")}g.$menu&&s.update.call(e,g,d)})},layer:function(b,c){var d=b.$layer=a('<div id="context-menu-layer" style="position:fixed; z-index:'+c+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"></div>').css({height:i.height(),width:i.width(),display:"block"}).data("contextMenuRoot",b).insertBefore(this).on("contextmenu",r.abortevent).on("mousedown",r.layerClick);return a.support.fixedPosition||d.css({position:"absolute",height:a(document).height()}),d}};a.fn.contextMenu=function(c){return c===b?this.first().trigger("contextmenu"):c.x&&c.y?this.first().trigger(a.Event("contextmenu",{pageX:c.x,pageY:c.y})):"hide"===c?(c=this.data("contextMenu").$menu)&&c.trigger("contextmenu:hide"):"destroy"===c?a.contextMenu("destroy",{context:this}):a.isPlainObject(c)?(c.context=this,a.contextMenu("create",c)):c?this.removeClass("context-menu-disabled"):c||this.addClass("context-menu-disabled"),this},a.contextMenu=function(c,d){"string"!=typeof c&&(d=c,c="create"),"string"==typeof d?d={selector:d}:d===b&&(d={});var e=a.extend(!0,{},n,d||{}),f=a(document),g=f,i=!1;switch(e.context&&e.context.length?(g=a(e.context).first(),e.context=g.get(0),i=e.context!==document):e.context=document,c){case"create":if(!e.selector)throw Error("No selector specified");if(e.selector.match(/.context-menu-(list|item|input)($|\s)/))throw Error('Cannot bind to selector "'+e.selector+'" as it contains a reserved className');if(!e.build&&(!e.items||a.isEmptyObject(e.items)))throw Error("No Items sepcified");switch(j++,e.ns=".contextMenu"+j,i||(k[e.selector]=e.ns),l[e.ns]=e,e.trigger||(e.trigger="right"),h||(f.on({"contextmenu:hide.contextMenu":r.hideMenu,"prevcommand.contextMenu":r.prevItem,"nextcommand.contextMenu":r.nextItem,"contextmenu.contextMenu":r.abortevent,"mouseenter.contextMenu":r.menuMouseenter,"mouseleave.contextMenu":r.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",r.inputClick).on({"mouseup.contextMenu":r.itemClick,"contextmenu:focus.contextMenu":r.focusItem,"contextmenu:blur.contextMenu":r.blurItem,"contextmenu.contextMenu":r.abortevent,"mouseenter.contextMenu":r.itemMouseenter,"mouseleave.contextMenu":r.itemMouseleave},".context-menu-item"),h=!0),g.on("contextmenu"+e.ns,e.selector,e,r.contextmenu),i&&g.on("remove"+e.ns,function(){a(this).contextMenu("destroy")}),e.trigger){case"hover":g.on("mouseenter"+e.ns,e.selector,e,r.mouseenter).on("mouseleave"+e.ns,e.selector,e,r.mouseleave);break;case"left":g.on("click"+e.ns,e.selector,e,r.click)}e.build||s.create(e);break;case"destroy":var m;if(i){var o=e.context;a.each(l,function(b,c){if(c.context!==o)return!0;m=a(".context-menu-list").filter(":visible"),m.length&&m.data().contextMenuRoot.$trigger.is(a(c.context).find(c.selector))&&m.trigger("contextmenu:hide",{force:!0});try{l[c.ns].$menu&&l[c.ns].$menu.remove(),delete l[c.ns]}catch(d){l[c.ns]=null}return a(c.context).off(c.ns),!0})}else if(e.selector){if(k[e.selector]){m=a(".context-menu-list").filter(":visible"),m.length&&m.data().contextMenuRoot.$trigger.is(e.selector)&&m.trigger("contextmenu:hide",{force:!0});try{l[k[e.selector]].$menu&&l[k[e.selector]].$menu.remove(),delete l[k[e.selector]]}catch(p){l[k[e.selector]]=null}f.off(k[e.selector])}}else f.off(".contextMenu .contextMenuAutoHide"),a.each(l,function(b,c){a(c.context).off(c.ns)}),k={},l={},j=0,h=!1,a("#context-menu-layer, .context-menu-list").remove();break;case"html5":(!a.support.htmlCommand&&!a.support.htmlMenuitem||"boolean"==typeof d&&d)&&a('menu[type="context"]').each(function(){this.id&&a.contextMenu({selector:"[contextmenu="+this.id+"]",items:a.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw Error('Unknown operation "'+c+'"')}return this},a.contextMenu.setInputValues=function(c,d){d===b&&(d={}),a.each(c.inputs,function(a,b){switch(b.type){case"text":case"textarea":b.value=d[a]||"";break;case"checkbox":b.selected=d[a]?!0:!1;break;case"radio":b.selected=(d[b.radio]||"")==b.value?!0:!1;break;case"select":b.selected=d[a]||""}})},a.contextMenu.getInputValues=function(c,d){return d===b&&(d={}),a.each(c.inputs,function(a,b){switch(b.type){case"text":case"textarea":case"select":d[a]=b.$input.val();break;case"checkbox":d[a]=b.$input.prop("checked");break;case"radio":b.$input.prop("checked")&&(d[b.radio]=b.value)}}),d},a.contextMenu.fromMenu=function(b){b=a(b);var c={};return d(c,b.children()),c},a.contextMenu.defaults=n,a.contextMenu.types=m,a.contextMenu.handle=r,a.contextMenu.op=s,a.contextMenu.menus=l}(jQuery),function(a){a.extend(a.fn,{swapClass:function(a,b){var c=this.filter("."+a);return this.filter("."+b).removeClass(b).addClass(a),c.removeClass(a).addClass(b),this},replaceClass:function(a,b){return this.filter("."+a).removeClass(a).addClass(b).end()},hoverClass:function(b){return b=b||"hover",this.hover(function(){a(this).addClass(b)},function(){a(this).removeClass(b)})},heightToggle:function(a,b){a?this.animate({height:"toggle"},a,b):this.each(function(){jQuery(this)[jQuery(this).is(":hidden")?"show":"hide"](),b&&b.apply(this,arguments)})},heightHide:function(a,b){a?this.animate({height:"hide"},a,b):(this.hide(),b&&this.each(b))},prepareBranches:function(a){return a.prerendered||(this.filter(":last-child:not(ul)").addClass(b.last),this.filter((a.collapsed?"":"."+b.closed)+":not(."+b.open+")").find(">ul").hide()),this.filter(":has(>ul)")},applyClasses:function(c,d){if(this.filter(":has(>ul):not(:has(>a))").find(">span").unbind("click.treeview").bind("click.treeview",function(b){this==b.target&&d.apply(a(this).next())}).add(a("a",this)).hoverClass(),!c.prerendered){this.filter(":has(>ul:hidden)").addClass(b.expandable).replaceClass(b.last,b.lastExpandable),this.not(":has(>ul:hidden)").addClass(b.collapsable).replaceClass(b.last,b.lastCollapsable);var e=this.find("div."+b.hitarea);e.length||(e=this.prepend('<div class="'+b.hitarea+'"/>').find("div."+b.hitarea)),e.removeClass().addClass(b.hitarea).each(function(){var b="";a.each(a(this).parent().attr("class").split(" "),function(){b+=this+"-hitarea "}),a(this).addClass(b)})}this.find("div."+b.hitarea).click(d)},treeview:function(c){function d(c,d){function f(d){return function(){return e.apply(a("div."+b.hitarea,c).filter(function(){return d?a(this).parent("."+d).length:!0})),!1}}a("a:eq(0)",d).click(f(b.collapsable)),a("a:eq(1)",d).click(f(b.expandable)),a("a:eq(2)",d).click(f())}function e(){a(this).parent().find(">.hitarea").swapClass(b.collapsableHitarea,b.expandableHitarea).swapClass(b.lastCollapsableHitarea,b.lastExpandableHitarea).end().swapClass(b.collapsable,b.expandable).swapClass(b.lastCollapsable,b.lastExpandable).find(">ul").heightToggle(c.animated,c.toggle),c.unique&&a(this).parent().siblings().find(">.hitarea").replaceClass(b.collapsableHitarea,b.expandableHitarea).replaceClass(b.lastCollapsableHitarea,b.lastExpandableHitarea).end().replaceClass(b.collapsable,b.expandable).replaceClass(b.lastCollapsable,b.lastExpandable).find(">ul").heightHide(c.animated,c.toggle)}function f(){var b=[];i.each(function(c,d){b[c]=a(d).is(":has(>ul:visible)")?1:0}),a.cookie(c.cookieId,b.join(""),c.cookieOptions)}function g(){var b=a.cookie(c.cookieId);if(b){var d=b.split("");i.each(function(b,c){a(c).find(">ul")[parseInt(d[b])?"show":"hide"]()})}}if(c=a.extend({cookieId:"treeview"},c),c.toggle){var h=c.toggle;c.toggle=function(){return h.apply(a(this).parent()[0],arguments)}}this.data("toggler",e),this.addClass("treeview");var i=this.find("li").prepareBranches(c);switch(c.persist){case"cookie":var j=c.toggle;c.toggle=function(){f(),j&&j.apply(this,arguments)},g();break;case"location":var k=this.find("a").filter(function(){return this.href.toLowerCase()==location.href.toLowerCase()});if(k.length){var l=k.addClass("selected").parents("ul, li").add(k.next()).show();c.prerendered&&l.filter("li").swapClass(b.collapsable,b.expandable).swapClass(b.lastCollapsable,b.lastExpandable).find(">.hitarea").swapClass(b.collapsableHitarea,b.expandableHitarea).swapClass(b.lastCollapsableHitarea,b.lastExpandableHitarea)
}}return i.applyClasses(c,e),c.control&&(d(this,c.control),a(c.control).show()),this}}),a.treeview={};var b=a.treeview.classes={open:"open",closed:"closed",expandable:"expandable",expandableHitarea:"expandable-hitarea",lastExpandableHitarea:"lastExpandable-hitarea",collapsable:"collapsable",collapsableHitarea:"collapsable-hitarea",lastCollapsableHitarea:"lastCollapsable-hitarea",lastCollapsable:"lastCollapsable",lastExpandable:"lastExpandable",last:"last",hitarea:"hitarea"}}(jQuery),function(a){var b=a.treeview.classes,c=a.fn.treeview;a.fn.treeview=function(d){return d=a.extend({},d),d.add?this.trigger("add",[d.add]):d.remove?this.trigger("remove",[d.remove]):c.apply(this,arguments).bind("add",function(c,e){a(e).prev().removeClass(b.last).removeClass(b.lastCollapsable).removeClass(b.lastExpandable).find(">.hitarea").removeClass(b.lastCollapsableHitarea).removeClass(b.lastExpandableHitarea),a(e).find("li").andSelf().prepareBranches(d).applyClasses(d,a(this).data("toggler"))}).bind("remove",function(c,d){var e=a(d).prev(),f=a(d).parent();a(d).remove(),e.filter(":last-child").addClass(b.last).filter("."+b.expandable).replaceClass(b.last,b.lastExpandable).end().find(">.hitarea").replaceClass(b.expandableHitarea,b.lastExpandableHitarea).end().filter("."+b.collapsable).replaceClass(b.last,b.lastCollapsable).end().find(">.hitarea").replaceClass(b.collapsableHitarea,b.lastCollapsableHitarea),f.is(":not(:has(>))")&&f[0]!=this&&(f.parent().removeClass(b.collapsable).removeClass(b.expandable),f.siblings(".hitarea").andSelf().remove())})}}(jQuery),!function(){function a(b,c,d){var e=a.resolve(b);if(null==e){d=d||b,c=c||"root";var f=new Error('Failed to require "'+d+'" from "'+c+'"');throw f.path=d,f.parent=c,f.require=!0,f}var g=a.modules[e];if(!g._resolving&&!g.exports){var h={};h.exports={},h.client=h.component=!0,g._resolving=!0,g.call(this,h.exports,a.relative(e),h),delete g._resolving,g.exports=h.exports}return g.exports}a.modules={},a.aliases={},a.resolve=function(b){"/"===b.charAt(0)&&(b=b.slice(1));for(var c=[b,b+".js",b+".json",b+"/index.js",b+"/index.json"],d=0;d<c.length;d++){var b=c[d];if(a.modules.hasOwnProperty(b))return b;if(a.aliases.hasOwnProperty(b))return a.aliases[b]}},a.normalize=function(a,b){var c=[];if("."!=b.charAt(0))return b;a=a.split("/"),b=b.split("/");for(var d=0;d<b.length;++d)".."==b[d]?a.pop():"."!=b[d]&&""!=b[d]&&c.push(b[d]);return a.concat(c).join("/")},a.register=function(b,c){a.modules[b]=c},a.alias=function(b,c){if(!a.modules.hasOwnProperty(b))throw new Error('Failed to alias "'+b+'", it does not exist');a.aliases[c]=b},a.relative=function(b){function c(a,b){for(var c=a.length;c--;)if(a[c]===b)return c;return-1}function d(c){var e=d.resolve(c);return a(e,b,c)}var e=a.normalize(b,"..");return d.resolve=function(d){var f=d.charAt(0);if("/"==f)return d.slice(1);if("."==f)return a.normalize(e,d);var g=b.split("/"),h=c(g,"deps")+1;return h||(h=0),d=g.slice(0,h+1).join("/")+"/deps/"+d},d.exists=function(b){return a.modules.hasOwnProperty(d.resolve(b))},d},a.register("component-emitter/index.js",function(a,b,c){function d(a){return a?e(a):void 0}function e(a){for(var b in d.prototype)a[b]=d.prototype[b];return a}c.exports=d,d.prototype.on=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks[a]=this._callbacks[a]||[]).push(b),this},d.prototype.once=function(a,b){function c(){d.off(a,c),b.apply(this,arguments)}var d=this;return this._callbacks=this._callbacks||{},b._off=c,this.on(a,c),this},d.prototype.off=d.prototype.removeListener=d.prototype.removeAllListeners=function(a,b){this._callbacks=this._callbacks||{};var c=this._callbacks[a];if(!c)return this;if(1==arguments.length)return delete this._callbacks[a],this;var d=c.indexOf(b._off||b);return~d&&c.splice(d,1),this},d.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks[a];if(c){c=c.slice(0);for(var d=0,e=c.length;e>d;++d)c[d].apply(this,b)}return this},d.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks[a]||[]},d.prototype.hasListeners=function(a){return!!this.listeners(a).length}}),a.register("dropzone/index.js",function(a,b,c){c.exports=b("./lib/dropzone.js")}),a.register("dropzone/lib/dropzone.js",function(a,b,c){(function(){var a,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},m=[].slice;d="undefined"!=typeof Emitter&&null!==Emitter?Emitter:b("emitter"),i=function(){},a=function(a){function b(a,d){var e,f,g;if(this.element=a,this.version=b.version,this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,""),this.clickableElements=[],this.listeners=[],this.files=[],"string"==typeof this.element&&(this.element=document.querySelector(this.element)),!this.element||null==this.element.nodeType)throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("Dropzone already attached.");if(b.instances.push(this),this.element.dropzone=this,e=null!=(g=b.optionsForElement(this.element))?g:{},this.options=c({},this.defaultOptions,e,null!=d?d:{}),this.options.forceFallback||!b.isBrowserSupported())return this.options.fallback.call(this);if(null==this.options.url&&(this.options.url=this.element.getAttribute("action")),!this.options.url)throw new Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");this.options.acceptedMimeTypes&&(this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes),this.options.method=this.options.method.toUpperCase(),(f=this.getExistingFallback())&&f.parentNode&&f.parentNode.removeChild(f),this.previewsContainer=this.options.previewsContainer?b.getElement(this.options.previewsContainer,"previewsContainer"):this.element,this.options.clickable&&(this.clickableElements=this.options.clickable===!0?[this.element]:b.getElements(this.options.clickable,"clickable")),this.init()}var c;return l(b,a),b.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached"],b.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:100,thumbnailHeight:100,maxFiles:null,params:{},clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,addRemoveLinks:!1,previewsContainer:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(a,b){return b()},init:function(){return i},forceFallback:!1,fallback:function(){var a,c,d,e,f,g;for(this.element.className=""+this.element.className+" dz-browser-not-supported",g=this.element.getElementsByTagName("div"),e=0,f=g.length;f>e;e++)a=g[e],/(^| )dz-message($| )/.test(a.className)&&(c=a,a.className="dz-message");return c||(c=b.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(c)),d=c.getElementsByTagName("span")[0],d&&(d.textContent=this.options.dictFallbackMessage),this.element.appendChild(this.getFallbackForm())},resize:function(a){var b,c,d;return b={srcX:0,srcY:0,srcWidth:a.width,srcHeight:a.height},c=a.width/a.height,d=this.options.thumbnailWidth/this.options.thumbnailHeight,a.height<this.options.thumbnailHeight||a.width<this.options.thumbnailWidth?(b.trgHeight=b.srcHeight,b.trgWidth=b.srcWidth):c>d?(b.srcHeight=a.height,b.srcWidth=b.srcHeight*d):(b.srcWidth=a.width,b.srcHeight=b.srcWidth/d),b.srcX=(a.width-b.srcWidth)/2,b.srcY=(a.height-b.srcHeight)/2,b},drop:function(){return this.element.classList.remove("dz-drag-hover")},dragstart:i,dragend:function(){return this.element.classList.remove("dz-drag-hover")},dragenter:function(){return this.element.classList.add("dz-drag-hover")},dragover:function(){return this.element.classList.add("dz-drag-hover")},dragleave:function(){return this.element.classList.remove("dz-drag-hover")},paste:i,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(a){var c,d,e,f,g,h,i,j,k,l,m,n,o,p=this;for(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),a.previewElement=b.createElement(this.options.previewTemplate.trim()),a.previewTemplate=a.previewElement,this.previewsContainer.appendChild(a.previewElement),l=a.previewElement.querySelectorAll("[data-dz-name]"),f=0,i=l.length;i>f;f++)c=l[f],c.textContent=a.name;for(m=a.previewElement.querySelectorAll("[data-dz-size]"),g=0,j=m.length;j>g;g++)c=m[g],c.innerHTML=this.filesize(a.size);for(this.options.addRemoveLinks&&(a._removeLink=b.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),a.previewElement.appendChild(a._removeLink)),d=function(c){return c.preventDefault(),c.stopPropagation(),a.status===b.UPLOADING?b.confirm(p.options.dictCancelUploadConfirmation,function(){return p.removeFile(a)}):p.options.dictRemoveFileConfirmation?b.confirm(p.options.dictRemoveFileConfirmation,function(){return p.removeFile(a)}):p.removeFile(a)},n=a.previewElement.querySelectorAll("[data-dz-remove]"),o=[],h=0,k=n.length;k>h;h++)e=n[h],o.push(e.addEventListener("click",d));return o},removedfile:function(a){var b;return null!=(b=a.previewElement)&&b.parentNode.removeChild(a.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(a,b){var c,d,e,f,g;for(a.previewElement.classList.remove("dz-file-preview"),a.previewElement.classList.add("dz-image-preview"),f=a.previewElement.querySelectorAll("[data-dz-thumbnail]"),g=[],d=0,e=f.length;e>d;d++)c=f[d],c.alt=a.name,g.push(c.src=b);return g},error:function(a,b){var c,d,e,f,g;for(a.previewElement.classList.add("dz-error"),"String"!=typeof b&&b.error&&(b=b.error),f=a.previewElement.querySelectorAll("[data-dz-errormessage]"),g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(c.textContent=b);return g},errormultiple:i,processing:function(a){return a.previewElement.classList.add("dz-processing"),a._removeLink?a._removeLink.textContent=this.options.dictCancelUpload:void 0},processingmultiple:i,uploadprogress:function(a,b){var c,d,e,f,g;for(f=a.previewElement.querySelectorAll("[data-dz-uploadprogress]"),g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(c.style.width=""+b+"%");return g},totaluploadprogress:i,sending:i,sendingmultiple:i,success:function(a){return a.previewElement.classList.add("dz-success")},successmultiple:i,canceled:function(a){return this.emit("error",a,"Upload canceled.")},canceledmultiple:i,complete:function(a){return a._removeLink?a._removeLink.textContent=this.options.dictRemoveFile:void 0},completemultiple:i,maxfilesexceeded:i,maxfilesreached:i,previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-details">\n    <div class="dz-filename"><span data-dz-name></span></div>\n    <div class="dz-size" data-dz-size></div>\n    <img data-dz-thumbnail />\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-success-mark"><span>✔</span></div>\n  <div class="dz-error-mark"><span>✘</span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n</div>'},c=function(){var a,b,c,d,e,f,g;for(d=arguments[0],c=2<=arguments.length?m.call(arguments,1):[],f=0,g=c.length;g>f;f++){b=c[f];for(a in b)e=b[a],d[a]=e}return d},b.prototype.getAcceptedFiles=function(){var a,b,c,d,e;for(d=this.files,e=[],b=0,c=d.length;c>b;b++)a=d[b],a.accepted&&e.push(a);return e},b.prototype.getRejectedFiles=function(){var a,b,c,d,e;for(d=this.files,e=[],b=0,c=d.length;c>b;b++)a=d[b],a.accepted||e.push(a);return e},b.prototype.getQueuedFiles=function(){var a,c,d,e,f;for(e=this.files,f=[],c=0,d=e.length;d>c;c++)a=e[c],a.status===b.QUEUED&&f.push(a);return f},b.prototype.getUploadingFiles=function(){var a,c,d,e,f;for(e=this.files,f=[],c=0,d=e.length;d>c;c++)a=e[c],a.status===b.UPLOADING&&f.push(a);return f},b.prototype.init=function(){var a,c,d,e,f,g,h,i=this;for("form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(b.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&(d=function(){return i.hiddenFileInput&&document.body.removeChild(i.hiddenFileInput),i.hiddenFileInput=document.createElement("input"),i.hiddenFileInput.setAttribute("type","file"),(null==i.options.maxFiles||i.options.maxFiles>1)&&i.hiddenFileInput.setAttribute("multiple","multiple"),null!=i.options.acceptedFiles&&i.hiddenFileInput.setAttribute("accept",i.options.acceptedFiles),i.hiddenFileInput.style.visibility="hidden",i.hiddenFileInput.style.position="absolute",i.hiddenFileInput.style.top="0",i.hiddenFileInput.style.left="0",i.hiddenFileInput.style.height="0",i.hiddenFileInput.style.width="0",document.body.appendChild(i.hiddenFileInput),i.hiddenFileInput.addEventListener("change",function(){var a,b,c,e;if(b=i.hiddenFileInput.files,b.length)for(c=0,e=b.length;e>c;c++)a=b[c],i.addFile(a);return d()})})(),this.URL=null!=(g=window.URL)?g:window.webkitURL,h=this.events,e=0,f=h.length;f>e;e++)a=h[e],this.on(a,this.options[a]);return this.on("uploadprogress",function(){return i.updateTotalUploadProgress()}),this.on("removedfile",function(){return i.updateTotalUploadProgress()}),this.on("canceled",function(a){return i.emit("complete",a)}),this.on("complete",function(){return 0===i.getUploadingFiles().length&&0===i.getQueuedFiles().length?setTimeout(function(){return i.emit("queuecomplete")},0):void 0}),c=function(a){return a.stopPropagation(),a.preventDefault?a.preventDefault():a.returnValue=!1},this.listeners=[{element:this.element,events:{dragstart:function(a){return i.emit("dragstart",a)},dragenter:function(a){return c(a),i.emit("dragenter",a)},dragover:function(a){var b;try{b=a.dataTransfer.effectAllowed}catch(d){}return a.dataTransfer.dropEffect="move"===b||"linkMove"===b?"move":"copy",c(a),i.emit("dragover",a)},dragleave:function(a){return i.emit("dragleave",a)},drop:function(a){return c(a),i.drop(a)},dragend:function(a){return i.emit("dragend",a)}}}],this.clickableElements.forEach(function(a){return i.listeners.push({element:a,events:{click:function(c){return a!==i.element||c.target===i.element||b.elementInside(c.target,i.element.querySelector(".dz-message"))?i.hiddenFileInput.click():void 0}}})}),this.enable(),this.options.init.call(this)},b.prototype.destroy=function(){var a;return this.disable(),this.removeAllFiles(!0),(null!=(a=this.hiddenFileInput)?a.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,b.instances.splice(b.instances.indexOf(this),1)},b.prototype.updateTotalUploadProgress=function(){var a,b,c,d,e,f,g,h;if(d=0,c=0,a=this.getAcceptedFiles(),a.length){for(h=this.getAcceptedFiles(),f=0,g=h.length;g>f;f++)b=h[f],d+=b.upload.bytesSent,c+=b.upload.total;e=100*d/c}else e=100;return this.emit("totaluploadprogress",e,c,d)},b.prototype.getFallbackForm=function(){var a,c,d,e;return(a=this.getExistingFallback())?a:(d='<div class="dz-fallback">',this.options.dictFallbackText&&(d+="<p>"+this.options.dictFallbackText+"</p>"),d+='<input type="file" name="'+this.options.paramName+(this.options.uploadMultiple?"[]":"")+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>',c=b.createElement(d),"FORM"!==this.element.tagName?(e=b.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>'),e.appendChild(c)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=e?e:c)},b.prototype.getExistingFallback=function(){var a,b,c,d,e,f;for(b=function(a){var b,c,d;for(c=0,d=a.length;d>c;c++)if(b=a[c],/(^| )fallback($| )/.test(b.className))return b},f=["div","form"],d=0,e=f.length;e>d;d++)if(c=f[d],a=b(this.element.getElementsByTagName(c)))return a},b.prototype.setupEventListeners=function(){var a,b,c,d,e,f,g;for(f=this.listeners,g=[],d=0,e=f.length;e>d;d++)a=f[d],g.push(function(){var d,e;d=a.events,e=[];for(b in d)c=d[b],e.push(a.element.addEventListener(b,c,!1));return e}());return g},b.prototype.removeEventListeners=function(){var a,b,c,d,e,f,g;for(f=this.listeners,g=[],d=0,e=f.length;e>d;d++)a=f[d],g.push(function(){var d,e;d=a.events,e=[];for(b in d)c=d[b],e.push(a.element.removeEventListener(b,c,!1));return e}());return g},b.prototype.disable=function(){var a,b,c,d,e;for(this.clickableElements.forEach(function(a){return a.classList.remove("dz-clickable")}),this.removeEventListeners(),d=this.files,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(this.cancelUpload(a));return e},b.prototype.enable=function(){return this.clickableElements.forEach(function(a){return a.classList.add("dz-clickable")}),this.setupEventListeners()},b.prototype.filesize=function(a){var b;return a>=109951162777.6?(a/=109951162777.6,b="TiB"):a>=107374182.4?(a/=107374182.4,b="GiB"):a>=104857.6?(a/=104857.6,b="MiB"):a>=102.4?(a/=102.4,b="KiB"):(a=10*a,b="b"),"<strong>"+Math.round(a)/10+"</strong> "+b},b.prototype._updateMaxFilesReachedClass=function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")},b.prototype.drop=function(a){var b,c;a.dataTransfer&&(this.emit("drop",a),b=a.dataTransfer.files,b.length&&(c=a.dataTransfer.items,c&&c.length&&null!=c[0].webkitGetAsEntry?this._addFilesFromItems(c):this.handleFiles(b)))},b.prototype.paste=function(a){var b,c;return null!=(null!=a&&null!=(c=a.clipboardData)?c.items:void 0)?(this.emit("paste",a),b=a.clipboardData.items,b.length?this._addFilesFromItems(b):void 0):void 0},b.prototype.handleFiles=function(a){var b,c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(this.addFile(b));return e},b.prototype._addFilesFromItems=function(a){var b,c,d,e,f;for(f=[],d=0,e=a.length;e>d;d++)c=a[d],f.push(null!=c.webkitGetAsEntry&&(b=c.webkitGetAsEntry())?b.isFile?this.addFile(c.getAsFile()):b.isDirectory?this._addFilesFromDirectory(b,b.name):void 0:null!=c.getAsFile?null==c.kind||"file"===c.kind?this.addFile(c.getAsFile()):void 0:void 0);return f},b.prototype._addFilesFromDirectory=function(a,b){var c,d,e=this;return c=a.createReader(),d=function(a){var c,d,f;for(d=0,f=a.length;f>d;d++)c=a[d],c.isFile?c.file(function(a){return e.options.ignoreHiddenFiles&&"."===a.name.substring(0,1)?void 0:(a.fullPath=""+b+"/"+a.name,e.addFile(a))}):c.isDirectory&&e._addFilesFromDirectory(c,""+b+"/"+c.name)},c.readEntries(d,function(a){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log(a):void 0})},b.prototype.accept=function(a,c){return a.size>1024*this.options.maxFilesize*1024?c(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(a.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):b.isValidFile(a,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(c(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",a)):this.options.accept.call(this,a,c):c(this.options.dictInvalidFileType)},b.prototype.addFile=function(a){var c=this;return a.upload={progress:0,total:a.size,bytesSent:0},this.files.push(a),a.status=b.ADDED,this.emit("addedfile",a),this._enqueueThumbnail(a),this.accept(a,function(b){return b?(a.accepted=!1,c._errorProcessing([a],b)):c.enqueueFile(a),c._updateMaxFilesReachedClass()})},b.prototype.enqueueFiles=function(a){var b,c,d;for(c=0,d=a.length;d>c;c++)b=a[c],this.enqueueFile(b);return null},b.prototype.enqueueFile=function(a){var c=this;if(a.accepted=!0,a.status!==b.ADDED)throw new Error("This file can't be queued because it has already been processed or was rejected.");return a.status=b.QUEUED,this.options.autoProcessQueue?setTimeout(function(){return c.processQueue()},0):void 0},b.prototype._thumbnailQueue=[],b.prototype._processingThumbnail=!1,b.prototype._enqueueThumbnail=function(a){var b=this;return this.options.createImageThumbnails&&a.type.match(/image.*/)&&a.size<=1024*this.options.maxThumbnailFilesize*1024?(this._thumbnailQueue.push(a),setTimeout(function(){return b._processThumbnailQueue()},0)):void 0},b.prototype._processThumbnailQueue=function(){var a=this;return this._processingThumbnail||0===this._thumbnailQueue.length?void 0:(this._processingThumbnail=!0,this.createThumbnail(this._thumbnailQueue.shift(),function(){return a._processingThumbnail=!1,a._processThumbnailQueue()}))},b.prototype.removeFile=function(a){return a.status===b.UPLOADING&&this.cancelUpload(a),this.files=j(this.files,a),this.emit("removedfile",a),0===this.files.length?this.emit("reset"):void 0},b.prototype.removeAllFiles=function(a){var c,d,e,f;for(null==a&&(a=!1),f=this.files.slice(),d=0,e=f.length;e>d;d++)c=f[d],(c.status!==b.UPLOADING||a)&&this.removeFile(c);return null},b.prototype.createThumbnail=function(a,b){var c,d=this;return c=new FileReader,c.onload=function(){var e;return e=document.createElement("img"),e.onload=function(){var c,f,g,i,j,k,l,m;return a.width=e.width,a.height=e.height,g=d.options.resize.call(d,a),null==g.trgWidth&&(g.trgWidth=d.options.thumbnailWidth),null==g.trgHeight&&(g.trgHeight=d.options.thumbnailHeight),c=document.createElement("canvas"),f=c.getContext("2d"),c.width=g.trgWidth,c.height=g.trgHeight,h(f,e,null!=(j=g.srcX)?j:0,null!=(k=g.srcY)?k:0,g.srcWidth,g.srcHeight,null!=(l=g.trgX)?l:0,null!=(m=g.trgY)?m:0,g.trgWidth,g.trgHeight),i=c.toDataURL("image/png"),d.emit("thumbnail",a,i),null!=b?b():void 0},e.src=c.result},c.readAsDataURL(a)},b.prototype.processQueue=function(){var a,b,c,d;if(b=this.options.parallelUploads,c=this.getUploadingFiles().length,a=c,!(c>=b)&&(d=this.getQueuedFiles(),d.length>0)){if(this.options.uploadMultiple)return this.processFiles(d.slice(0,b-c));for(;b>a;){if(!d.length)return;this.processFile(d.shift()),a++}}},b.prototype.processFile=function(a){return this.processFiles([a])},b.prototype.processFiles=function(a){var c,d,e;for(d=0,e=a.length;e>d;d++)c=a[d],c.processing=!0,c.status=b.UPLOADING,this.emit("processing",c);return this.options.uploadMultiple&&this.emit("processingmultiple",a),this.uploadFiles(a)},b.prototype._getFilesWithXhr=function(a){var b,c;return c=function(){var c,d,e,f;for(e=this.files,f=[],c=0,d=e.length;d>c;c++)b=e[c],b.xhr===a&&f.push(b);return f}.call(this)},b.prototype.cancelUpload=function(a){var c,d,e,f,g,h,i;if(a.status===b.UPLOADING){for(d=this._getFilesWithXhr(a.xhr),e=0,g=d.length;g>e;e++)c=d[e],c.status=b.CANCELED;for(a.xhr.abort(),f=0,h=d.length;h>f;f++)c=d[f],this.emit("canceled",c);this.options.uploadMultiple&&this.emit("canceledmultiple",d)}else((i=a.status)===b.ADDED||i===b.QUEUED)&&(a.status=b.CANCELED,this.emit("canceled",a),this.options.uploadMultiple&&this.emit("canceledmultiple",[a]));return this.options.autoProcessQueue?this.processQueue():void 0},b.prototype.uploadFile=function(a){return this.uploadFiles([a])},b.prototype.uploadFiles=function(a){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=this;for(s=new XMLHttpRequest,t=0,x=a.length;x>t;t++)d=a[t],d.xhr=s;s.open(this.options.method,this.options.url,!0),s.withCredentials=!!this.options.withCredentials,p=null,f=function(){var b,c,e;for(e=[],b=0,c=a.length;c>b;b++)d=a[b],e.push(I._errorProcessing(a,p||I.options.dictResponseError.replace("{{statusCode}}",s.status),s));return e},q=function(b){var c,e,f,g,h,i,j,k,l;if(null!=b)for(e=100*b.loaded/b.total,f=0,i=a.length;i>f;f++)d=a[f],d.upload={progress:e,total:b.total,bytesSent:b.loaded};else{for(c=!0,e=100,g=0,j=a.length;j>g;g++)d=a[g],(100!==d.upload.progress||d.upload.bytesSent!==d.upload.total)&&(c=!1),d.upload.progress=e,d.upload.bytesSent=d.upload.total;if(c)return}for(l=[],h=0,k=a.length;k>h;h++)d=a[h],l.push(I.emit("uploadprogress",d,e,d.upload.bytesSent));return l},s.onload=function(c){var d;if(a[0].status!==b.CANCELED&&4===s.readyState){if(p=s.responseText,s.getResponseHeader("content-type")&&~s.getResponseHeader("content-type").indexOf("application/json"))try{p=JSON.parse(p)}catch(e){c=e,p="Invalid JSON response from server."}return q(),200<=(d=s.status)&&300>d?I._finished(a,p,c):f()}},s.onerror=function(){return a[0].status!==b.CANCELED?f():void 0},o=null!=(D=s.upload)?D:s,o.onprogress=q,i={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"},this.options.headers&&c(i,this.options.headers);for(g in i)h=i[g],s.setRequestHeader(g,h);if(e=new FormData,this.options.params){E=this.options.params;for(m in E)r=E[m],e.append(m,r)}for(u=0,y=a.length;y>u;u++)d=a[u],this.emit("sending",d,s,e);if(this.options.uploadMultiple&&this.emit("sendingmultiple",a,s,e),"FORM"===this.element.tagName)for(F=this.element.querySelectorAll("input, textarea, select, button"),v=0,z=F.length;z>v;v++)if(j=F[v],k=j.getAttribute("name"),l=j.getAttribute("type"),"SELECT"===j.tagName&&j.hasAttribute("multiple"))for(G=j.options,w=0,A=G.length;A>w;w++)n=G[w],n.selected&&e.append(k,n.value);else(!l||"checkbox"!==(H=l.toLowerCase())&&"radio"!==H||j.checked)&&e.append(k,j.value);for(C=0,B=a.length;B>C;C++)d=a[C],e.append(""+this.options.paramName+(this.options.uploadMultiple?"[]":""),d,d.name);return s.send(e)},b.prototype._finished=function(a,c,d){var e,f,g;for(f=0,g=a.length;g>f;f++)e=a[f],e.status=b.SUCCESS,this.emit("success",e,c,d),this.emit("complete",e);return this.options.uploadMultiple&&(this.emit("successmultiple",a,c,d),this.emit("completemultiple",a)),this.options.autoProcessQueue?this.processQueue():void 0},b.prototype._errorProcessing=function(a,c,d){var e,f,g;for(f=0,g=a.length;g>f;f++)e=a[f],e.status=b.ERROR,this.emit("error",e,c,d),this.emit("complete",e);return this.options.uploadMultiple&&(this.emit("errormultiple",a,c,d),this.emit("completemultiple",a)),this.options.autoProcessQueue?this.processQueue():void 0},b}(d),a.version="3.8.4",a.options={},a.optionsForElement=function(b){return b.getAttribute("id")?a.options[e(b.getAttribute("id"))]:void 0},a.instances=[],a.forElement=function(a){if("string"==typeof a&&(a=document.querySelector(a)),null==(null!=a?a.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return a.dropzone},a.autoDiscover=!0,a.discover=function(){var b,c,d,e,f,g;for(document.querySelectorAll?d=document.querySelectorAll(".dropzone"):(d=[],b=function(a){var b,c,e,f;for(f=[],c=0,e=a.length;e>c;c++)b=a[c],f.push(/(^| )dropzone($| )/.test(b.className)?d.push(b):void 0);return f},b(document.getElementsByTagName("div")),b(document.getElementsByTagName("form"))),g=[],e=0,f=d.length;f>e;e++)c=d[e],g.push(a.optionsForElement(c)!==!1?new a(c):void 0);return g},a.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i],a.isBrowserSupported=function(){var b,c,d,e,f;if(b=!0,window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(f=a.blacklistedBrowsers,d=0,e=f.length;e>d;d++)c=f[d],c.test(navigator.userAgent)&&(b=!1);else b=!1;else b=!1;return b},j=function(a,b){var c,d,e,f;for(f=[],d=0,e=a.length;e>d;d++)c=a[d],c!==b&&f.push(c);return f},e=function(a){return a.replace(/[\-_](\w)/g,function(a){return a[1].toUpperCase()})},a.createElement=function(a){var b;return b=document.createElement("div"),b.innerHTML=a,b.childNodes[0]},a.elementInside=function(a,b){if(a===b)return!0;for(;a=a.parentNode;)if(a===b)return!0;return!1},a.getElement=function(a,b){var c;if("string"==typeof a?c=document.querySelector(a):null!=a.nodeType&&(c=a),null==c)throw new Error("Invalid `"+b+"` option provided. Please provide a CSS selector or a plain HTML element.");return c},a.getElements=function(a,b){var c,d,e,f,g,h,i,j;if(a instanceof Array){e=[];try{for(f=0,h=a.length;h>f;f++)d=a[f],e.push(this.getElement(d,b))}catch(k){c=k,e=null}}else if("string"==typeof a)for(e=[],j=document.querySelectorAll(a),g=0,i=j.length;i>g;g++)d=j[g],e.push(d);else null!=a.nodeType&&(e=[a]);if(null==e||!e.length)throw new Error("Invalid `"+b+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return e},a.confirm=function(a,b,c){return window.confirm(a)?b():null!=c?c():void 0},a.isValidFile=function(a,b){var c,d,e,f,g;if(!b)return!0;for(b=b.split(","),d=a.type,c=d.replace(/\/.*$/,""),f=0,g=b.length;g>f;f++)if(e=b[f],e=e.trim(),"."===e.charAt(0)){if(-1!==a.name.toLowerCase().indexOf(e.toLowerCase(),a.name.length-e.length))return!0}else if(/\/\*$/.test(e)){if(c===e.replace(/\/.*$/,""))return!0}else if(d===e)return!0;return!1},"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery.fn.dropzone=function(b){return this.each(function(){return new a(this,b)})}),"undefined"!=typeof c&&null!==c?c.exports=a:window.Dropzone=a,a.ADDED="added",a.QUEUED="queued",a.ACCEPTED=a.QUEUED,a.UPLOADING="uploading",a.PROCESSING=a.UPLOADING,a.CANCELED="canceled",a.ERROR="error",a.SUCCESS="success",g=function(a){var b,c,d,e,f,g,h,i,j,k;for(h=a.naturalWidth,g=a.naturalHeight,c=document.createElement("canvas"),c.width=1,c.height=g,d=c.getContext("2d"),d.drawImage(a,0,0),e=d.getImageData(0,0,1,g).data,k=0,f=g,i=g;i>k;)b=e[4*(i-1)+3],0===b?f=i:k=i,i=f+k>>1;return j=i/g,0===j?1:j},h=function(a,b,c,d,e,f,h,i,j,k){var l;return l=g(b),a.drawImage(b,c,d,e,f,h,i,j,k/l)},f=function(a,b){var c,d,e,f,g,h,i,j,k;if(e=!1,k=!0,d=a.document,j=d.documentElement,c=d.addEventListener?"addEventListener":"attachEvent",i=d.addEventListener?"removeEventListener":"detachEvent",h=d.addEventListener?"":"on",f=function(c){return"readystatechange"!==c.type||"complete"===d.readyState?(("load"===c.type?a:d)[i](h+c.type,f,!1),!e&&(e=!0)?b.call(a,c.type||c):void 0):void 0},g=function(){var a;try{j.doScroll("left")}catch(b){return a=b,void setTimeout(g,50)}return f("poll")},"complete"!==d.readyState){if(d.createEventObject&&j.doScroll){try{k=!a.frameElement}catch(l){}k&&g()}return d[c](h+"DOMContentLoaded",f,!1),d[c](h+"readystatechange",f,!1),a[c](h+"load",f,!1)}},a._autoDiscoverFunction=function(){return a.autoDiscover?a.discover():void 0},f(window,a._autoDiscoverFunction)}).call(this)}),a.alias("component-emitter/index.js","dropzone/deps/emitter/index.js"),a.alias("component-emitter/index.js","emitter/index.js"),"object"==typeof exports?module.exports=a("dropzone"):"function"==typeof define&&define.amd?define(function(){return a("dropzone")}):this.Dropzone=a("dropzone")}(),NoteboardModel.prototype=new Observable,NoteboardModel.prototype.setName=function(a){this.data.name=a,this.trigger("noteboard-name",a)
},NoteboardModel.prototype.setDescription=function(a){this.data.description=a,this.trigger("noteboard-description",a)},NoteboardModel.prototype.setVisibility=function(a){this.data.visibility=a,this.trigger("noteboard-visibility",a)},NoteboardModel.prototype.setParentId=function(a){this.data.changeParent=this.data.parentId!=a,this.data.parentId=a,this.trigger("noteboard-parentId",a)},NoteboardModel.prototype.setCategoryId=function(a){this.data.categoryId=a},NoteboardBase.prototype.Share=function(){var self=this;$.untInputWin({title:eval("i18n.share"+this.model.data.ctype),content:ROOT_URL+"Noteboard/ShareManager/"+this.model.data.id,clickAccept:function(){var a=$("#frmNoteboardShare").serialize();return""==$.trim(a)?($("#frmNoteboardShare .untPlgMsg").untInputMsg({content:i18n.errSelectCollaborator,type:"Err"}).show(),!1):($(".btnWinAccept").attr("disabled","true").removeClass("yellow"),$.post(ROOT_URL+"Noteboard/Share/"+self.model.data.id,$("#frmNoteboardShare").serialize(),function(){untInputWinRemove()}),!1)},onLoadContent:function(){$("#frmNoteboardShare").on("submit",function(){return!1}),$(".untWin .btnWinAccept").html(i18n.sendInvitation),$(".untWin .btnWinCancel").html(i18n.closeWindow),$("#contact").on("keypress",function(){$(".untPlgMsg").html("")}).autocomplete({source:function(a,b){$.getJSON(API+"User/Search/?term="+a.term+"&noteboardId="+self.model.data.id,function(a){b(a)})},select:function(a,b){{var c=$("<div>",{Class:"untShareUser"}).appendTo($("#collaborators")),d=($("<div>",{Class:"untInline"}).append('<img src="'+b.item.label.profileImage+'" width="35px">').appendTo(c),$("<div>",{Class:"profile untInline"}).appendTo(c));$("<div>",{Class:"name"}).html(b.item.label.fullname).appendTo(d),$("<div>",{Class:"email"}).html(b.item.label.email).appendTo(d),$("<div>",{Class:"delete icon-cancel-circle"}).prependTo(c).on("click",function(){c.remove()}),$("<input>",{type:"hidden",name:"collaborators[]",value:b.item.value}).appendTo(c)}return $(this).val("").focus(),!1},minLength:3}).data("ui-autocomplete")._renderItem=function(a,b){var c=!1;if($("#collaborators").find("[value]").each(function(){this.value==b.value&&(c=!0)}),c)return $("").data("ui-autocomplete-item",b);{var d=$("<a>",{Class:"untShareUser"}),e=($("<div>",{Class:"untInline"}).append('<img src="'+b.label.profileImage+'" width="35px">').appendTo(d),$("<div>",{Class:"profile untInline"}).appendTo(d));$("<div>",{Class:"name"}).html(b.label.fullname).appendTo(e),$("<div>",{Class:"email"}).html(b.label.email).appendTo(e)}return $("<li>").data("ui-autocomplete-item",b).append(d).appendTo(a)},$("#collaboratorsContainer .delete").on("click",function(){var a=$(this);$.untInputWin({title:i18n.deleteCollaborator,content:i18n.deleteCollaboratorMsg,btnCancel:!0,width:"300",clickAccept:function(){$.ajax({url:API+"Noteboard/Unshare/"+a.data("id"),data:{userId:a.data("userid")},type:"POST",dataType:"json",success:function(){a.parent().remove()}})}})}),$("#collaboratorsContainer .permissions").on("click",function(){var a=$(this),b=a.data("userid"),c={noteboardId:a.attr("data-id"),canEdit:a.attr("data-canedit"),canComment:a.attr("data-cancomment"),canDelete:a.attr("data-candelete"),canUploadFiles:a.attr("data-canuploadfiles"),canDeleteAttach:a.attr("data-candeleteattach"),canInvite:a.attr("data-caninvite")};$.untInputWin({title:i18n.userPermissions,content:views.permissionsForm(c),clickAccept:function(){return $.ajax({url:ROOT_URL+"User/Permissions/"+b,data:$("#permissionsForm").serialize(),type:"POST",dataType:"json",success:function(b){a.attr("data-canedit",b.canEdit),a.attr("data-cancomment",b.canComment),a.attr("data-candelete",b.canDelete),a.attr("data-canuploadfiles",b.canUploadFiles),a.attr("data-candeleteattach",b.canDeleteAttach),a.attr("data-caninvite",b.canInvite),untInputWinRemove()}}),!1}})})}})},NoteboardBase.prototype.Delete=function(){var self=this,content=eval("i18n.delete"+this.model.data.ctype+"Msg");this.model.data.user.owner||(content=eval("i18n.unshare"+this.model.data.ctype+"Msg")),$.untInputWin({title:eval("i18n.delete"+this.model.data.ctype),content:content,maxWidth:"300px",clickAccept:function(){$.ajax({url:API+"Noteboard/"+self.model.data.id,type:"DELETE",dataType:"json",success:function(){"noteboard"==self.model.data.type?self.template().remove():(location.hash="",_getFolderScheme())}}),untInputWinRemove()}})},NoteboardBase.prototype.Edit=function(){var self=this;$.untInputWin({title:eval("i18n.edit"+this.model.data.ctype),content:ROOT_URL+"Noteboard/Manager/"+this.model.data.id+"?type="+this.model.data.type,width:"400",clickAccept:function(){return $("#noteboardForm").valid()?($.ajax({url:API+"Noteboard/"+self.model.data.id,type:"PUT",dataType:"json",data:$("#noteboardForm").serialize(),success:function(a){self.model.setName(a.name),self.model.setDescription(a.description),self.model.setVisibility(a.visibility),self.model.setParentId(a.parentId),self.model.setCategoryId(a.categoryId),untInputWinRemove()}}),!1):!1},onLoadContent:function(){var select=$("#slcParent");select.append(options.html()),select.find("option[value="+self.model.data.parentId+"]").attr("selected","selected"),select.find("option[value="+self.model.data.id+"]").remove(),self.RemoveChildrenOption&&self.RemoveChildrenOption(self.model.data.children,select),$(".untWin .untHelper").qtip({style:{classes:"qtip-untHelper"}}),$("#noteboardForm").validate({success:"valid",rules:{name:{required:!0}},messages:{name:{required:eval("i18n.errName"+self.model.data.ctype)}}}),"noteboard"==self.model.data.type&&$(".untCategoryItems").jScrollPane().data("jsp").scrollToX(80*(self.model.data.categoryId-1))}})},NoteboardBase.prototype.template=function(){return this.view.elems.template},Noteboard.prototype=Object.create(NoteboardBase.prototype),Noteboard.prototype.View=function(a){function b(){var b=this;this.elems={},this.elems.template=$("<div>",{Class:"untNoteboard"}).draggable({revert:!0,opacity:.5,helper:"clone"}).data("model",c.model),this.elems.options=$("<div>",{Class:"options untInline"}).appendTo(this.elems.template),this.elems.edit=$("<div>",{Class:"edit icon-pencil",title:i18n.edit}).appendTo(this.elems.options).qtip(),this.elems.share=$("<div>",{Class:"share icon-users",title:i18n.share}).appendTo(this.elems.options).qtip(),this.elems.delete=$("<div>",{Class:"delete icon-remove",title:i18n.delete}).appendTo(this.elems.options).qtip(),this.elems.leftContent=$("<div>",{Class:"leftContent"}).appendTo(this.elems.template),this.elems.preview=$("<a>",{Class:"preview untInline",href:ROOT_URL+"Noteboard/App/"+a.url}).appendTo(this.elems.leftContent),this.elems.previewImage=$("<img>",{Class:"previewImage",width:"158px",height:"115px",src:BLOB_IMAGES+"preview_"+a.url+".jpg?cache="+a.cache}).appendTo(this.elems.preview),this.elems.profileImage=$("<img>",{Class:"profileImage",width:"30px",height:"30px",src:a.user.profileImage,title:i18n.createBy+a.user.fullname}).appendTo(this.elems.preview).qtip(),this.elems.name=$("<div>",{Class:"name"}).html(a.name).appendTo(this.elems.leftContent),this.elems.description=$("<div>",{Class:"description"}).html(a.description).appendTo(this.elems.leftContent),this.elems.private=$("<div>",{Class:"private icon-lock",title:i18n.private}).appendTo(this.elems.template).qtip(),this.elems.public=$("<div>",{Class:"public icon-unlocked",title:i18n.public}).appendTo(this.elems.template).qtip(),this.elems.share.on("click",function(){return b.trigger("noteboard-share"),!1}),this.elems.delete.on("click",function(){return b.trigger("noteboard-delete"),!1}),this.elems.edit.on("click",function(){return b.trigger("noteboard-edit"),!1}),this.setVisibility(a.visibility)}var c=this;return b.prototype=new Observable,b.prototype.setName=function(a){this.elems.name.html(a)},b.prototype.setDescription=function(a){this.elems.description.html(a)},b.prototype.setVisibility=function(a){switch(a){case"private":this.elems.private.show(),this.elems.public.hide();break;case"public":this.elems.public.show(),this.elems.private.hide()}},b.prototype.setParentId=function(){c.model.data.changeParent&&this.elems.template.remove()},b.prototype.ChangingThumbails=function(){this.elems.previewImage.css("opacity","0.3"),this.elems.preview.prepend('<img src="'+WEBROOT_URL+'img/default/loader.gif" alt="Loader" class="untLoader" width="30px" height="30px">')},b.prototype.setThumbails=function(b){this.elems.previewImage.attr("src",BLOB_IMAGES+"preview_"+a.url+".jpg?cache="+b.cache),this.elems.preview.find(".untLoader").remove(),this.elems.previewImage.css("opacity","1")},new b},Noteboard.prototype.UpdateThumbails=function(){var a=this;this.model.data.modified&&(this.view.ChangingThumbails(),$.getJSON("Noteboard/PreviewRefresh/"+this.model.data.url,function(b){setTimeout(function(){a.view.setThumbails(b)},2e3)}))},Noteboard.prototype.LoadNoteboards=function(a){$(".untNoteboard").remove(),$(".untMainContent").find(".untLoader").show(),$(".untMainContent").find(".untEmpty").hide(),$.getJSON(API+"Noteboard/Children/"+a,function(a){$("#btnAddNoteboard").show(),a.length?a.forEach(function(a){var b=new Noteboard(a);$(".untMainContent").append(b.template())}):$(".untMainContent").find(".untEmpty").show(),$(".untMainContent").find(".untLoader").hide()})},Folder.prototype=Object.create(NoteboardBase.prototype),Folder.prototype.View=function(a){function b(){var b=this;this.elems={},this.elems.template=$("<li>",{id:"subtree-"+a.id}).draggable({revert:!0,opacity:.5,helper:"clone"}).data("model",c.model),this.elems.link=$("<a>",{href:"#!/folder/"+a.id,Class:"unt"+a.ctype+" "+a.type}).data("folder",a.id).appendTo(this.elems.template).attr("data-a","a").droppable({hoverClass:"ui-state-hover",tolerance:"pointer",drop:this.changeParent}),this.elems.icon=$("<span>",{Class:"icon- "+a.type}).appendTo(this.elems.link),this.elems.name=$("<span>",{Class:"name"}).html(a.name).appendTo(this.elems.link),this.elems.edit=$("<span>",{Class:"edit icon-cog"}).appendTo(this.elems.link),this.elems.share=$("<span>",{Class:"share icon-users"}).appendTo(this.elems.link),this.elems.delete=$("<span>",{Class:"delete icon-remove"}).appendTo(this.elems.link),this.elems.ul=$("<ul>").appendTo(this.elems.template),this.elems.share.on("click",function(){return b.trigger("noteboard-share"),!1}),this.elems.delete.on("click",function(){return b.trigger("noteboard-delete"),!1}),this.elems.edit.on("click",function(){return b.trigger("noteboard-edit"),!1}),this.elems.link.on("click",function(){b.trigger("branch-clicked")})}var c=this;return b.prototype=new Observable,b.prototype.setName=function(a){this.elems.name.html(a),options.find("option[value="+c.model.data.id+"]").html(a)},b.prototype.setDescription=function(){},b.prototype.setVisibility=function(){},b.prototype.setParentId=function(){c.model.data.changeParent&&_getFolderScheme()},b.prototype.changeParent=function(a,b){var d=b.draggable.data("model");if(c.model.data.id!=d.data.parentId){if("group"==d.data.type)return void $.untInputWin({title:i18n.invalidMovement,content:i18n.invalidMovementMsg});d.data.parentId=c.model.data.id,$.ajax({url:API+"Noteboard/"+d.data.id,data:d.data,type:"PUT",dataType:"json",success:function(){"folder"==d.data.type?_getFolderScheme():b.draggable.remove()}})}},new b},Folder.prototype.BranchClicked=function(){$(".selected").removeClass("selected"),this.view.elems.link.addClass("selected"),this.template().hasClass("expandable")&&this.template().find("> .hitarea").click(),$("#noteboardsDesigned").hide(),Noteboard.prototype.LoadNoteboards.call(this,this.model.data.id)},Folder.prototype.RemoveChildrenOption=function(a,b){var c=this;if(a)for(var d=a.length-1;d>=0;d--)c.RemoveChildrenOption(a[d].children,b),b.find("option[value="+a[d].id+"]").remove()},Folder.prototype.getSubTree=function(){return this.view.elems.ul},CategoryModel.prototype=new Observable,CategoryModel.prototype.setName=function(a){this.data.name=a,this.save()},CategoryModel.prototype.setCreationDate=function(a){this.data.creationDate=a,this.save()},CategoryModel.prototype.setBgBodyColor=function(a){this.data.bgBodyColor=a,this.save()},CategoryModel.prototype.setBgImageBoard=function(a){this.data.bgImageBoard=a,this.save()},CategoryModel.prototype.setClass=function(a){this.data.Class=a,this.save()},CategoryModel.prototype.setRepeat=function(a){this.data.repeat=a,this.save()},CategoryModel.prototype.setHeight=function(a){this.data.height=a,this.save()},CategoryModel.prototype.setWidth=function(a){this.data.width=a,this.save()},CategoryModel.prototype.setCreatorId=function(a){this.data.creatorId=a,this.save()},CategoryModel.prototype.setVisibility=function(a){this.data.visibility=a?"public":"private",this.save()},CategoryModel.prototype.setStructure=function(a){this.data.structure=a},CategoryModel.prototype.save=function(){$.ajax({url:API+"Category/"+this.data.id,data:this.data,type:"PUT"})},Category.prototype.template=function(){return this.view.elems.template},Category.prototype.View=function(a){function b(){var b=this,d=new Array;d[a.repeat]="selected",this.elems={},this.elems.template=$("<div>",{Class:"untContentDesign"}).data("model",a),this.elems.preview=$("<span>",{Class:"preview"}).appendTo(this.elems.template),this.elems.upload=$("<div>",{Class:"upload"}).appendTo(this.elems.preview).html("<span>"+i18n.changeBgImage+"</span>"),this.elems.imagePreview=$("<img>",{src:WEBROOT_URL+"img/noteboard/"+a.bgImageBoard,alt:"Canvas"}).appendTo(this.elems.preview),this.elems.info=$("<span>",{Class:"info"}).appendTo(this.elems.template),this.elems.h3=$("<h3>").appendTo(this.elems.info),this.elems.name=$("<input>",{type:"text",name:"name",value:a.name}).placeholder({text:i18n.boardName}).appendTo(this.elems.h3),this.elems.small=$("<small>").html(a.creationDate).appendTo(this.elems.h3),this.elems.width=$("<input>",{type:"text",name:"width",value:a.width}),this.elems.height=$("<input>",{type:"text",name:"height",value:a.height}),this.elems.visibility=$("<input>",{type:"checkbox",name:"visibility",checked:"public"==a.visibility}),this.elems.structure=$("<span>",{Class:"structure"}).append("<h3>"+i18n.structuringBoards+"</h3>"),this.elems.structureContent=$("<div>",{Class:"structureContent"}).appendTo(this.elems.structure),this.elems.repeat=$("<select>",{name:"repeat"}).append('<option value="repeat"'+d.repeat+">repeat</option>").append('<option value="no-repeat"'+d["no-repeat"]+">no-repeat</option>").append('<option value="repeat-x"'+d["repeat-x"]+">repeat-x</option>").append('<option value="repeat-y"'+d["repeat-y"]+">repeat-y</option>").append('<option value="round"'+d.round+">round</option>").append('<option value="space"'+d.space+">space</option>"),this.elems.info.append("<table>									<tr>										<td>"+i18n.width+'</td>										<td class="width"></td>									</tr>									<tr>										<td>'+i18n.height+'</td>										<td class="height"></td>									</tr>									<tr>										<td>'+i18n.repeat+'</td>										<td class="repeat"></td>									</tr>									<tr>										<td>'+i18n.public+'</td>										<td class="public"></td>									</tr>								</table>'),this.elems.info.find("td.width").append(this.elems.width),this.elems.info.find("td.height").append(this.elems.height),this.elems.info.find("td.repeat").append(this.elems.repeat),this.elems.info.find("td.public").append(this.elems.visibility),this.elems.template.append(this.elems.structure),this.elems.name.on("change",function(a){b.trigger("category-name",this.value,a)}),this.elems.width.on("change",function(a){b.trigger("category-width",this.value,a)}).on("keypress",function(a){permissionsKeyPress.OnlyIntegersNBSHandled(a)}),this.elems.height.on("change",function(a){b.trigger("category-height",this.value,a)}).on("keypress",function(a){permissionsKeyPress.OnlyIntegersNBSHandled(a)}),this.elems.repeat.on("change",function(a){b.trigger("category-repeat",this.value,a)}),this.elems.visibility.on("change",function(a){b.trigger("category-visibility",this.checked,a)}),this.elems.upload.on("click",function(){b.uploadBgImage()});var e=200/c.model.data.width,f=(200-c.model.data.width*e)/2,g=(200-c.model.data.height*e)/2,h=333;c.model.data.width<c.model.data.height&&(e=200/c.model.data.height),c.model.data.structure.forEach(function(a){h+=111;var c=$("<div>",{Class:"area"}).css({"background-color":"#"+h,width:a.width*e,height:a.height*e,"margin-left":f+a.left*e,"margin-top":g+a.top*e});b.elems.structureContent.append(c)}),this.elems.structureTool=$("<div>",{Class:"upload"}).appendTo(this.elems.structureContent).html("<span>"+i18n.structuring+"</span>"),this.elems.structureTool.on("click",function(){var a=new Structure(c.model.data);$.untInputWin({title:"Estructuración de Tablero: "+c.model.data.name,content:a.template(),btnAccept:!1})})}var c=this;return b.prototype=new Observable,b.prototype.uploadBgImage=function(){var a=this;$.untInputWin({content:views.formBgImage(c.model.data.id),classes:"dropzone",width:"100%"});new Dropzone("#uploadDropzone",{maxFilesize:.1,maxFiles:1,success:function(b,c){var d=new Date;a.elems.imagePreview.attr("src","webroot/img/noteboard/"+c.bgImageBoard+"?"+d.getTime()),untInputWinRemove()}});untInputWinCenter()},new b},Structure.prototype.template=function(){return this.view.elems.template},Structure.prototype.View=function(a){function b(){var b=this;this.elems={},this.elems.template=$("<div>",{Class:"untStructureTool"}),this.elems.template.css({background:"url(webroot/img/noteboard/"+a.bgImageBoard+")","background-size":"contain",width:a.width*e,height:a.height*e}).selectable({start:function(a){var b=$(this);c=(a.pageX-(b.parent().offset().left+10))/e,d=(a.pageY-(b.parent().offset().top+10))/e},stop:function(f){var g=$(this),h=(f.pageX-(g.parent().offset().left+10))/e,i=(f.pageY-(g.parent().offset().top+10))/e,j=Math.abs(c-h),k=Math.abs(d-i),l=Math.min(h,c),m=Math.min(i,d);if(j>10&&k>10){var n=generatePass(),o={name:"",code:n,height:k,left:l,top:m,width:j,categoryId:a.id};$.ajax({url:API+"Structure",data:o,type:"POST",success:function(a){b.Area(a)}})}}}),a.structure.forEach(function(a){b.Area(a)})}var c,d,e=1200/a.width;return b.prototype.Area=function(a){var b=$("<div>",{Class:"Area"}).appendTo(this.elems.template),c=$("<div>",{Class:"icon-cancel-circle"}).appendTo(b),d=$("<div>",{Class:"resize"}).appendTo(b),f=$("<input>",{type:"text",Class:"name",value:a.name,maxlength:45}).placeholder({text:i18n.name}).appendTo(b),g=$("<input>",{type:"text",Class:"code",value:a.code,maxlength:45}).placeholder({text:i18n.code}).appendTo(b).on("keypress",permissionsKeyPress.OnlyAlphanumericHandledNBS);b.css({height:a.height*e,left:a.left*e+"px",position:"absolute",top:a.top*e+"px",width:a.width*e}).draggable({containment:"parent",stop:function(b,c){a.left=c.position.left/e,a.top=c.position.top/e,$.ajax({url:API+"Structure/"+a.code,data:a,type:"PUT"})}}),d.draggable({drag:function(a,c){c.position.left<80&&(c.position.left=80),c.position.top<80&&(c.position.top=80);var d=c.position.left+10,e=c.position.top+10;b.css({width:d,height:e})},stop:function(){a.width=b.width()/e,a.height=b.height()/e,$.ajax({url:API+"Structure/"+a.code,data:a,type:"PUT"})}}).css("position","absolute"),f.on("change",function(){a.name=this.value,$.ajax({url:API+"Structure/"+a.code,data:a,type:"PUT"})}),g.on("change",function(){var b=a.code;return a.code=this.value,""==a.code?($.untInputWin({title:i18n.codeEmpty,content:i18n.codeEmptyMsg}),void(this.value=b)):void $.ajax({url:API+"Structure/"+b,data:a,type:"PUT"})}),c.on("click",function(){$.ajax({url:API+"Structure/"+a.code,data:a,type:"DELETE",success:function(){b.remove()}})})},new b};var options=$("<div>"),navigation=$("#navigation");$(window).on("resize",function(){navigation.data("jsp").reinitialise()});var _getFolderScheme=function(){options.empty(),navigation.empty(),$.getJSON(API+"Noteboard/FolderScheme/"+navigation.data("folder"),function(a){a.name=i18n.branchRoot;var b=new Folder(a);navigation.append(b.template()),_buildTreeView(b),navigation.treeview({animated:"fast",persist:"cookie",cookieId:"treeview-black",collapsed:!1,unique:!0,toggle:function(){navigation.data("jsp").reinitialise()}}),navigation.data("jsp")||navigation.jScrollPane();var c=location.hash,d=a.id;/folder/.test(c)?d=$("a[href='"+c+"']").addClass("selected").data("folder")||b.template().find("> a").addClass("selected").data("folder"):b.template().find("> a").addClass("selected"),navigation.css("visibility","visible"),$("#navContainer .untLoader").remove(),Noteboard.prototype.LoadNoteboards.call(this,d)})},_buildTreeView=function(a){var b=a.getSubTree();a.model.data.children.forEach(function(a){var c=new Folder(a);b.append(c.template()),_buildTreeView(c),options.append('<option value="'+a.id+'">'+clipText(a.name,30)+"</option>")})};_getFolderScheme(),$("#btnCreate").qtip({content:{text:$("#contentMenu")},show:{event:"click"},hide:{event:"unfocus"},position:{my:"top center",at:"bottom center"},style:{classes:"qtip-create-options"}}),$(".untMenuLI").on("click",function(){var $this=$(this),type=$this.data("type"),ctype=type.charAt(0).toUpperCase()+type.slice(1),url=ROOT_URL+"Noteboard/Manager?type="+type,title=eval("i18n.create"+ctype),errName=eval("i18n.errName"+ctype);$("#btnCreate").qtip("hide"),$.untInputWin({title:title,content:url,width:"400",btnCancel:!0,clickAccept:function(){return $("#noteboardForm").valid()?void $.post(API+"Noteboard",$("#noteboardForm").serialize(),function(a){if("noteboard"==type)location.href=ROOT_URL+"Noteboard/App/"+a.url;else{var b=$("#subtree-"+a.parentId).find("> ul"),c=new Folder(a);0==b.length&&(b=navigation.find("> ul")),b.append(c.template()),navigation.treeview({add:c.template()}),navigation.data("jsp").reinitialise(),options.append('<option value="'+a.id+'">'+clipText(a.name,30)+"</option>")}},"json"):!1},onLoadContent:function(){var a=$("#navigation li a.selected"),b=$("#slcParent"),c=navigation.data("id");0!==a.length&&(c=a.data("folder")),b.append(options.html()),b.find("option[value="+c+"]").attr("selected","selected"),$(".untWin .untHelper").qtip({style:{classes:"qtip-untHelper"}}),$("#noteboardForm").validate({success:"valid",rules:{name:{required:!0}},messages:{name:{required:"."}}}),$("#name").focus(),$(".untCategoryItems").jScrollPane()}})}),$("#btnMngCategory").on("click",function(){$("#qtip-3").hide(),location.hash="categories",$(".untMainContent").find(".untNoteboard").remove(),$(".untMainContent").find(".untEmpty").hide(),$("#noteboardsDesigned").show(),$.getJSON(API+"Category/AllCategories/",function(a){a.forEach(function(a){var b=new Category(a);$("#container").append(b.template())})})}),$(document).on("click",".untCategoryItems li",function(){$(".selected").removeClass("selected"),$(this).find("div").addClass("selected"),$("#categoryId").val($(this).data("value"))});var trigger=void 0;$.contextMenu({selector:".untNoteboard",items:{edit:{name:i18n.editNoteboard,icon:"pencil"},share:{name:i18n.shareNoteboard,icon:"users"},copy:{name:i18n.copyNoteboard,icon:"copy"},sep1:"----------","delete":{name:i18n.deleteNoteboard,icon:"remove"}},build:function(a){trigger=a},callback:function(a){trigger.find("."+a).click()}}),$(document).on("submit","#noteboardForm",function(){return!1});